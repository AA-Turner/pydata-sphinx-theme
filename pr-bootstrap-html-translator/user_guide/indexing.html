

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Indexing and Selecting Data &#8212; pandas 0.25.1 documentation</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../_static/sphinx-bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link href="../_static/css/custom.css" rel="stylesheet">
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MultiIndex / Advanced Indexing" href="advanced.html" />
    <link rel="prev" title="pandas.DataFrame.to_sql" href="../reference/api/pandas.DataFrame.to_sql.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
        <div class="container">
<a class="navbar-brand" href="../index.html">
  <img src="../_static/img/pandas_logo.svg" alt="Pandas">
</a>

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="../getting_started/index.html">Getting Started</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="index.html">User Guide</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="../reference/index.html">API Reference</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="../development/index.html">Development</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="../whatsnew/index.html">Release Notes</a>
    </li>        
  </ul>
  <ul class="navbar-nav ml-auto">
    <li class="nav-item">
      <a class="nav-link" href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener">
        <span><i class="fab fa-github-alt" style="color:#333;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="https://twitter.com/pandas_dev" target="_blank" rel="noopener">
        <span><i class="fab fa-twitter" style="color:#55acee;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="../install.html">
        <span>
          <span class="btn btn-primary d-lg-inline-block mb-3 mb-md-0 ml-md-3">Install</span>
        </span>
      </a>
    </li>
  </ul>
        </div>
    </nav>

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
              

<form class="bd-search d-flex align-items-center">
  <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
        
          
              <li class="">
                  <a href="io.html">IO Tools (Text, CSV, HDF5, …)</a>
              </li>
          
        
          
              <li class="active">
                  <a href="">Indexing and Selecting Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="advanced.html">MultiIndex / Advanced Indexing</a>
              </li>
          
        
          
              <li class="">
                  <a href="merging.html">Merge, join, and concatenate</a>
              </li>
          
        
          
              <li class="">
                  <a href="reshaping.html">Reshaping and Pivot Tables</a>
              </li>
          
        
          
              <li class="">
                  <a href="text.html">Working with Text Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="missing_data.html">Working with missing data</a>
              </li>
          
        
          
              <li class="">
                  <a href="categorical.html">Categorical Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="integer_na.html">Nullable Integer Data Type</a>
              </li>
          
        
          
              <li class="">
                  <a href="visualization.html">Visualization</a>
              </li>
          
        
          
              <li class="">
                  <a href="computation.html">Computational tools</a>
              </li>
          
        
          
              <li class="">
                  <a href="groupby.html">Group By: split-apply-combine</a>
              </li>
          
        
          
              <li class="">
                  <a href="timeseries.html">Time Series / Date functionality</a>
              </li>
          
        
          
              <li class="">
                  <a href="timedeltas.html">Time Deltas</a>
              </li>
          
        
          
              <li class="">
                  <a href="options.html">Options and Settings</a>
              </li>
          
        
          
              <li class="">
                  <a href="enhancingperf.html">Enhancing Performance</a>
              </li>
          
        
          
              <li class="">
                  <a href="sparse.html">Sparse data structures</a>
              </li>
          
        
          
              <li class="">
                  <a href="gotchas.html">Frequently Asked Questions (FAQ)</a>
              </li>
          
        
          
              <li class="">
                  <a href="cookbook.html">Cookbook</a>
              </li>
          
        
      
      
      
      
      
      
      
      
      
      
    </ul>

<!--

<div class="bd-toc-item active">
  <ul class="current nav bd-sidenav active">
<li class="toctree-l2"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, …)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Indexing and Selecting Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html">MultiIndex / Advanced Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="merging.html">Merge, join, and concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="text.html">Working with Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="missing_data.html">Working with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="categorical.html">Categorical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="integer_na.html">Nullable Integer Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="timedeltas.html">Time Deltas</a></li>
<li class="toctree-l2"><a class="reference internal" href="options.html">Options and Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="enhancingperf.html">Enhancing Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="gotchas.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
</ul>

</div>
-->
</nav>


              
          </div>
          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="toc-entry toc-h2">
            <a href="#different-choices-for-indexing" class="nav-item nav-link">Different Choices for Indexing</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#basics" class="nav-item nav-link">Basics</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#attribute-access" class="nav-item nav-link">Attribute Access</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#slicing-ranges" class="nav-item nav-link">Slicing ranges</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#selection-by-label" class="nav-item nav-link">Selection By Label</a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#slicing-with-labels" class="nav-item nav-link">Slicing with labels</a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#selection-by-position" class="nav-item nav-link">Selection By Position</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#selection-by-callable" class="nav-item nav-link">Selection By Callable</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#ix-indexer-is-deprecated" class="nav-item nav-link">IX Indexer is Deprecated</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#indexing-with-list-with-missing-labels-is-deprecated" class="nav-item nav-link">Indexing with list with missing labels is Deprecated</a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#reindexing" class="nav-item nav-link">Reindexing</a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#selecting-random-samples" class="nav-item nav-link">Selecting Random Samples</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#setting-with-enlargement" class="nav-item nav-link">Setting With Enlargement</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#fast-scalar-value-getting-and-setting" class="nav-item nav-link">Fast scalar value getting and setting</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#boolean-indexing" class="nav-item nav-link">Boolean indexing</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#indexing-with-isin" class="nav-item nav-link">Indexing with isin</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#the-where-method-and-masking" class="nav-item nav-link">The </a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#mask" class="nav-item nav-link">Mask</a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#the-query-method" class="nav-item nav-link">The </a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#multiindex-query-syntax" class="nav-item nav-link">MultiIndex</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#query-use-cases" class="nav-item nav-link">query()</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#query-python-versus-pandas-syntax-comparison" class="nav-item nav-link">query()</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#the-in-and-not-in-operators" class="nav-item nav-link">The </a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#special-use-of-the-operator-with-list-objects" class="nav-item nav-link">Special use of the </a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#boolean-operators" class="nav-item nav-link">Boolean Operators</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#performance-of-query" class="nav-item nav-link">Performance of </a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#duplicate-data" class="nav-item nav-link">Duplicate Data</a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#dictionary-like-get-method" class="nav-item nav-link">Dictionary-like </a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#the-lookup-method" class="nav-item nav-link">The </a>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#index-objects" class="nav-item nav-link">Index objects</a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#setting-metadata" class="nav-item nav-link">Setting metadata</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#set-operations-on-index-objects" class="nav-item nav-link">Set operations on Index objects</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#missing-values" class="nav-item nav-link">Missing values</a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#set-reset-index" class="nav-item nav-link">Set / Reset Index</a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#set-an-index" class="nav-item nav-link">Set an index</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#reset-the-index" class="nav-item nav-link">Reset the index</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#adding-an-ad-hoc-index" class="nav-item nav-link">Adding an ad hoc index</a>
        </li>
    
            </ul>
        </li>
    
        <li class="toc-entry toc-h2">
            <a href="#returning-a-view-versus-a-copy" class="nav-item nav-link">Returning a view versus a copy</a><ul>
                
        <li class="toc-entry toc-h3">
            <a href="#why-does-assignment-fail-when-using-chained-indexing" class="nav-item nav-link">Why does assignment fail when using chained indexing?</a>
        </li>
    
        <li class="toc-entry toc-h3">
            <a href="#evaluation-order-matters" class="nav-item nav-link">Evaluation order matters</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>
              
            </div>

          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              <div>
                
  <div class="section" id="indexing-and-selecting-data">
<span id="indexing"></span><h1>Indexing and Selecting Data<a class="headerlink" href="#indexing-and-selecting-data" title="Permalink to this headline">¶</a></h1>
<p>The axis labeling information in pandas objects serves many purposes:</p>
<ul class="simple">
<li><p>Identifies data (i.e. provides <em>metadata</em>) using known indicators,
important for analysis, visualization, and interactive console display.</p></li>
<li><p>Enables automatic and explicit data alignment.</p></li>
<li><p>Allows intuitive getting and setting of subsets of the data set.</p></li>
</ul>
<p>In this section, we will focus on the final point: namely, how to slice, dice,
and generally get and set subsets of pandas objects. The primary focus will be
on Series and DataFrame as they have received more development attention in
this area.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The Python and NumPy indexing operators <code class="docutils literal notranslate"><span class="pre">[]</span></code> and attribute operator <code class="docutils literal notranslate"><span class="pre">.</span></code>
provide quick and easy access to pandas data structures across a wide range
of use cases. This makes interactive work intuitive, as there’s little new
to learn if you already know how to deal with Python dictionaries and NumPy
arrays. However, since the type of the data to be accessed isn’t known in
advance, directly using standard operators has some optimization limits. For
production code, we recommended that you take advantage of the optimized
pandas data access methods exposed in this chapter.</p>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Whether a copy or a reference is returned for a setting operation, may
depend on the context. This is sometimes called <code class="docutils literal notranslate"><span class="pre">chained</span> <span class="pre">assignment</span></code> and
should be avoided. See <a class="reference internal" href="#indexing-view-versus-copy"><span class="std std-ref">Returning a View versus Copy</span></a>.</p>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Indexing on an integer-based Index with floats has been clarified in 0.18.0, for a summary of the changes, see <a class="reference internal" href="../whatsnew/v0.18.0.html#whatsnew-0180-float-indexers"><span class="std std-ref">here</span></a>.</p>
</div>
<p>See the <a class="reference internal" href="advanced.html#advanced"><span class="std std-ref">MultiIndex / Advanced Indexing</span></a> for <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> and more advanced indexing documentation.</p>
<p>See the <a class="reference internal" href="cookbook.html#cookbook-selection"><span class="std std-ref">cookbook</span></a> for some advanced strategies.</p>
<div class="section" id="different-choices-for-indexing">
<span id="indexing-choice"></span><h2>Different Choices for Indexing<a class="headerlink" href="#different-choices-for-indexing" title="Permalink to this headline">¶</a></h2>
<p>Object selection has had a number of user-requested additions in order to
support more explicit location based indexing. Pandas now supports three types
of multi-axis indexing.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> is primarily label based, but may also be used with a boolean array. <code class="docutils literal notranslate"><span class="pre">.loc</span></code> will raise <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> when the items are not found. Allowed inputs are:</p>
<blockquote>
<div><ul>
<li><p>A single label, e.g. <code class="docutils literal notranslate"><span class="pre">5</span></code> or <code class="docutils literal notranslate"><span class="pre">'a'</span></code> (Note that <code class="docutils literal notranslate"><span class="pre">5</span></code> is interpreted as a
<em>label</em> of the index. This use is <strong>not</strong> an integer position along the
index.).</p></li>
<li><p>A list or array of labels <code class="docutils literal notranslate"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c']</span></code>.</p></li>
<li><p>A slice object with labels <code class="docutils literal notranslate"><span class="pre">'a':'f'</span></code> (Note that contrary to usual python
slices, <strong>both</strong> the start and the stop are included, when present in the
index! See <a class="reference internal" href="#indexing-slicing-with-labels"><span class="std std-ref">Slicing with labels</span></a>.).</p></li>
<li><p>A boolean array</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">callable</span></code> function with one argument (the calling Series or DataFrame) and
that returns valid output for indexing (one of the above).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1.</span></p>
</div>
</li>
</ul>
</div></blockquote>
<p>See more at <a class="reference internal" href="#indexing-label"><span class="std std-ref">Selection by Label</span></a>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code> is primarily integer position based (from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">length-1</span></code> of the axis), but may also be used with a boolean
array.  <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> will raise <code class="docutils literal notranslate"><span class="pre">IndexError</span></code> if a requested
indexer is out-of-bounds, except <em>slice</em> indexers which allow
out-of-bounds indexing.  (this conforms with Python/NumPy <em>slice</em>
semantics).  Allowed inputs are:</p>
<blockquote>
<div><ul>
<li><p>An integer e.g. <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p>A list or array of integers <code class="docutils literal notranslate"><span class="pre">[4,</span> <span class="pre">3,</span> <span class="pre">0]</span></code>.</p></li>
<li><p>A slice object with ints <code class="docutils literal notranslate"><span class="pre">1:7</span></code>.</p></li>
<li><p>A boolean array.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">callable</span></code> function with one argument (the calling Series or DataFrame) and
that returns valid output for indexing (one of the above).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1.</span></p>
</div>
</li>
</ul>
</div></blockquote>
<p>See more at <a class="reference internal" href="#indexing-integer"><span class="std std-ref">Selection by Position</span></a>,
<a class="reference internal" href="advanced.html#advanced"><span class="std std-ref">Advanced Indexing</span></a> and <a class="reference internal" href="advanced.html#advanced-advanced-hierarchical"><span class="std std-ref">Advanced
Hierarchical</span></a>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code>, <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>, and also <code class="docutils literal notranslate"><span class="pre">[]</span></code> indexing can accept a <code class="docutils literal notranslate"><span class="pre">callable</span></code> as indexer. See more at <a class="reference internal" href="#indexing-callable"><span class="std std-ref">Selection By Callable</span></a>.</p></li>
</ul>
<p>Getting values from an object with multi-axes selection uses the following
notation (using <code class="docutils literal notranslate"><span class="pre">.loc</span></code> as an example, but the following applies to <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> as
well). Any of the axes accessors may be the null slice <code class="docutils literal notranslate"><span class="pre">:</span></code>. Axes left out of
the specification are assumed to be <code class="docutils literal notranslate"><span class="pre">:</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">p.loc['a']</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">p.loc['a',</span> <span class="pre">:,</span> <span class="pre">:]</span></code>.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 38%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Object Type</p></th>
<th class="head"><p>Indexers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Series</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s.loc[indexer]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>DataFrame</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.loc[row_indexer,column_indexer]</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="basics">
<span id="indexing-basics"></span><h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>As mentioned when introducing the data structures in the <a class="reference internal" href="../getting_started/basics.html#basics"><span class="std std-ref">last section</span></a>, the primary function of indexing with <code class="docutils literal notranslate"><span class="pre">[]</span></code> (a.k.a. <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
for those familiar with implementing class behavior in Python) is selecting out
lower-dimensional slices. The following table shows return type values when
indexing pandas objects with <code class="docutils literal notranslate"><span class="pre">[]</span></code>:</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Object Type</p></th>
<th class="head"><p>Selection</p></th>
<th class="head"><p>Return Value Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Series</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">series[label]</span></code></p></td>
<td><p>scalar value</p></td>
</tr>
<tr class="row-odd"><td><p>DataFrame</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">frame[colname]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Series</span></code> corresponding to colname</p></td>
</tr>
</tbody>
</table>
<p>Here we construct a simple time series data set to use for illustrating the
indexing functionality:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....: </span>                  <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span>

<span class="gp">In [11]: </span><span class="n">df</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>None of the indexing functionality is time series specific unless
specifically stated.</p>
</div>
<p>Thus, as per above, we have the most basic indexing using <code class="docutils literal notranslate"><span class="pre">[]</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="n">s</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
</pre></div>
</div>
<p>You can pass a list of columns to <code class="docutils literal notranslate"><span class="pre">[]</span></code> to select columns in that order.
If a column is not contained in the DataFrame, an exception will be
raised. Multiple columns can also be set in this manner:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">df</span>

<span class="gp">In [15]: </span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [16]: </span><span class="n">df</span>
</pre></div>
</div>
<p>You may find this useful for applying a transform (in-place) to a subset of the
columns.</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>pandas aligns all AXES when setting <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from <code class="docutils literal notranslate"><span class="pre">.loc</span></code>, and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>.</p>
<p>This will <strong>not</strong> modify <code class="docutils literal notranslate"><span class="pre">df</span></code> because the column alignment is before value assignment.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [18]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [19]: </span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>The correct way to swap column values is by using raw values:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="gp">In [21]: </span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="attribute-access">
<h2>Attribute Access<a class="headerlink" href="#attribute-access" title="Permalink to this headline">¶</a></h2>
<p id="indexing-attribute-access"><span id="indexing-df-cols"></span><span id="indexing-columns-multiple"></span>You may access an index on a <code class="docutils literal notranslate"><span class="pre">Series</span></code> or  column on a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> directly
as an attribute:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">sa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [23]: </span><span class="n">dfa</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">sa</span><span class="o">.</span><span class="n">b</span>

<span class="gp">In [25]: </span><span class="n">dfa</span><span class="o">.</span><span class="n">A</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">sa</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [27]: </span><span class="n">sa</span>

<span class="gp">In [28]: </span><span class="n">dfa</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfa</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>  <span class="c1"># ok if A already exists</span>

<span class="gp">In [29]: </span><span class="n">dfa</span>

<span class="gp">In [30]: </span><span class="n">dfa</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfa</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>  <span class="c1"># use this form to create a new column</span>

<span class="gp">In [31]: </span><span class="n">dfa</span>
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>You can use this access only if the index element is a valid Python identifier, e.g. <code class="docutils literal notranslate"><span class="pre">s.1</span></code> is not allowed.
See <a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#identifiers">here for an explanation of valid identifiers</a>.</p></li>
<li><p>The attribute will not be available if it conflicts with an existing method name, e.g. <code class="docutils literal notranslate"><span class="pre">s.min</span></code> is not allowed.</p></li>
<li><p>Similarly, the attribute will not be available if it conflicts with any of the following list: <code class="docutils literal notranslate"><span class="pre">index</span></code>,
<code class="docutils literal notranslate"><span class="pre">major_axis</span></code>, <code class="docutils literal notranslate"><span class="pre">minor_axis</span></code>, <code class="docutils literal notranslate"><span class="pre">items</span></code>.</p></li>
<li><p>In any of these cases, standard indexing will still work, e.g. <code class="docutils literal notranslate"><span class="pre">s['1']</span></code>, <code class="docutils literal notranslate"><span class="pre">s['min']</span></code>, and <code class="docutils literal notranslate"><span class="pre">s['index']</span></code> will
access the corresponding element or column.</p></li>
</ul>
</div>
<p>If you are using the IPython environment, you may also use tab-completion to
see these accessible attributes.</p>
<p>You can also assign a <code class="docutils literal notranslate"><span class="pre">dict</span></code> to a row of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="gp">In [33]: </span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">99</span><span class="p">}</span>

<span class="gp">In [34]: </span><span class="n">x</span>
</pre></div>
</div>
<p>You can use attribute access to modify an existing element of a Series or column of a DataFrame, but be careful;
if you try to use attribute access to create a new column, it creates a new attribute rather than a
new column. In 0.21.0 and later, this will raise a <code class="docutils literal notranslate"><span class="pre">UserWarning</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]})</span>
<span class="gp">In [2]: </span><span class="n">df</span><span class="o">.</span><span class="n">two</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="go">UserWarning: Pandas doesn&#39;t allow Series to be assigned into nonexistent columns - see https://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute_access</span>
<span class="gp">In [3]: </span><span class="n">df</span>
<span class="gh">Out[3]:</span>
<span class="go">   one</span>
<span class="go">0  1.0</span>
<span class="go">1  2.0</span>
<span class="go">2  3.0</span>
</pre></div>
</div>
</div>
<div class="section" id="slicing-ranges">
<h2>Slicing ranges<a class="headerlink" href="#slicing-ranges" title="Permalink to this headline">¶</a></h2>
<p>The most robust and consistent way of slicing ranges along arbitrary axes is
described in the <a class="reference internal" href="#indexing-integer"><span class="std std-ref">Selection by Position</span></a> section
detailing the <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> method. For now, we explain the semantics of slicing using the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator.</p>
<p>With Series, the syntax works exactly as with an ndarray, returning a slice of
the values and the corresponding labels:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">s</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [36]: </span><span class="n">s</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [37]: </span><span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that setting works as well:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [39]: </span><span class="n">s2</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [40]: </span><span class="n">s2</span>
</pre></div>
</div>
<p>With DataFrame, slicing inside of <code class="docutils literal notranslate"><span class="pre">[]</span></code> <strong>slices the rows</strong>. This is provided
largely as a convenience since it is such a common operation.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">df</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [42]: </span><span class="n">df</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="selection-by-label">
<span id="indexing-label"></span><h2>Selection By Label<a class="headerlink" href="#selection-by-label" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Whether a copy or a reference is returned for a setting operation, may depend on the context.
This is sometimes called <code class="docutils literal notranslate"><span class="pre">chained</span> <span class="pre">assignment</span></code> and should be avoided.
See <a class="reference internal" href="#indexing-view-versus-copy"><span class="std std-ref">Returning a View versus Copy</span></a>.</p>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> is strict when you present slicers that are not compatible (or convertible) with the index type. For example
using integers in a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>. These will raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>.</p>
</div></blockquote>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">dfl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">   ....: </span>

<span class="gp">In [44]: </span><span class="n">dfl</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">dfl</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">TypeError: cannot do slice indexing on &lt;class &#39;pandas.tseries.index.DatetimeIndex&#39;&gt; with these indexers [2] of &lt;type &#39;int&#39;&gt;</span>
</pre></div>
</div>
<p>String likes in slicing <em>can</em> be convertible to the type of the index and lead to natural slicing.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">dfl</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20130102&#39;</span><span class="p">:</span><span class="s1">&#39;20130104&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Starting in 0.21.0, pandas will show a <code class="docutils literal notranslate"><span class="pre">FutureWarning</span></code> if indexing with a list with missing labels. In the future
this will raise a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>. See <a class="reference internal" href="#indexing-deprecate-loc-reindex-listlike"><span class="std std-ref">list-like Using loc with missing keys in a list is Deprecated</span></a>.</p>
</div>
<p>pandas provides a suite of methods in order to have <strong>purely label based indexing</strong>. This is a strict inclusion based protocol.
Every label asked for must be in the index, or a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised.
When slicing, both the start bound <strong>AND</strong> the stop bound are <em>included</em>, if present in the index.
Integers are valid labels, but they refer to the label <strong>and not the position</strong>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.loc</span></code> attribute is the primary access method. The following are valid inputs:</p>
<ul class="simple">
<li><p>A single label, e.g. <code class="docutils literal notranslate"><span class="pre">5</span></code> or <code class="docutils literal notranslate"><span class="pre">'a'</span></code> (Note that <code class="docutils literal notranslate"><span class="pre">5</span></code> is interpreted as a <em>label</em> of the index. This use is <strong>not</strong> an integer position along the index.).</p></li>
<li><p>A list or array of labels <code class="docutils literal notranslate"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c']</span></code>.</p></li>
<li><p>A slice object with labels <code class="docutils literal notranslate"><span class="pre">'a':'f'</span></code> (Note that contrary to usual python
slices, <strong>both</strong> the start and the stop are included, when present in the
index! See <a class="reference internal" href="#indexing-slicing-with-labels"><span class="std std-ref">Slicing with labels</span></a>.).</p></li>
<li><p>A boolean array.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">callable</span></code>, see <a class="reference internal" href="#indexing-callable"><span class="std std-ref">Selection By Callable</span></a>.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">))</span>

<span class="gp">In [47]: </span><span class="n">s1</span>

<span class="gp">In [48]: </span><span class="n">s1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">:]</span>

<span class="gp">In [49]: </span><span class="n">s1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that setting works as well:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">s1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [51]: </span><span class="n">s1</span>
</pre></div>
</div>
<p>With a DataFrame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>
<span class="gp">   ....: </span>

<span class="gp">In [53]: </span><span class="n">df1</span>

<span class="gp">In [54]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
<p>Accessing via label slices:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">:,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>For getting a cross section using a label (equivalent to <code class="docutils literal notranslate"><span class="pre">df.xs('a')</span></code>):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [56]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>For getting values with a boolean array:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="gp">In [58]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>For getting a value explicitly (equivalent to deprecated <code class="docutils literal notranslate"><span class="pre">df.get_value('a','A')</span></code>):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># this is also equivalent to ``df1.at[&#39;a&#39;,&#39;A&#39;]``</span>
<span class="gp">In [59]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="slicing-with-labels">
<span id="indexing-slicing-with-labels"></span><h3>Slicing with labels<a class="headerlink" href="#slicing-with-labels" title="Permalink to this headline">¶</a></h3>
<p>When using <code class="docutils literal notranslate"><span class="pre">.loc</span></code> with slices, if both the start and the stop labels are
present in the index, then elements <em>located</em> between the two (including them)
are returned:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="gp">In [61]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>If at least one of the two is absent, but the index is sorted, and can be
compared against start and stop labels, then slicing will still work as
expected, by selecting labels which <em>rank</em> between the two:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [62]: </span><span class="n">s</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="gp">In [63]: </span><span class="n">s</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>However, if at least one of the two is absent <em>and</em> the index is not sorted, an
error will be raised (since doing otherwise would be computationally expensive,
as well as potentially ambiguous for mixed type indexes). For instance, in the
above example, <code class="docutils literal notranslate"><span class="pre">s.loc[1:6]</span></code> would raise <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
</div>
</div>
<div class="section" id="selection-by-position">
<span id="indexing-integer"></span><h2>Selection By Position<a class="headerlink" href="#selection-by-position" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Whether a copy or a reference is returned for a setting operation, may depend on the context.
This is sometimes called <code class="docutils literal notranslate"><span class="pre">chained</span> <span class="pre">assignment</span></code> and should be avoided.
See <a class="reference internal" href="#indexing-view-versus-copy"><span class="std std-ref">Returning a View versus Copy</span></a>.</p>
</div>
<p>Pandas provides a suite of methods in order to get <strong>purely integer based indexing</strong>. The semantics follow closely Python and NumPy slicing. These are <code class="docutils literal notranslate"><span class="pre">0-based</span></code> indexing. When slicing, the start bound is <em>included</em>, while the upper bound is <em>excluded</em>. Trying to use a non-integer, even a <strong>valid</strong> label will raise an <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> attribute is the primary access method. The following are valid inputs:</p>
<ul class="simple">
<li><p>An integer e.g. <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p>A list or array of integers <code class="docutils literal notranslate"><span class="pre">[4,</span> <span class="pre">3,</span> <span class="pre">0]</span></code>.</p></li>
<li><p>A slice object with ints <code class="docutils literal notranslate"><span class="pre">1:7</span></code>.</p></li>
<li><p>A boolean array.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">callable</span></code>, see <a class="reference internal" href="#indexing-callable"><span class="std std-ref">Selection By Callable</span></a>.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>

<span class="gp">In [65]: </span><span class="n">s1</span>

<span class="gp">In [66]: </span><span class="n">s1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [67]: </span><span class="n">s1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that setting works as well:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [68]: </span><span class="n">s1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [69]: </span><span class="n">s1</span>
</pre></div>
</div>
<p>With a DataFrame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [70]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
<span class="gp">   ....: </span>                   <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">   ....: </span>

<span class="gp">In [71]: </span><span class="n">df1</span>
</pre></div>
</div>
<p>Select via integer slicing:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [72]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [73]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>Select via integer list:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [74]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [75]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [76]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># this is also equivalent to ``df1.iat[1,1]``</span>
<span class="gp">In [77]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For getting a cross section using an integer position (equiv to <code class="docutils literal notranslate"><span class="pre">df.xs(1)</span></code>):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [78]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Out of range slice indexes are handled gracefully just as in Python/Numpy.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># these are allowed in python/numpy.</span>
<span class="gp">In [79]: </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">)</span>

<span class="gp">In [80]: </span><span class="n">x</span>

<span class="gp">In [81]: </span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>

<span class="gp">In [82]: </span><span class="n">x</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>

<span class="gp">In [83]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [84]: </span><span class="n">s</span>

<span class="gp">In [85]: </span><span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>

<span class="gp">In [86]: </span><span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that using slices that go out of bounds can result in
an empty axis (e.g. an empty DataFrame being returned).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [87]: </span><span class="n">dfl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>

<span class="gp">In [88]: </span><span class="n">dfl</span>

<span class="gp">In [89]: </span><span class="n">dfl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [90]: </span><span class="n">dfl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [91]: </span><span class="n">dfl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>A single indexer that is out of bounds will raise an <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>.
A list of indexers where any element is out of bounds will raise an
<code class="docutils literal notranslate"><span class="pre">IndexError</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dfl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="go">IndexError: positional indexers are out-of-bounds</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dfl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
<span class="go">IndexError: single positional indexer is out-of-bounds</span>
</pre></div>
</div>
</div>
<div class="section" id="selection-by-callable">
<span id="indexing-callable"></span><h2>Selection By Callable<a class="headerlink" href="#selection-by-callable" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.loc</span></code>, <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>, and also <code class="docutils literal notranslate"><span class="pre">[]</span></code> indexing can accept a <code class="docutils literal notranslate"><span class="pre">callable</span></code> as indexer.
The <code class="docutils literal notranslate"><span class="pre">callable</span></code> must be a function with one argument (the calling Series or DataFrame) that returns valid output for indexing.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [92]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">),</span>
<span class="gp">   ....: </span>                   <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>
<span class="gp">   ....: </span>

<span class="gp">In [93]: </span><span class="n">df1</span>

<span class="gp">In [94]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>

<span class="gp">In [95]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [96]: </span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

<span class="gp">In [97]: </span><span class="n">df1</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<p>You can use callable indexing in <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [98]: </span><span class="n">df1</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Using these methods / indexers, you can chain data selection operations
without using a temporary variable.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [99]: </span><span class="n">bb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/baseball.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="gp">In [100]: </span><span class="p">(</span><span class="n">bb</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;team&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">   .....: </span>   <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">r</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">])</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
</div>
<div class="section" id="ix-indexer-is-deprecated">
<span id="indexing-deprecate-ix"></span><h2>IX Indexer is Deprecated<a class="headerlink" href="#ix-indexer-is-deprecated" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Starting in 0.20.0, the <code class="docutils literal notranslate"><span class="pre">.ix</span></code> indexer is deprecated, in favor of the more strict <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>
and <code class="docutils literal notranslate"><span class="pre">.loc</span></code> indexers.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.ix</span></code> offers a lot of magic on the inference of what the user wants to do. To wit, <code class="docutils literal notranslate"><span class="pre">.ix</span></code> can decide
to index <em>positionally</em> OR via <em>labels</em> depending on the data type of the index. This has caused quite a
bit of user confusion over the years.</p>
<p>The recommended methods of indexing are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> if you want to <em>label</em> index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code> if you want to <em>positionally</em> index.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [101]: </span><span class="n">dfd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span>
<span class="gp">   .....: </span>                   <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [102]: </span><span class="n">dfd</span>
</pre></div>
</div>
<p>Previous behavior, where you wish to get the 0th and the 2nd elements from the index in the ‘A’ column.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">dfd</span><span class="o">.</span><span class="n">ix</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="gh">Out[3]:</span>
<span class="go">a    1</span>
<span class="go">c    3</span>
<span class="go">Name: A, dtype: int64</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">.loc</span></code>. Here we will select the appropriate indexes from the index, then use <em>label</em> indexing.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [103]: </span><span class="n">dfd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfd</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This can also be expressed using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>, by explicitly getting locations on the indexers, and using
<em>positional</em> indexing to select things.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [104]: </span><span class="n">dfd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dfd</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>For getting <em>multiple</em> indexers, using <code class="docutils literal notranslate"><span class="pre">.get_indexer</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [105]: </span><span class="n">dfd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dfd</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="section" id="indexing-with-list-with-missing-labels-is-deprecated">
<span id="indexing-deprecate-loc-reindex-listlike"></span><span id="deprecate-loc-reindex-listlike"></span><h2>Indexing with list with missing labels is Deprecated<a class="headerlink" href="#indexing-with-list-with-missing-labels-is-deprecated" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Starting in 0.21.0, using <code class="docutils literal notranslate"><span class="pre">.loc</span></code> or <code class="docutils literal notranslate"><span class="pre">[]</span></code> with a list with one or more missing labels, is deprecated, in favor of <code class="docutils literal notranslate"><span class="pre">.reindex</span></code>.</p>
</div>
<p>In prior versions, using <code class="docutils literal notranslate"><span class="pre">.loc[list-of-labels]</span></code> would work as long as <em>at least 1</em> of the keys was found (otherwise it
would raise a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>). This behavior is deprecated and will show a warning message pointing to this section. The
recommended alternative is to use <code class="docutils literal notranslate"><span class="pre">.reindex()</span></code>.</p>
<p>For example.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [106]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [107]: </span><span class="n">s</span>
</pre></div>
</div>
<p>Selection with all keys found is unchanged.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [108]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<p>Previous Behavior</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="gh">Out[4]:</span>
<span class="go">1    2.0</span>
<span class="go">2    3.0</span>
<span class="go">3    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Current Behavior</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="go">Passing list-likes to .loc with any non-matching elements will raise</span>
<span class="go">KeyError in the future, you can use .reindex() as an alternative.</span>

<span class="go">See the documentation here:</span>
<span class="go">http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike</span>

<span class="gh">Out[4]:</span>
<span class="go">1    2.0</span>
<span class="go">2    3.0</span>
<span class="go">3    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<div class="section" id="reindexing">
<h3>Reindexing<a class="headerlink" href="#reindexing" title="Permalink to this headline">¶</a></h3>
<p>The idiomatic way to achieve selecting potentially not-found elements is via <code class="docutils literal notranslate"><span class="pre">.reindex()</span></code>. See also the section on <a class="reference internal" href="../getting_started/basics.html#basics-reindexing"><span class="std std-ref">reindexing</span></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [109]: </span><span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Alternatively, if you want to select only <em>valid</em> keys, the following is idiomatic and efficient; it is guaranteed to preserve the dtype of the selection.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [110]: </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [111]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>
</pre></div>
</div>
<p>Having a duplicated index will raise for a <code class="docutils literal notranslate"><span class="pre">.reindex()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [112]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="gp">In [113]: </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="go">ValueError: cannot reindex from a duplicate axis</span>
</pre></div>
</div>
<p>Generally, you can intersect the desired labels with the current
axis, and then reindex.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [114]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this would <em>still</em> raise if your resulting index is duplicated.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>

<span class="gp">In [42]: </span><span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="go">ValueError: cannot reindex from a duplicate axis</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selecting-random-samples">
<span id="indexing-basics-partial-setting"></span><h2>Selecting Random Samples<a class="headerlink" href="#selecting-random-samples" title="Permalink to this headline">¶</a></h2>
<p>A random selection of rows or columns from a Series or DataFrame with the <a class="reference internal" href="../reference/api/pandas.DataFrame.sample.html#pandas.DataFrame.sample" title="pandas.DataFrame.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> method. The method will sample rows by default, and accepts a specific number of rows/columns to return, or a fraction of rows.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [115]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="go"># When no arguments are passed, returns 1 row.</span>
<span class="gp">In [116]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

<span class="go"># One may specify either a number of rows:</span>
<span class="gp">In [117]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="go"># Or a fraction of the rows:</span>
<span class="gp">In [118]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">sample</span></code> will return each row at most once, but one can also sample with replacement
using the <code class="docutils literal notranslate"><span class="pre">replace</span></code> option:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [119]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="go"># Without replacement (default):</span>
<span class="gp">In [120]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="go"># With replacement:</span>
<span class="gp">In [121]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, each row has an equal probability of being selected, but if you want rows
to have different probabilities, you can pass the <code class="docutils literal notranslate"><span class="pre">sample</span></code> function sampling weights as
<code class="docutils literal notranslate"><span class="pre">weights</span></code>. These weights can be a list, a NumPy array, or a Series, but they must be of the same length as the object you are sampling. Missing values will be treated as a weight of zero, and inf values are not allowed. If weights do not sum to 1, they will be re-normalized by dividing all weights by the sum of the weights. For example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [122]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="gp">In [123]: </span><span class="n">example_weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>

<span class="gp">In [124]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">example_weights</span><span class="p">)</span>

<span class="go"># Weights will be re-normalized automatically</span>
<span class="gp">In [125]: </span><span class="n">example_weights2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="gp">In [126]: </span><span class="n">s</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">example_weights2</span><span class="p">)</span>
</pre></div>
</div>
<p>When applied to a DataFrame, you can use a column of the DataFrame as sampling weights
(provided you are sampling rows and not columns) by simply passing the name of the column
as a string.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [127]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;weight_column&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [128]: </span><span class="n">df2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;weight_column&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sample</span></code> also allows users to sample columns instead of rows using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [129]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="gp">In [130]: </span><span class="n">df3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, one can also set a seed for <code class="docutils literal notranslate"><span class="pre">sample</span></code>’s random number generator using the <code class="docutils literal notranslate"><span class="pre">random_state</span></code> argument, which will accept either an integer (as a seed) or a NumPy RandomState object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [131]: </span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="go"># With a given seed, the sample will always draw the same rows.</span>
<span class="gp">In [132]: </span><span class="n">df4</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [133]: </span><span class="n">df4</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-with-enlargement">
<h2>Setting With Enlargement<a class="headerlink" href="#setting-with-enlargement" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.loc/[]</span></code> operations can perform enlargement when setting a non-existent key for that axis.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">Series</span></code> case this is effectively an appending operation.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [134]: </span><span class="n">se</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [135]: </span><span class="n">se</span>

<span class="gp">In [136]: </span><span class="n">se</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>

<span class="gp">In [137]: </span><span class="n">se</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be enlarged on either axis via <code class="docutils literal notranslate"><span class="pre">.loc</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [138]: </span><span class="n">dfi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">   .....: </span>                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [139]: </span><span class="n">dfi</span>

<span class="gp">In [140]: </span><span class="n">dfi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="gp">In [141]: </span><span class="n">dfi</span>
</pre></div>
</div>
<p>This is like an <code class="docutils literal notranslate"><span class="pre">append</span></code> operation on the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [142]: </span><span class="n">dfi</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [143]: </span><span class="n">dfi</span>
</pre></div>
</div>
</div>
<div class="section" id="fast-scalar-value-getting-and-setting">
<span id="indexing-basics-get-value"></span><h2>Fast scalar value getting and setting<a class="headerlink" href="#fast-scalar-value-getting-and-setting" title="Permalink to this headline">¶</a></h2>
<p>Since indexing with <code class="docutils literal notranslate"><span class="pre">[]</span></code> must handle a lot of cases (single-label access,
slicing, boolean indexing, etc.), it has a bit of overhead in order to figure
out what you’re asking for. If you only want to access a scalar value, the
fastest way is to use the <code class="docutils literal notranslate"><span class="pre">at</span></code> and <code class="docutils literal notranslate"><span class="pre">iat</span></code> methods, which are implemented on
all of the data structures.</p>
<p>Similarly to <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">at</span></code> provides <strong>label</strong> based scalar lookups, while, <code class="docutils literal notranslate"><span class="pre">iat</span></code> provides <strong>integer</strong> based lookups analogously to <code class="docutils literal notranslate"><span class="pre">iloc</span></code></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [144]: </span><span class="n">s</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [145]: </span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="gp">In [146]: </span><span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>You can also set using these same indexers.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [147]: </span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>

<span class="gp">In [148]: </span><span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">at</span></code> may enlarge the object in-place as above if the indexer is missing.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [149]: </span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>

<span class="gp">In [150]: </span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="section" id="boolean-indexing">
<h2>Boolean indexing<a class="headerlink" href="#boolean-indexing" title="Permalink to this headline">¶</a></h2>
<p id="indexing-boolean">Another common operation is the use of boolean vectors to filter the data.
The operators are: <code class="docutils literal notranslate"><span class="pre">|</span></code> for <code class="docutils literal notranslate"><span class="pre">or</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> for <code class="docutils literal notranslate"><span class="pre">and</span></code>, and <code class="docutils literal notranslate"><span class="pre">~</span></code> for <code class="docutils literal notranslate"><span class="pre">not</span></code>.
These <strong>must</strong> be grouped by using parentheses, since by default Python will
evaluate an expression such as <code class="docutils literal notranslate"><span class="pre">df.A</span> <span class="pre">&gt;</span> <span class="pre">2</span> <span class="pre">&amp;</span> <span class="pre">df.B</span> <span class="pre">&lt;</span> <span class="pre">3</span></code> as
<code class="docutils literal notranslate"><span class="pre">df.A</span> <span class="pre">&gt;</span> <span class="pre">(2</span> <span class="pre">&amp;</span> <span class="pre">df.B)</span> <span class="pre">&lt;</span> <span class="pre">3</span></code>, while the desired evaluation order is
<code class="docutils literal notranslate"><span class="pre">(df.A</span> <span class="pre">&gt;</span> <span class="pre">2)</span> <span class="pre">&amp;</span> <span class="pre">(df.B</span> <span class="pre">&lt;</span> <span class="pre">3)</span></code>.</p>
<p>Using a boolean vector to index a Series works exactly as in a NumPy ndarray:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [151]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">In [152]: </span><span class="n">s</span>

<span class="gp">In [153]: </span><span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="gp">In [154]: </span><span class="n">s</span><span class="p">[(</span><span class="n">s</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)]</span>

<span class="gp">In [155]: </span><span class="n">s</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">s</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
<p>You may select rows from a DataFrame using a boolean vector the same length as
the DataFrame’s index (for example, something derived from one of the columns
of the DataFrame):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [156]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>List comprehensions and the <code class="docutils literal notranslate"><span class="pre">map</span></code> method of Series can also be used to produce
more complex criteria:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [157]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="go"># only want &#39;two&#39; or &#39;three&#39;</span>
<span class="gp">In [158]: </span><span class="n">criterion</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>

<span class="gp">In [159]: </span><span class="n">df2</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>

<span class="go"># equivalent but slower</span>
<span class="gp">In [160]: </span><span class="n">df2</span><span class="p">[[</span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]]]</span>

<span class="go"># Multiple criteria</span>
<span class="gp">In [161]: </span><span class="n">df2</span><span class="p">[</span><span class="n">criterion</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>With the choice methods <a class="reference internal" href="#indexing-label"><span class="std std-ref">Selection by Label</span></a>, <a class="reference internal" href="#indexing-integer"><span class="std std-ref">Selection by Position</span></a>,
and <a class="reference internal" href="advanced.html#advanced"><span class="std std-ref">Advanced Indexing</span></a> you may select along more than one axis using boolean vectors combined with other indexing expressions.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [162]: </span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criterion</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="indexing-with-isin">
<span id="indexing-basics-indexing-isin"></span><h2>Indexing with isin<a class="headerlink" href="#indexing-with-isin" title="Permalink to this headline">¶</a></h2>
<p>Consider the <code class="xref py py-meth docutils literal notranslate"><span class="pre">isin()</span></code> method of <code class="docutils literal notranslate"><span class="pre">Series</span></code>, which returns a boolean
vector that is true wherever the <code class="docutils literal notranslate"><span class="pre">Series</span></code> elements exist in the passed list.
This allows you to select rows where one or more columns have values you want:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [163]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="gp">In [164]: </span><span class="n">s</span>

<span class="gp">In [165]: </span><span class="n">s</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="gp">In [166]: </span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])]</span>
</pre></div>
</div>
<p>The same method is available for <code class="docutils literal notranslate"><span class="pre">Index</span></code> objects and is useful for the cases
when you don’t know which of the sought labels are in fact present:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [167]: </span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])]</span>

<span class="go"># compare it to the following</span>
<span class="gp">In [168]: </span><span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>In addition to that, <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> allows selecting a separate level to use
in the membership check:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [169]: </span><span class="n">s_mi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
<span class="gp">   .....: </span>                 <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]]))</span>
<span class="gp">   .....: </span>

<span class="gp">In [170]: </span><span class="n">s_mi</span>

<span class="gp">In [171]: </span><span class="n">s_mi</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">s_mi</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)])]</span>

<span class="gp">In [172]: </span><span class="n">s_mi</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">s_mi</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
<p>DataFrame also has an <a class="reference internal" href="../reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin" title="pandas.DataFrame.isin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isin()</span></code></a> method.  When calling <code class="docutils literal notranslate"><span class="pre">isin</span></code>, pass a set of
values as either an array or dict.  If values is an array, <code class="docutils literal notranslate"><span class="pre">isin</span></code> returns
a DataFrame of booleans that is the same shape as the original DataFrame, with True
wherever the element is in the sequence of values.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [173]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;vals&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;ids2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [174]: </span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="gp">In [175]: </span><span class="n">df</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p>Oftentimes you’ll want to match certain values with certain columns.
Just make values a <code class="docutils literal notranslate"><span class="pre">dict</span></code> where the key is the column, and the value is
a list of items you want to check for.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [176]: </span><span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;vals&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>

<span class="gp">In [177]: </span><span class="n">df</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p>Combine DataFrame’s <code class="docutils literal notranslate"><span class="pre">isin</span></code> with the <code class="docutils literal notranslate"><span class="pre">any()</span></code> and <code class="docutils literal notranslate"><span class="pre">all()</span></code> methods to
quickly select subsets of your data that meet a given criteria.
To select a row where each column meets its own criterion:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [178]: </span><span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;ids2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;vals&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>

<span class="gp">In [179]: </span><span class="n">row_mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [180]: </span><span class="n">df</span><span class="p">[</span><span class="n">row_mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-where-method-and-masking">
<span id="indexing-where-mask"></span><h2>The <a class="reference internal" href="../reference/api/pandas.DataFrame.where.html#pandas.DataFrame.where" title="pandas.DataFrame.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">where()</span></code></a> Method and Masking<a class="headerlink" href="#the-where-method-and-masking" title="Permalink to this headline">¶</a></h2>
<p>Selecting values from a Series with a boolean vector generally returns a
subset of the data. To guarantee that selection output has the same shape as
the original data, you can use the <code class="docutils literal notranslate"><span class="pre">where</span></code> method in <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>To return only the selected rows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [181]: </span><span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>To return a Series of the same shape as the original:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [182]: </span><span class="n">s</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Selecting values from a DataFrame with a boolean criterion now also preserves
input data shape. <code class="docutils literal notranslate"><span class="pre">where</span></code> is used under the hood as the implementation.
The code below is equivalent to <code class="docutils literal notranslate"><span class="pre">df.where(df</span> <span class="pre">&lt;</span> <span class="pre">0)</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [185]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>In addition, <code class="docutils literal notranslate"><span class="pre">where</span></code> takes an optional <code class="docutils literal notranslate"><span class="pre">other</span></code> argument for replacement of
values where the condition is False, in the returned copy.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [186]: </span><span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>You may wish to set values based on some boolean criteria.
This can be done intuitively like so:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [187]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [188]: </span><span class="n">s2</span><span class="p">[</span><span class="n">s2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [189]: </span><span class="n">s2</span>

<span class="gp">In [190]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [191]: </span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [192]: </span><span class="n">df2</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">where</span></code> returns a modified copy of the data. There is an
optional parameter <code class="docutils literal notranslate"><span class="pre">inplace</span></code> so that the original data can be modified
without creating a copy:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [193]: </span><span class="n">df_orig</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [194]: </span><span class="n">df_orig</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">df</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [195]: </span><span class="n">df_orig</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The signature for <a class="reference internal" href="../reference/api/pandas.DataFrame.where.html#pandas.DataFrame.where" title="pandas.DataFrame.where"><code class="xref py py-func docutils literal notranslate"><span class="pre">DataFrame.where()</span></code></a> differs from <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html#numpy.where" title="(in NumPy v1.17)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.where()</span></code></a>.
Roughly <code class="docutils literal notranslate"><span class="pre">df1.where(m,</span> <span class="pre">df2)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">np.where(m,</span> <span class="pre">df1,</span> <span class="pre">df2)</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [196]: </span><span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="o">-</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>alignment</strong></p>
<p>Furthermore, <code class="docutils literal notranslate"><span class="pre">where</span></code> aligns the input boolean condition (ndarray or DataFrame),
such that partial selection with setting is possible. This is analogous to
partial setting via <code class="docutils literal notranslate"><span class="pre">.loc</span></code> (but on the contents rather than the axis labels).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [197]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [198]: </span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="gp">In [199]: </span><span class="n">df2</span>
</pre></div>
</div>
<p>Where can also accept <code class="docutils literal notranslate"><span class="pre">axis</span></code> and <code class="docutils literal notranslate"><span class="pre">level</span></code> parameters to align the input when
performing the <code class="docutils literal notranslate"><span class="pre">where</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [200]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [201]: </span><span class="n">df2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is equivalent to (but faster than) the following.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [202]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [203]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1.</span></p>
</div>
<p>Where can accept a callable as condition and <code class="docutils literal notranslate"><span class="pre">other</span></code> arguments. The function must
be with one argument (the calling Series or DataFrame) and that returns valid output
as condition and <code class="docutils literal notranslate"><span class="pre">other</span></code> argument.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [204]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [205]: </span><span class="n">df3</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="mask">
<h3>Mask<a class="headerlink" href="#mask" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../reference/api/pandas.DataFrame.mask.html#pandas.DataFrame.mask" title="pandas.DataFrame.mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mask()</span></code></a> is the inverse boolean operation of <code class="docutils literal notranslate"><span class="pre">where</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [206]: </span><span class="n">s</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>

<span class="gp">In [207]: </span><span class="n">df</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-query-method">
<span id="indexing-query"></span><h2>The <a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> Method<a class="headerlink" href="#the-query-method" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a> objects have a <a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a>
method that allows selection using an expression.</p>
<p>You can get the value of the frame where column <code class="docutils literal notranslate"><span class="pre">b</span></code> has values
between the values of columns <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>. For example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [208]: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="gp">In [209]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [210]: </span><span class="n">df</span>

<span class="go"># pure python</span>
<span class="gp">In [211]: </span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">)]</span>

<span class="go"># query</span>
<span class="gp">In [212]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(a &lt; b) &amp; (b &lt; c)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Do the same thing but fall back on a named index if there is no column
with the name <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [213]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bc&#39;</span><span class="p">))</span>

<span class="gp">In [214]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>

<span class="gp">In [215]: </span><span class="n">df</span>

<span class="gp">In [216]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &lt; b and b &lt; c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If instead you don’t want to or cannot name your index, you can use the name
<code class="docutils literal notranslate"><span class="pre">index</span></code> in your query expression:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [217]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bc&#39;</span><span class="p">))</span>

<span class="gp">In [218]: </span><span class="n">df</span>

<span class="gp">In [219]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;index &lt; b &lt; c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>If the name of your index overlaps with a column name, the column name is
given precedence. For example,</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [220]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)})</span>

<span class="gp">In [221]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>

<span class="gp">In [222]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &gt; 2&#39;</span><span class="p">)</span>  <span class="c1"># uses the column &#39;a&#39;, not the index</span>
</pre></div>
</div>
<p>You can still use the index in a query expression by using the special
identifier ‘index’:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [223]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;index &gt; 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If for some reason you have a column named <code class="docutils literal notranslate"><span class="pre">index</span></code>, then you can refer to
the index as <code class="docutils literal notranslate"><span class="pre">ilevel_0</span></code> as well, but at this point you should consider
renaming your columns to something less ambiguous.</p>
</div>
<div class="section" id="multiindex-query-syntax">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiIndex</span></code> <a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> Syntax<a class="headerlink" href="#multiindex-query-syntax" title="Permalink to this headline">¶</a></h3>
<p>You can also use the levels of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with a
<code class="xref py py-class docutils literal notranslate"><span class="pre">MultiIndex</span></code> as if they were columns in the frame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [224]: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="gp">In [225]: </span><span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="gp">In [226]: </span><span class="n">foods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;eggs&#39;</span><span class="p">,</span> <span class="s1">&#39;ham&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="gp">In [227]: </span><span class="n">colors</span>

<span class="gp">In [228]: </span><span class="n">foods</span>

<span class="gp">In [229]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">colors</span><span class="p">,</span> <span class="n">foods</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;food&#39;</span><span class="p">])</span>

<span class="gp">In [230]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="gp">In [231]: </span><span class="n">df</span>

<span class="gp">In [232]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;color == &quot;red&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the levels of the <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> are unnamed, you can refer to them using
special names:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [233]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

<span class="gp">In [234]: </span><span class="n">df</span>

<span class="gp">In [235]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;ilevel_0 == &quot;red&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The convention is <code class="docutils literal notranslate"><span class="pre">ilevel_0</span></code>, which means “index level 0” for the 0th level
of the <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
</div>
<div class="section" id="query-use-cases">
<h3><a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> Use Cases<a class="headerlink" href="#query-use-cases" title="Permalink to this headline">¶</a></h3>
<p>A use case for <a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> is when you have a collection of
<a class="reference internal" href="../reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a> objects that have a subset of column names (or index
levels/names) in common. You can pass the same query to both frames <em>without</em>
having to specify which frame you’re interested in querying</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [236]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [237]: </span><span class="n">df</span>

<span class="gp">In [238]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="gp">In [239]: </span><span class="n">df2</span>

<span class="gp">In [240]: </span><span class="n">expr</span> <span class="o">=</span> <span class="s1">&#39;0.0 &lt;= a &lt;= c &lt;= 0.5&#39;</span>

<span class="gp">In [241]: </span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">frame</span><span class="p">:</span> <span class="n">frame</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="p">[</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="query-python-versus-pandas-syntax-comparison">
<h3><a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> Python versus pandas Syntax Comparison<a class="headerlink" href="#query-python-versus-pandas-syntax-comparison" title="Permalink to this headline">¶</a></h3>
<p>Full numpy-like syntax:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [242]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [243]: </span><span class="n">df</span>

<span class="gp">In [244]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(a &lt; b) &amp; (b &lt; c)&#39;</span><span class="p">)</span>

<span class="gp">In [245]: </span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">)]</span>
</pre></div>
</div>
<p>Slightly nicer by removing the parentheses (by binding making comparison
operators bind tighter than <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code>).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [246]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &lt; b &amp; b &lt; c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Use English instead of symbols:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [247]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &lt; b and b &lt; c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pretty close to how you might write it on paper:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [248]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &lt; b &lt; c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-in-and-not-in-operators">
<h3>The <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code> operators<a class="headerlink" href="#the-in-and-not-in-operators" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a> also supports special use of Python’s <code class="docutils literal notranslate"><span class="pre">in</span></code> and
<code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code> comparison operators, providing a succinct syntax for calling the
<code class="docutils literal notranslate"><span class="pre">isin</span></code> method of a <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># get all rows where columns &quot;a&quot; and &quot;b&quot; have overlapping values</span>
<span class="gp">In [249]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;aabbccddeeff&#39;</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;aaaabbbbcccc&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [250]: </span><span class="n">df</span>

<span class="gp">In [251]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a in b&#39;</span><span class="p">)</span>

<span class="go"># How you&#39;d do it in pure Python</span>
<span class="gp">In [252]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="p">)]</span>

<span class="gp">In [253]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a not in b&#39;</span><span class="p">)</span>

<span class="go"># pure Python</span>
<span class="gp">In [254]: </span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="p">)]</span>
</pre></div>
</div>
<p>You can combine this with other expressions for very succinct queries:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># rows where cols a and b have overlapping values</span>
<span class="go"># and col c&#39;s values are less than col d&#39;s</span>
<span class="gp">In [255]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a in b and c &lt; d&#39;</span><span class="p">)</span>

<span class="go"># pure Python</span>
<span class="gp">In [256]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">d</span><span class="p">)]</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code> are evaluated in Python, since <code class="docutils literal notranslate"><span class="pre">numexpr</span></code>
has no equivalent of this operation. However, <strong>only the</strong> <code class="docutils literal notranslate"><span class="pre">in</span></code>/<code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code>
<strong>expression itself</strong> is evaluated in vanilla Python. For example, in the
expression</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a in b + c + d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">(b</span> <span class="pre">+</span> <span class="pre">c</span> <span class="pre">+</span> <span class="pre">d)</span></code> is evaluated by <code class="docutils literal notranslate"><span class="pre">numexpr</span></code> and <em>then</em> the <code class="docutils literal notranslate"><span class="pre">in</span></code>
operation is evaluated in plain Python. In general, any operations that can
be evaluated using <code class="docutils literal notranslate"><span class="pre">numexpr</span></code> will be.</p>
</div>
</div>
<div class="section" id="special-use-of-the-operator-with-list-objects">
<h3>Special use of the <code class="docutils literal notranslate"><span class="pre">==</span></code> operator with <code class="docutils literal notranslate"><span class="pre">list</span></code> objects<a class="headerlink" href="#special-use-of-the-operator-with-list-objects" title="Permalink to this headline">¶</a></h3>
<p>Comparing a <code class="docutils literal notranslate"><span class="pre">list</span></code> of values to a column using <code class="docutils literal notranslate"><span class="pre">==</span></code>/<code class="docutils literal notranslate"><span class="pre">!=</span></code> works similarly
to <code class="docutils literal notranslate"><span class="pre">in</span></code>/<code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">in</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [257]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;b == [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]&#39;</span><span class="p">)</span>

<span class="go"># pure Python</span>
<span class="gp">In [258]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])]</span>

<span class="gp">In [259]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;c == [1, 2]&#39;</span><span class="p">)</span>

<span class="gp">In [260]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;c != [1, 2]&#39;</span><span class="p">)</span>

<span class="go"># using in/not in</span>
<span class="gp">In [261]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;[1, 2] in c&#39;</span><span class="p">)</span>

<span class="gp">In [262]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;[1, 2] not in c&#39;</span><span class="p">)</span>

<span class="go"># pure Python</span>
<span class="gp">In [263]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="section" id="boolean-operators">
<h3>Boolean Operators<a class="headerlink" href="#boolean-operators" title="Permalink to this headline">¶</a></h3>
<p>You can negate boolean expressions with the word <code class="docutils literal notranslate"><span class="pre">not</span></code> or the <code class="docutils literal notranslate"><span class="pre">~</span></code> operator.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [264]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [265]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bools&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.5</span>

<span class="gp">In [266]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;~bools&#39;</span><span class="p">)</span>

<span class="gp">In [267]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;not bools&#39;</span><span class="p">)</span>

<span class="gp">In [268]: </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;not bools&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">bools</span><span class="p">]</span>
</pre></div>
</div>
<p>Of course, expressions can be arbitrarily complex too:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># short query syntax</span>
<span class="gp">In [269]: </span><span class="n">shorter</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;a &lt; b &lt; c and (not bools) or bools &gt; 2&#39;</span><span class="p">)</span>

<span class="go"># equivalent in pure Python</span>
<span class="gp">In [270]: </span><span class="n">longer</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">bools</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bools</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)]</span>

<span class="gp">In [271]: </span><span class="n">shorter</span>

<span class="gp">In [272]: </span><span class="n">longer</span>

<span class="gp">In [273]: </span><span class="n">shorter</span> <span class="o">==</span> <span class="n">longer</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-of-query">
<h3>Performance of <a class="reference internal" href="../reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query" title="pandas.DataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a><a class="headerlink" href="#performance-of-query" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.query()</span></code> using <code class="docutils literal notranslate"><span class="pre">numexpr</span></code> is slightly faster than Python for
large frames.</p>
<img alt="../_images/query-perf.png" src="../_images/query-perf.png" />
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>You will only see the performance benefits of using the <code class="docutils literal notranslate"><span class="pre">numexpr</span></code> engine
with <code class="docutils literal notranslate"><span class="pre">DataFrame.query()</span></code> if your frame has more than approximately 200,000
rows.</p>
<blockquote>
<div><img alt="../_images/query-perf-small.png" src="../_images/query-perf-small.png" />
</div></blockquote>
</div>
<p>This plot was created using a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with 3 columns each containing
floating point values generated using <code class="docutils literal notranslate"><span class="pre">numpy.random.randn()</span></code>.</p>
</div>
</div>
<div class="section" id="duplicate-data">
<h2>Duplicate Data<a class="headerlink" href="#duplicate-data" title="Permalink to this headline">¶</a></h2>
<p id="indexing-duplicate">If you want to identify and remove duplicate rows in a DataFrame,  there are
two methods that will help: <code class="docutils literal notranslate"><span class="pre">duplicated</span></code> and <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>. Each
takes as an argument the columns to use to identify duplicated rows.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">duplicated</span></code> returns a boolean vector whose length is the number of rows, and which indicates whether a row is duplicated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code> removes duplicate rows.</p></li>
</ul>
<p>By default, the first observed row of a duplicate set is considered unique, but
each method has a <code class="docutils literal notranslate"><span class="pre">keep</span></code> parameter to specify targets to be kept.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keep='first'</span></code> (default): mark / drop duplicates except for the first occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep='last'</span></code>: mark / drop duplicates except for the last occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep=False</span></code>: mark  / drop all duplicates.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [276]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [277]: </span><span class="n">df2</span>

<span class="gp">In [278]: </span><span class="n">df2</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

<span class="gp">In [279]: </span><span class="n">df2</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>

<span class="gp">In [280]: </span><span class="n">df2</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [281]: </span><span class="n">df2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

<span class="gp">In [282]: </span><span class="n">df2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>

<span class="gp">In [283]: </span><span class="n">df2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, you can pass a list of columns to identify duplications.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [284]: </span><span class="n">df2</span><span class="o">.</span><span class="n">duplicated</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="gp">In [285]: </span><span class="n">df2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>To drop duplicates by index value, use <code class="docutils literal notranslate"><span class="pre">Index.duplicated</span></code> then perform slicing.
The same set of options are available for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> parameter.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [286]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">)},</span>
<span class="gp">   .....: </span>                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [287]: </span><span class="n">df3</span>

<span class="gp">In [288]: </span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>

<span class="gp">In [289]: </span><span class="n">df3</span><span class="p">[</span><span class="o">~</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>

<span class="gp">In [290]: </span><span class="n">df3</span><span class="p">[</span><span class="o">~</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)]</span>

<span class="gp">In [291]: </span><span class="n">df3</span><span class="p">[</span><span class="o">~</span><span class="n">df3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="section" id="dictionary-like-get-method">
<span id="indexing-dictionarylike"></span><h2>Dictionary-like <a class="reference internal" href="../reference/api/pandas.DataFrame.get.html#pandas.DataFrame.get" title="pandas.DataFrame.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a> method<a class="headerlink" href="#dictionary-like-get-method" title="Permalink to this headline">¶</a></h2>
<p>Each of Series or DataFrame have a <code class="docutils literal notranslate"><span class="pre">get</span></code> method which can return a
default value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [292]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="gp">In [293]: </span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>  <span class="c1"># equivalent to s[&#39;a&#39;]</span>

<span class="gp">In [294]: </span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-lookup-method">
<h2>The <a class="reference internal" href="../reference/api/pandas.DataFrame.lookup.html#pandas.DataFrame.lookup" title="pandas.DataFrame.lookup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lookup()</span></code></a> Method<a class="headerlink" href="#the-lookup-method" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you want to extract a set of values given a sequence of row labels
and column labels, and the <code class="docutils literal notranslate"><span class="pre">lookup</span></code> method allows for this and returns a
NumPy array.  For instance:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [295]: </span><span class="n">dflookup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>

<span class="gp">In [296]: </span><span class="n">dflookup</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="index-objects">
<span id="indexing-class"></span><h2>Index objects<a class="headerlink" href="#index-objects" title="Permalink to this headline">¶</a></h2>
<p>The pandas <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> class and its subclasses can be viewed as
implementing an <em>ordered multiset</em>. Duplicates are allowed. However, if you try
to convert an <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> object with duplicate entries into a
<code class="docutils literal notranslate"><span class="pre">set</span></code>, an exception will be raised.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> also provides the infrastructure necessary for
lookups, data alignment, and reindexing. The easiest way to create an
<code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> directly is to pass a <code class="docutils literal notranslate"><span class="pre">list</span></code> or other sequence to
<code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [297]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="gp">In [298]: </span><span class="n">index</span>

<span class="gp">In [299]: </span><span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">index</span>
</pre></div>
</div>
<p>You can also pass a <code class="docutils literal notranslate"><span class="pre">name</span></code> to be stored in the index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [300]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;something&#39;</span><span class="p">)</span>

<span class="gp">In [301]: </span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>The name, if set, will be shown in the console display:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [302]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>

<span class="gp">In [303]: </span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cols&#39;</span><span class="p">)</span>

<span class="gp">In [304]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="gp">In [305]: </span><span class="n">df</span>

<span class="gp">In [306]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="setting-metadata">
<span id="indexing-set-metadata"></span><h3>Setting metadata<a class="headerlink" href="#setting-metadata" title="Permalink to this headline">¶</a></h3>
<p>Indexes are “mostly immutable”, but it is possible to set and change their
metadata, like the index <code class="docutils literal notranslate"><span class="pre">name</span></code> (or, for <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, <code class="docutils literal notranslate"><span class="pre">levels</span></code> and
<code class="docutils literal notranslate"><span class="pre">codes</span></code>).</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">rename</span></code>, <code class="docutils literal notranslate"><span class="pre">set_names</span></code>, <code class="docutils literal notranslate"><span class="pre">set_levels</span></code>, and <code class="docutils literal notranslate"><span class="pre">set_codes</span></code>
to set these attributes directly. They default to returning a copy; however,
you can specify <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to have the data change in place.</p>
<p>See <a class="reference internal" href="advanced.html#advanced"><span class="std std-ref">Advanced Indexing</span></a> for usage of MultiIndexes.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [307]: </span><span class="n">ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [308]: </span><span class="n">ind</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;apple&quot;</span><span class="p">)</span>

<span class="gp">In [309]: </span><span class="n">ind</span>

<span class="gp">In [310]: </span><span class="n">ind</span><span class="o">.</span><span class="n">set_names</span><span class="p">([</span><span class="s2">&quot;apple&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [311]: </span><span class="n">ind</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;bob&quot;</span>

<span class="gp">In [312]: </span><span class="n">ind</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">set_names</span></code>, <code class="docutils literal notranslate"><span class="pre">set_levels</span></code>, and <code class="docutils literal notranslate"><span class="pre">set_codes</span></code> also take an optional
<code class="docutils literal notranslate"><span class="pre">level</span></code> argument</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [313]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>

<span class="gp">In [314]: </span><span class="n">index</span>

<span class="gp">In [315]: </span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [316]: </span><span class="n">index</span><span class="o">.</span><span class="n">set_levels</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="set-operations-on-index-objects">
<h3>Set operations on Index objects<a class="headerlink" href="#set-operations-on-index-objects" title="Permalink to this headline">¶</a></h3>
<p id="indexing-set-ops">The two main operations are <code class="docutils literal notranslate"><span class="pre">union</span> <span class="pre">(|)</span></code> and <code class="docutils literal notranslate"><span class="pre">intersection</span> <span class="pre">(&amp;)</span></code>.
These can be directly called as instance methods or used via overloaded
operators. Difference is provided via the <code class="docutils literal notranslate"><span class="pre">.difference()</span></code> method.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [317]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>

<span class="gp">In [318]: </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="gp">In [319]: </span><span class="n">a</span> <span class="o">|</span> <span class="n">b</span>

<span class="gp">In [320]: </span><span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span>

<span class="gp">In [321]: </span><span class="n">a</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>Also available is the <code class="docutils literal notranslate"><span class="pre">symmetric_difference</span> <span class="pre">(^)</span></code> operation, which returns elements
that appear in either <code class="docutils literal notranslate"><span class="pre">idx1</span></code> or <code class="docutils literal notranslate"><span class="pre">idx2</span></code>, but not in both. This is
equivalent to the Index created by <code class="docutils literal notranslate"><span class="pre">idx1.difference(idx2).union(idx2.difference(idx1))</span></code>,
with duplicates dropped.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [322]: </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="gp">In [323]: </span><span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="gp">In [324]: </span><span class="n">idx1</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>

<span class="gp">In [325]: </span><span class="n">idx1</span> <span class="o">^</span> <span class="n">idx2</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The resulting index from a set operation will be sorted in ascending order.</p>
</div>
</div>
<div class="section" id="missing-values">
<h3>Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h3>
<div class="alert alert-primary" id="indexing-missing">
<p class="admonition-title">Important</p>
<p>Even though <code class="docutils literal notranslate"><span class="pre">Index</span></code> can hold missing values (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>), it should be avoided
if you do not want any unexpected results. For example, some operations
exclude missing values implicitly.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Index.fillna</span></code> fills missing values with specified scalar value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [326]: </span><span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="gp">In [327]: </span><span class="n">idx1</span>

<span class="gp">In [328]: </span><span class="n">idx1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [329]: </span><span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2011-01-01&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                         <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span>
<span class="gp">   .....: </span>                         <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2011-01-03&#39;</span><span class="p">)])</span>
<span class="gp">   .....: </span>

<span class="gp">In [330]: </span><span class="n">idx2</span>

<span class="gp">In [331]: </span><span class="n">idx2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2011-01-02&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-reset-index">
<h2>Set / Reset Index<a class="headerlink" href="#set-reset-index" title="Permalink to this headline">¶</a></h2>
<p>Occasionally you will load or create a data set into a DataFrame and want to
add an index after you’ve already done so. There are a couple of different
ways.</p>
<div class="section" id="set-an-index">
<h3>Set an index<a class="headerlink" href="#set-an-index" title="Permalink to this headline">¶</a></h3>
<p id="indexing-set-index">DataFrame has a <a class="reference internal" href="../reference/api/pandas.DataFrame.set_index.html#pandas.DataFrame.set_index" title="pandas.DataFrame.set_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_index()</span></code></a> method which takes a column name
(for a regular <code class="docutils literal notranslate"><span class="pre">Index</span></code>) or a list of column names (for a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>).
To create a new, re-indexed DataFrame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [333]: </span><span class="n">data</span>

<span class="gp">In [334]: </span><span class="n">indexed1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">In [335]: </span><span class="n">indexed1</span>

<span class="gp">In [336]: </span><span class="n">indexed2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="gp">In [337]: </span><span class="n">indexed2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">append</span></code> keyword option allow you to keep the existing index and append
the given columns to a MultiIndex:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [338]: </span><span class="n">frame</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [339]: </span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [340]: </span><span class="n">frame</span>
</pre></div>
</div>
<p>Other options in <code class="docutils literal notranslate"><span class="pre">set_index</span></code> allow you not drop the index columns or to add
the index in-place (without creating a new object):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [341]: </span><span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [342]: </span><span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [343]: </span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="reset-the-index">
<h3>Reset the index<a class="headerlink" href="#reset-the-index" title="Permalink to this headline">¶</a></h3>
<p>As a convenience, there is a new function on DataFrame called
<a class="reference internal" href="../reference/api/pandas.DataFrame.reset_index.html#pandas.DataFrame.reset_index" title="pandas.DataFrame.reset_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_index()</span></code></a> which transfers the index values into the
DataFrame’s columns and sets a simple integer index.
This is the inverse operation of <a class="reference internal" href="../reference/api/pandas.DataFrame.set_index.html#pandas.DataFrame.set_index" title="pandas.DataFrame.set_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_index()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [344]: </span><span class="n">data</span>

<span class="gp">In [345]: </span><span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
<p>The output is more similar to a SQL table or a record array. The names for the
columns derived from the index are the ones stored in the <code class="docutils literal notranslate"><span class="pre">names</span></code> attribute.</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">level</span></code> keyword to remove only a portion of the index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [346]: </span><span class="n">frame</span>

<span class="gp">In [347]: </span><span class="n">frame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reset_index</span></code> takes an optional parameter <code class="docutils literal notranslate"><span class="pre">drop</span></code> which if true simply
discards the index, instead of putting index values in the DataFrame’s columns.</p>
</div>
<div class="section" id="adding-an-ad-hoc-index">
<h3>Adding an ad hoc index<a class="headerlink" href="#adding-an-ad-hoc-index" title="Permalink to this headline">¶</a></h3>
<p>If you create an index yourself, you can just assign it to the <code class="docutils literal notranslate"><span class="pre">index</span></code> field:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="returning-a-view-versus-a-copy">
<span id="indexing-view-versus-copy"></span><h2>Returning a view versus a copy<a class="headerlink" href="#returning-a-view-versus-a-copy" title="Permalink to this headline">¶</a></h2>
<p>When setting values in a pandas object, care must be taken to avoid what is called
<code class="docutils literal notranslate"><span class="pre">chained</span> <span class="pre">indexing</span></code>. Here is an example.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [348]: </span><span class="n">dfmi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                     <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;efgh&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                     <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ijkl&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                     <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;mnop&#39;</span><span class="p">)],</span>
<span class="gp">   .....: </span>                    <span class="n">columns</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                                                        <span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">]]))</span>
<span class="gp">   .....: </span>

<span class="gp">In [349]: </span><span class="n">dfmi</span>
</pre></div>
</div>
<p>Compare these two access methods:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [350]: </span><span class="n">dfmi</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">][</span><span class="s1">&#39;second&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [351]: </span><span class="n">dfmi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>These both yield the same results, so which should you use? It is instructive to understand the order
of operations on these and why method 2 (<code class="docutils literal notranslate"><span class="pre">.loc</span></code>) is much preferred over method 1 (chained <code class="docutils literal notranslate"><span class="pre">[]</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">dfmi['one']</span></code> selects the first level of the columns and returns a DataFrame that is singly-indexed.
Then another Python operation <code class="docutils literal notranslate"><span class="pre">dfmi_with_one['second']</span></code> selects the series indexed by <code class="docutils literal notranslate"><span class="pre">'second'</span></code>.
This is indicated by the variable <code class="docutils literal notranslate"><span class="pre">dfmi_with_one</span></code> because pandas sees these operations as separate events.
e.g. separate calls to <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, so it has to treat them as linear operations, they happen one after another.</p>
<p>Contrast this to <code class="docutils literal notranslate"><span class="pre">df.loc[:,('one','second')]</span></code> which passes a nested tuple of <code class="docutils literal notranslate"><span class="pre">(slice(None),('one','second'))</span></code> to a single call to
<code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>. This allows pandas to deal with this as a single entity. Furthermore this order of operations <em>can</em> be significantly
faster, and allows one to index <em>both</em> axes if so desired.</p>
<div class="section" id="why-does-assignment-fail-when-using-chained-indexing">
<h3>Why does assignment fail when using chained indexing?<a class="headerlink" href="#why-does-assignment-fail-when-using-chained-indexing" title="Permalink to this headline">¶</a></h3>
<p>The problem in the previous section is just a performance issue. What’s up with
the <code class="docutils literal notranslate"><span class="pre">SettingWithCopy</span></code> warning? We don’t <strong>usually</strong> throw warnings around when
you do something that might cost a few extra milliseconds!</p>
<p>But it turns out that assigning to the product of chained indexing has
inherently unpredictable results. To see this, think about how the Python
interpreter executes this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfmi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1"># becomes</span>
<span class="n">dfmi</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">)),</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>But this code is handled differently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfmi</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">][</span><span class="s1">&#39;second&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1"># becomes</span>
<span class="n">dfmi</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>See that <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> in there? Outside of simple cases, it’s very hard to
predict whether it will return a view or a copy (it depends on the memory layout
of the array, about which pandas makes no guarantees), and therefore whether
the <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code> will modify <code class="docutils literal notranslate"><span class="pre">dfmi</span></code> or a temporary object that gets thrown
out immediately afterward. <strong>That’s</strong> what <code class="docutils literal notranslate"><span class="pre">SettingWithCopy</span></code> is warning you
about!</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>You may be wondering whether we should be concerned about the <code class="docutils literal notranslate"><span class="pre">loc</span></code>
property in the first example. But <code class="docutils literal notranslate"><span class="pre">dfmi.loc</span></code> is guaranteed to be <code class="docutils literal notranslate"><span class="pre">dfmi</span></code>
itself with modified indexing behavior, so <code class="docutils literal notranslate"><span class="pre">dfmi.loc.__getitem__</span></code> /
<code class="docutils literal notranslate"><span class="pre">dfmi.loc.__setitem__</span></code> operate on <code class="docutils literal notranslate"><span class="pre">dfmi</span></code> directly. Of course,
<code class="docutils literal notranslate"><span class="pre">dfmi.loc.__getitem__(idx)</span></code> may be a view or a copy of <code class="docutils literal notranslate"><span class="pre">dfmi</span></code>.</p>
</div>
<p>Sometimes a <code class="docutils literal notranslate"><span class="pre">SettingWithCopy</span></code> warning will arise at times when there’s no
obvious chained indexing going on. <strong>These</strong> are the bugs that
<code class="docutils literal notranslate"><span class="pre">SettingWithCopy</span></code> is designed to catch! Pandas is probably trying to warn you
that you’ve done this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">foo</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">]]</span>  <span class="c1"># Is foo a view? A copy? Nobody knows!</span>
    <span class="c1"># ... many lines here ...</span>
    <span class="c1"># We don&#39;t know whether this will modify df or not!</span>
    <span class="n">foo</span><span class="p">[</span><span class="s1">&#39;quux&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">foo</span>
</pre></div>
</div>
<p>Yikes!</p>
</div>
<div class="section" id="evaluation-order-matters">
<span id="indexing-evaluation-order"></span><h3>Evaluation order matters<a class="headerlink" href="#evaluation-order-matters" title="Permalink to this headline">¶</a></h3>
<p>When you use chained indexing, the order and type of the indexing operation
partially determine whether the result is a slice into the original object, or
a copy of the slice.</p>
<p>Pandas has the <code class="docutils literal notranslate"><span class="pre">SettingWithCopyWarning</span></code> because assigning to a copy of a
slice is frequently not intentional, but a mistake caused by chained indexing
returning a copy where a slice was expected.</p>
<p>If you would like pandas to be more or less trusting about assignment to a
chained indexing expression, you can set the <a class="reference internal" href="options.html#options"><span class="std std-ref">option</span></a>
<code class="docutils literal notranslate"><span class="pre">mode.chained_assignment</span></code> to one of these values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'warn'</span></code>, the default, means a <code class="docutils literal notranslate"><span class="pre">SettingWithCopyWarning</span></code> is printed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'raise'</span></code> means pandas will raise a <code class="docutils literal notranslate"><span class="pre">SettingWithCopyException</span></code>
you have to deal with.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> will suppress the warnings entirely.</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [353]: </span><span class="n">dfb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                          <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="go"># This will show the SettingWithCopyWarning</span>
<span class="go"># but the frame values will be set</span>
<span class="gp">In [354]: </span><span class="n">dfb</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">][</span><span class="n">dfb</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;o&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
<p>This however is operating on a copy and will not work.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfb</span><span class="p">[</span><span class="n">dfb</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;o&#39;</span><span class="p">)][</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="go">Traceback (most recent call last)</span>
<span class="go">     ...</span>
<span class="go">SettingWithCopyWarning:</span>
<span class="go">     A value is trying to be set on a copy of a slice from a DataFrame.</span>
<span class="go">     Try using .loc[row_index,col_indexer] = value instead</span>
</pre></div>
</div>
<p>A chained assignment can also crop up in setting in a mixed dtype frame.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>These setting rules apply to all of <code class="docutils literal notranslate"><span class="pre">.loc/.iloc</span></code>.</p>
</div>
<p>This is the correct access method:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [355]: </span><span class="n">dfc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aaa&#39;</span><span class="p">,</span> <span class="s1">&#39;bbb&#39;</span><span class="p">,</span> <span class="s1">&#39;ccc&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>

<span class="gp">In [356]: </span><span class="n">dfc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span>

<span class="gp">In [357]: </span><span class="n">dfc</span>
</pre></div>
</div>
<p>This <em>can</em> work at times, but it is not guaranteed to, and therefore should be avoided:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [358]: </span><span class="n">dfc</span> <span class="o">=</span> <span class="n">dfc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [359]: </span><span class="n">dfc</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">111</span>

<span class="gp">In [360]: </span><span class="n">dfc</span>
</pre></div>
</div>
<p>This will <strong>not</strong> work at all, and so should be avoided:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1111</span>
<span class="go">Traceback (most recent call last)</span>
<span class="go">     ...</span>
<span class="go">SettingWithCopyException:</span>
<span class="go">     A value is trying to be set on a copy of a slice from a DataFrame.</span>
<span class="go">     Try using .loc[row_index,col_indexer] = value instead</span>
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>The chained assignment warnings / exceptions are aiming to inform the user of a possibly invalid
assignment. There may be false positives; situations where a chained assignment is inadvertently
reported.</p>
</div>
</div>
</div>
</div>


              </div>
          </main>

      </div>
    </div>

    
  </body>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2014, the pandas development team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>