

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>IO Tools (Text, CSV, HDF5, …) &#8212; pandas 0.25.3 documentation</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../_static/sphinx-bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/getting_started.css" />
    <link href="../_static/css/custom.css" rel="stylesheet">
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pandas.read_sql_table" href="../reference/api/pandas.read_sql_table.html" />
    <link rel="prev" title="User Guide" href="index.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">

<a class="navbar-brand" href="../index.html">
  <img src="../_static/pandas.svg" class="logo" alt="logo">
</a>

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
    </li>
    
    
    <li class="nav-item ">
        <a class="nav-link" href="../getting_started/index.html">Getting started</a>
    </li>
    
    <li class="nav-item active">
        <a class="nav-link" href="index.html">User Guide</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../reference/index.html">API Reference</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../development/index.html">Development</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../whatsnew/index.html">Release Notes</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../development/index.html">Development</a>
    </li>
    
  </ul>
  <ul class="navbar-nav ml-auto">
    <li class="nav-item">
      <a class="nav-link" href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener">
        <span><i class="fab fa-github-alt" style="color:#333;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="https://twitter.com/pandas_dev" target="_blank" rel="noopener">
        <span><i class="fab fa-twitter" style="color:#55acee;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
  </ul>
</div>
    </nav>

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
              

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
        
          
              <li class="active">
                  <a href="">IO Tools (Text, CSV, HDF5, …)</a>
              </li>
          
        
          
              <li class="">
                  <a href="indexing.html">Indexing and Selecting Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="advanced.html">MultiIndex / Advanced Indexing</a>
              </li>
          
        
          
              <li class="">
                  <a href="merging.html">Merge, join, and concatenate</a>
              </li>
          
        
          
              <li class="">
                  <a href="reshaping.html">Reshaping and Pivot Tables</a>
              </li>
          
        
          
              <li class="">
                  <a href="text.html">Working with Text Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="missing_data.html">Working with missing data</a>
              </li>
          
        
          
              <li class="">
                  <a href="categorical.html">Categorical Data</a>
              </li>
          
        
          
              <li class="">
                  <a href="integer_na.html">Nullable Integer Data Type</a>
              </li>
          
        
          
              <li class="">
                  <a href="visualization.html">Visualization</a>
              </li>
          
        
          
              <li class="">
                  <a href="computation.html">Computational tools</a>
              </li>
          
        
          
              <li class="">
                  <a href="groupby.html">Group By: split-apply-combine</a>
              </li>
          
        
          
              <li class="">
                  <a href="timeseries.html">Time Series / Date functionality</a>
              </li>
          
        
          
              <li class="">
                  <a href="timedeltas.html">Time Deltas</a>
              </li>
          
        
          
              <li class="">
                  <a href="options.html">Options and Settings</a>
              </li>
          
        
          
              <li class="">
                  <a href="enhancingperf.html">Enhancing Performance</a>
              </li>
          
        
          
              <li class="">
                  <a href="sparse.html">Sparse data structures</a>
              </li>
          
        
          
              <li class="">
                  <a href="gotchas.html">Frequently Asked Questions (FAQ)</a>
              </li>
          
        
          
              <li class="">
                  <a href="cookbook.html">Cookbook</a>
              </li>
          
        
      
      
      
      
      
      
      
      
      
      
    </ul>

</nav>


              
          </div>
          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#csv-text-files" class="nav-link">CSV & Text files</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#parsing-options" class="nav-link">Parsing options</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#basic" class="nav-link">Basic</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#column-and-index-locations-and-names" class="nav-link">Column and Index Locations and Names</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#general-parsing-configuration" class="nav-link">General Parsing Configuration</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#na-and-missing-data-handling" class="nav-link">NA and Missing Data Handling</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#datetime-handling" class="nav-link">Datetime Handling</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#iteration" class="nav-link">Iteration</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#quoting-compression-and-file-format" class="nav-link">Quoting, Compression, and File Format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#error-handling" class="nav-link">Error Handling</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#specifying-column-data-types" class="nav-link">Specifying column data types</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#specifying-categorical-dtype" class="nav-link">Specifying Categorical dtype</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#naming-and-using-columns" class="nav-link">Naming and Using Columns</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#handling-column-names" class="nav-link">Handling column names</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#duplicate-names-parsing" class="nav-link">Duplicate names parsing</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#filtering-columns-usecols" class="nav-link">Filtering columns (usecols)</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#comments-and-empty-lines" class="nav-link">Comments and Empty Lines</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#ignoring-line-comments-and-empty-lines" class="nav-link">Ignoring line comments and empty lines</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#comments" class="nav-link">Comments</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#dealing-with-unicode-data" class="nav-link">Dealing with Unicode Data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#index-columns-and-trailing-delimiters" class="nav-link">Index columns and trailing delimiters</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#date-handling" class="nav-link">Date Handling</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#specifying-date-columns" class="nav-link">Specifying Date Columns</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#date-parsing-functions" class="nav-link">Date Parsing Functions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#parsing-a-csv-with-mixed-timezones" class="nav-link">Parsing a CSV with mixed Timezones</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#inferring-datetime-format" class="nav-link">Inferring Datetime Format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#international-date-formats" class="nav-link">International Date Formats</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#specifying-method-for-floating-point-conversion" class="nav-link">Specifying method for floating-point conversion</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#thousand-separators" class="nav-link">Thousand Separators</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#na-values" class="nav-link">NA Values</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#infinity" class="nav-link">Infinity</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#returning-series" class="nav-link">Returning Series</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#boolean-values" class="nav-link">Boolean values</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#handling-bad-lines" class="nav-link">Handling “bad” lines</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#dialect" class="nav-link">Dialect</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#quoting-and-escape-characters" class="nav-link">Quoting and Escape Characters</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#files-with-fixed-width-columns" class="nav-link">Files with Fixed Width Columns</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#indexes" class="nav-link">Indexes</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#files-with-an-implicit-index-column" class="nav-link">Files with an “implicit” index column</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#reading-an-index-with-a-multiindex" class="nav-link">Reading an index with a MultiIndex</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#reading-columns-with-a-multiindex" class="nav-link">Reading columns with a MultiIndex</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#automatically-sniffing-the-delimiter" class="nav-link">Automatically “sniffing” the delimiter</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-multiple-files-to-create-a-single-dataframe" class="nav-link">Reading multiple files to create a single DataFrame</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#iterating-through-files-chunk-by-chunk" class="nav-link">Iterating through files chunk by chunk</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#specifying-the-parser-engine" class="nav-link">Specifying the parser engine</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-remote-files" class="nav-link">Reading remote files</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-out-data" class="nav-link">Writing out Data</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#writing-to-csv-format" class="nav-link">Writing to CSV format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#writing-a-formatted-string" class="nav-link">Writing a formatted string</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#json" class="nav-link">JSON</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-json" class="nav-link">Writing JSON</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#orient-options" class="nav-link">Orient Options</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#id1" class="nav-link">Date Handling</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#fallback-behavior" class="nav-link">Fallback Behavior</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-json" class="nav-link">Reading JSON</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#data-conversion" class="nav-link">Data Conversion</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#the-numpy-parameter" class="nav-link">The Numpy Parameter</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#normalization" class="nav-link">Normalization</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#line-delimited-json" class="nav-link">Line delimited json</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#table-schema" class="nav-link">Table Schema</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#html" class="nav-link">HTML</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-html-content" class="nav-link">Reading HTML Content</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-to-html-files" class="nav-link">Writing to HTML files</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#html-table-parsing-gotchas" class="nav-link">HTML Table Parsing Gotchas</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#excel-files" class="nav-link">Excel files</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-excel-files" class="nav-link">Reading Excel Files</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#excelfile-class" class="nav-link">ExcelFile class</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#specifying-sheets" class="nav-link">Specifying Sheets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#reading-a-multiindex" class="nav-link">Reading a MultiIndex</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#parsing-specific-columns" class="nav-link">Parsing Specific Columns</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#parsing-dates" class="nav-link">Parsing Dates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#cell-converters" class="nav-link">Cell Converters</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#dtype-specifications" class="nav-link">dtype Specifications</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-excel-files" class="nav-link">Writing Excel Files</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#writing-excel-files-to-disk" class="nav-link">Writing Excel Files to Disk</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#writing-excel-files-to-memory" class="nav-link">Writing Excel Files to Memory</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#excel-writer-engines" class="nav-link">Excel writer engines</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#style-and-formatting" class="nav-link">Style and Formatting</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#clipboard" class="nav-link">Clipboard</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#pickling" class="nav-link">Pickling</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#compressed-pickle-files" class="nav-link">Compressed pickle files</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#msgpack" class="nav-link">msgpack</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#read-write-api" class="nav-link">Read/Write API</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#hdf5-pytables" class="nav-link">HDF5 (PyTables)</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id3" class="nav-link">Read/Write API</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#fixed-format" class="nav-link">Fixed Format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#table-format" class="nav-link">Table Format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#hierarchical-keys" class="nav-link">Hierarchical Keys</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#storing-types" class="nav-link">Storing Types</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#storing-mixed-types-in-a-table" class="nav-link">Storing Mixed Types in a Table</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#storing-multiindex-dataframes" class="nav-link">Storing MultiIndex DataFrames</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#querying" class="nav-link">Querying</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#querying-a-table" class="nav-link">Querying a Table</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#using-timedelta64-ns" class="nav-link">Using timedelta64[ns]</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#indexing" class="nav-link">Indexing</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#query-via-data-columns" class="nav-link">Query via Data Columns</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#iterator" class="nav-link">Iterator</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#advanced-queries" class="nav-link">Advanced Queries</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h5">
            <a href="#select-a-single-column" class="nav-link">Select a Single Column</a>
        </li>
    
        <li class="nav-item toc-entry toc-h5">
            <a href="#selecting-coordinates" class="nav-link">Selecting coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h5">
            <a href="#selecting-using-a-where-mask" class="nav-link">Selecting using a where mask</a>
        </li>
    
        <li class="nav-item toc-entry toc-h5">
            <a href="#storer-object" class="nav-link">Storer Object</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#multiple-table-queries" class="nav-link">Multiple Table Queries</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#delete-from-a-table" class="nav-link">Delete from a Table</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#notes-caveats" class="nav-link">Notes & Caveats</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#compression" class="nav-link">Compression</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#ptrepack" class="nav-link">ptrepack</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#caveats" class="nav-link">Caveats</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#datatypes" class="nav-link">DataTypes</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#categorical-data" class="nav-link">Categorical Data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#string-columns" class="nav-link">String Columns</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#external-compatibility" class="nav-link">External Compatibility</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#performance" class="nav-link">Performance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#feather" class="nav-link">Feather</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#parquet" class="nav-link">Parquet</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#handling-indexes" class="nav-link">Handling Indexes</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#partitioning-parquet-files" class="nav-link">Partitioning Parquet files</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#sql-queries" class="nav-link">SQL Queries</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-dataframes" class="nav-link">Writing DataFrames</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#sql-data-types" class="nav-link">SQL data types</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#datetime-data-types" class="nav-link">Datetime data types</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#insertion-method" class="nav-link">Insertion Method</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-tables" class="nav-link">Reading Tables</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#schema-support" class="nav-link">Schema support</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#id4" class="nav-link">Querying</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#engine-connection-examples" class="nav-link">Engine connection examples</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#advanced-sqlalchemy-queries" class="nav-link">Advanced SQLAlchemy queries</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#sqlite-fallback" class="nav-link">Sqlite fallback</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#google-bigquery" class="nav-link">Google BigQuery</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#stata-format" class="nav-link">Stata Format</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#writing-to-stata-format" class="nav-link">Writing to Stata format</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#reading-from-stata-format" class="nav-link">Reading from Stata format</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#io-stata-categorical" class="nav-link">Categorical Data</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#sas-formats" class="nav-link">SAS Formats</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#other-file-formats" class="nav-link">Other file formats</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#netcdf" class="nav-link">netCDF</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#performance-considerations" class="nav-link">Performance Considerations</a>
        </li>
    
    </ul>
</nav>
              
            </div>

          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              <div>
                
  <div class="section" id="io-tools-text-csv-hdf5">
<span id="io"></span><h1>IO Tools (Text, CSV, HDF5, …)<a class="headerlink" href="#io-tools-text-csv-hdf5" title="Permalink to this headline">¶</a></h1>
<p>The pandas I/O API is a set of top level <code class="docutils literal notranslate"><span class="pre">reader</span></code> functions accessed like
<a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code></a> that generally return a pandas object. The corresponding
<code class="docutils literal notranslate"><span class="pre">writer</span></code> functions are object methods that are accessed like
<a class="reference internal" href="../reference/api/pandas.DataFrame.to_csv.html#pandas.DataFrame.to_csv" title="pandas.DataFrame.to_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.to_csv()</span></code></a>. Below is a table containing available <code class="docutils literal notranslate"><span class="pre">readers</span></code> and
<code class="docutils literal notranslate"><span class="pre">writers</span></code>.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 12%" />
<col style="width: 40%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Format Type</p></th>
<th class="head"><p>Data Description</p></th>
<th class="head"><p>Reader</p></th>
<th class="head"><p>Writer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>text</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a></p></td>
<td><p><a class="reference internal" href="#io-read-csv-table"><span class="std std-ref">read_csv</span></a></p></td>
<td><p><a class="reference internal" href="#io-store-in-csv"><span class="std std-ref">to_csv</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>text</p></td>
<td><p><a class="reference external" href="https://www.json.org/">JSON</a></p></td>
<td><p><a class="reference internal" href="#io-json-reader"><span class="std std-ref">read_json</span></a></p></td>
<td><p><a class="reference internal" href="#io-json-writer"><span class="std std-ref">to_json</span></a></p></td>
</tr>
<tr class="row-even"><td><p>text</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/HTML">HTML</a></p></td>
<td><p><a class="reference internal" href="#io-read-html"><span class="std std-ref">read_html</span></a></p></td>
<td><p><a class="reference internal" href="#io-html"><span class="std std-ref">to_html</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>text</p></td>
<td><p>Local clipboard</p></td>
<td><p><a class="reference internal" href="#io-clipboard"><span class="std std-ref">read_clipboard</span></a></p></td>
<td><p><a class="reference internal" href="#io-clipboard"><span class="std std-ref">to_clipboard</span></a></p></td>
</tr>
<tr class="row-even"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Microsoft_Excel">MS Excel</a></p></td>
<td><p><a class="reference internal" href="#io-excel-reader"><span class="std std-ref">read_excel</span></a></p></td>
<td><p><a class="reference internal" href="#io-excel-writer"><span class="std std-ref">to_excel</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://support.hdfgroup.org/HDF5/whatishdf5.html">HDF5 Format</a></p></td>
<td><p><a class="reference internal" href="#io-hdf5"><span class="std std-ref">read_hdf</span></a></p></td>
<td><p><a class="reference internal" href="#io-hdf5"><span class="std std-ref">to_hdf</span></a></p></td>
</tr>
<tr class="row-even"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://github.com/wesm/feather">Feather Format</a></p></td>
<td><p><a class="reference internal" href="#io-feather"><span class="std std-ref">read_feather</span></a></p></td>
<td><p><a class="reference internal" href="#io-feather"><span class="std std-ref">to_feather</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://parquet.apache.org/">Parquet Format</a></p></td>
<td><p><a class="reference internal" href="#io-parquet"><span class="std std-ref">read_parquet</span></a></p></td>
<td><p><a class="reference internal" href="#io-parquet"><span class="std std-ref">to_parquet</span></a></p></td>
</tr>
<tr class="row-even"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://msgpack.org/index.html">Msgpack</a></p></td>
<td><p><a class="reference internal" href="#io-msgpack"><span class="std std-ref">read_msgpack</span></a></p></td>
<td><p><a class="reference internal" href="#io-msgpack"><span class="std std-ref">to_msgpack</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Stata">Stata</a></p></td>
<td><p><a class="reference internal" href="#io-stata-reader"><span class="std std-ref">read_stata</span></a></p></td>
<td><p><a class="reference internal" href="#io-stata-writer"><span class="std std-ref">to_stata</span></a></p></td>
</tr>
<tr class="row-even"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/SAS_(software)">SAS</a></p></td>
<td><p><a class="reference internal" href="#io-sas-reader"><span class="std std-ref">read_sas</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>binary</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3/library/pickle.html">Python Pickle Format</a></p></td>
<td><p><a class="reference internal" href="#io-pickle"><span class="std std-ref">read_pickle</span></a></p></td>
<td><p><a class="reference internal" href="#io-pickle"><span class="std std-ref">to_pickle</span></a></p></td>
</tr>
<tr class="row-even"><td><p>SQL</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/SQL">SQL</a></p></td>
<td><p><a class="reference internal" href="#io-sql"><span class="std std-ref">read_sql</span></a></p></td>
<td><p><a class="reference internal" href="#io-sql"><span class="std std-ref">to_sql</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>SQL</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/BigQuery">Google Big Query</a></p></td>
<td><p><a class="reference internal" href="#io-bigquery"><span class="std std-ref">read_gbq</span></a></p></td>
<td><p><a class="reference internal" href="#io-bigquery"><span class="std std-ref">to_gbq</span></a></p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#io-perf"><span class="std std-ref">Here</span></a> is an informal performance comparison for some of these IO methods.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>For examples that use the <code class="docutils literal notranslate"><span class="pre">StringIO</span></code> class, make sure you import it
according to your Python version, i.e. <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">StringIO</span> <span class="pre">import</span> <span class="pre">StringIO</span></code> for
Python 2 and <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">io</span> <span class="pre">import</span> <span class="pre">StringIO</span></code> for Python 3.</p>
</div>
<div class="section" id="csv-text-files">
<span id="io-read-csv-table"></span><h2>CSV &amp; Text files<a class="headerlink" href="#csv-text-files" title="Permalink to this headline">¶</a></h2>
<p>The workhorse function for reading text files (a.k.a. flat files) is
<a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a>. See the <a class="reference internal" href="cookbook.html#cookbook-csv"><span class="std std-ref">cookbook</span></a> for some advanced strategies.</p>
<div class="section" id="parsing-options">
<h3>Parsing options<a class="headerlink" href="#parsing-options" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a> accepts the following common arguments:</p>
<div class="section" id="basic">
<h4>Basic<a class="headerlink" href="#basic" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>filepath_or_buffer<span class="classifier">various</span></dt><dd><p>Either a path to a file (a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>,
or <code class="xref py py-class docutils literal notranslate"><span class="pre">py._path.local.LocalPath</span></code>), URL (including http, ftp, and S3
locations), or any object with a <code class="docutils literal notranslate"><span class="pre">read()</span></code> method (such as an open file or
<a class="reference external" href="https://docs.python.org/3/library/io.html#io.StringIO" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">StringIO</span></code></a>).</p>
</dd>
<dt>sep<span class="classifier">str, defaults to <code class="docutils literal notranslate"><span class="pre">','</span></code> for <a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a>, <code class="docutils literal notranslate"><span class="pre">\t</span></code> for <a class="reference internal" href="../reference/api/pandas.read_table.html#pandas.read_table" title="pandas.read_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_table()</span></code></a></span></dt><dd><p>Delimiter to use. If sep is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the C engine cannot automatically detect
the separator, but the Python parsing engine can, meaning the latter will be
used and automatically detect the separator by Python’s builtin sniffer tool,
<a class="reference external" href="https://docs.python.org/3/library/csv.html#csv.Sniffer" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">csv.Sniffer</span></code></a>. In addition, separators longer than 1 character and
different from <code class="docutils literal notranslate"><span class="pre">'\s+'</span></code> will be interpreted as regular expressions and
will also force the use of the Python parsing engine. Note that regex
delimiters are prone to ignoring quoted data. Regex example: <code class="docutils literal notranslate"><span class="pre">'\\r\\t'</span></code>.</p>
</dd>
<dt>delimiter<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Alternative argument name for sep.</p>
</dd>
<dt>delim_whitespace<span class="classifier">boolean, default False</span></dt><dd><p>Specifies whether or not whitespace (e.g. <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'\t'</span></code>)
will be used as the delimiter. Equivalent to setting <code class="docutils literal notranslate"><span class="pre">sep='\s+'</span></code>.
If this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, nothing should be passed in for the
<code class="docutils literal notranslate"><span class="pre">delimiter</span></code> parameter.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1: </span>support for the Python parser.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="column-and-index-locations-and-names">
<h4>Column and Index Locations and Names<a class="headerlink" href="#column-and-index-locations-and-names" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>header<span class="classifier">int or list of ints, default <code class="docutils literal notranslate"><span class="pre">'infer'</span></code></span></dt><dd><p>Row number(s) to use as the column names, and the start of the
data. Default behavior is to infer the column names: if no names are
passed the behavior is identical to <code class="docutils literal notranslate"><span class="pre">header=0</span></code> and column names
are inferred from the first line of the file, if column names are
passed explicitly then the behavior is identical to
<code class="docutils literal notranslate"><span class="pre">header=None</span></code>. Explicitly pass <code class="docutils literal notranslate"><span class="pre">header=0</span></code> to be able to replace
existing names.</p>
<p>The header can be a list of ints that specify row locations
for a MultiIndex on the columns e.g. <code class="docutils literal notranslate"><span class="pre">[0,1,3]</span></code>. Intervening rows
that are not specified will be skipped (e.g. 2 in this example is
skipped). Note that this parameter ignores commented lines and empty
lines if <code class="docutils literal notranslate"><span class="pre">skip_blank_lines=True</span></code>, so header=0 denotes the first
line of data rather than the first line of the file.</p>
</dd>
<dt>names<span class="classifier">array-like, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>List of column names to use. If file contains no header row, then you should
explicitly pass <code class="docutils literal notranslate"><span class="pre">header=None</span></code>. Duplicates in this list will cause
a <code class="docutils literal notranslate"><span class="pre">UserWarning</span></code> to be issued.</p>
</dd>
<dt>index_col<span class="classifier">int, str, sequence of int / str, or False, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Column(s) to use as the row labels of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, either given as
string name or column index. If a sequence of int / str is given, a
MultiIndex is used.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">index_col=False</span></code> can be used to force pandas to <em>not</em> use the first
column as the index, e.g. when you have a malformed file with delimiters at
the end of each line.</p>
</dd>
<dt>usecols<span class="classifier">list-like or callable, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Return a subset of the columns. If list-like, all elements must either
be positional (i.e. integer indices into the document columns) or strings
that correspond to column names provided either by the user in <cite>names</cite> or
inferred from the document header row(s). For example, a valid list-like
<cite>usecols</cite> parameter would be <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code> or <code class="docutils literal notranslate"><span class="pre">['foo',</span> <span class="pre">'bar',</span> <span class="pre">'baz']</span></code>.</p>
<p>Element order is ignored, so <code class="docutils literal notranslate"><span class="pre">usecols=[0,</span> <span class="pre">1]</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0]</span></code>. To
instantiate a DataFrame from <code class="docutils literal notranslate"><span class="pre">data</span></code> with element order preserved use
<code class="docutils literal notranslate"><span class="pre">pd.read_csv(data,</span> <span class="pre">usecols=['foo',</span> <span class="pre">'bar'])[['foo',</span> <span class="pre">'bar']]</span></code> for columns
in <code class="docutils literal notranslate"><span class="pre">['foo',</span> <span class="pre">'bar']</span></code> order or
<code class="docutils literal notranslate"><span class="pre">pd.read_csv(data,</span> <span class="pre">usecols=['foo',</span> <span class="pre">'bar'])[['bar',</span> <span class="pre">'foo']]</span></code> for
<code class="docutils literal notranslate"><span class="pre">['bar',</span> <span class="pre">'foo']</span></code> order.</p>
<p>If callable, the callable function will be evaluated against the column names,
returning names where the callable function evaluates to True:</p>
<pre class="literal-block">In [1]: from pandas.compat import StringIO, BytesIO
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-1-e97c968580c4&gt; in &lt;module&gt;
----&gt; 1 from pandas.compat import StringIO, BytesIO

ImportError: cannot import name 'StringIO' from 'pandas.compat' (/home/travis/miniconda/lib/python3.7/site-packages/pandas/compat/__init__.py)

In [2]: data = ('col1,col2,col3\n'
   ...:         'a,b,1\n'
   ...:         'a,b,2\n'
   ...:         'c,d,3')
   ...: 

In [3]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-3-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [4]: pd.read_csv(StringIO(data), usecols=lambda x: x.upper() in ['COL1', 'COL3'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-4-db5e23c1aa4c&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=lambda x: x.upper() in ['COL1', 'COL3'])

NameError: name 'StringIO' is not defined</pre>
<p>Using this parameter results in much faster parsing time and lower memory usage.</p>
</dd>
<dt>squeeze<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>If the parsed data only contains one column then return a <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
</dd>
<dt>prefix<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Prefix to add to column numbers when no header, e.g. ‘X’ for X0, X1, …</p>
</dd>
<dt>mangle_dupe_cols<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>Duplicate columns will be specified as ‘X’, ‘X.1’…’X.N’, rather than ‘X’…’X’.
Passing in <code class="docutils literal notranslate"><span class="pre">False</span></code> will cause data to be overwritten if there are duplicate
names in the columns.</p>
</dd>
</dl>
</div>
<div class="section" id="general-parsing-configuration">
<h4>General Parsing Configuration<a class="headerlink" href="#general-parsing-configuration" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>dtype<span class="classifier">Type name or dict of column -&gt; type, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Data type for data or columns. E.g. <code class="docutils literal notranslate"><span class="pre">{'a':</span> <span class="pre">np.float64,</span> <span class="pre">'b':</span> <span class="pre">np.int32}</span></code>
(unsupported with <code class="docutils literal notranslate"><span class="pre">engine='python'</span></code>). Use <cite>str</cite> or <cite>object</cite> together
with suitable <code class="docutils literal notranslate"><span class="pre">na_values</span></code> settings to preserve and
not interpret dtype.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0: </span>support for the Python parser.</p>
</div>
</dd>
<dt>engine<span class="classifier">{<code class="docutils literal notranslate"><span class="pre">'c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'python'</span></code>}</span></dt><dd><p>Parser engine to use. The C engine is faster while the Python engine is
currently more feature-complete.</p>
</dd>
<dt>converters<span class="classifier">dict, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dict of functions for converting values in certain columns. Keys can either be
integers or column labels.</p>
</dd>
<dt>true_values<span class="classifier">list, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Values to consider as <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>false_values<span class="classifier">list, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Values to consider as <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>skipinitialspace<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>Skip spaces after delimiter.</p>
</dd>
<dt>skiprows<span class="classifier">list-like or integer, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Line numbers to skip (0-indexed) or number of lines to skip (int) at the start
of the file.</p>
<p>If callable, the callable function will be evaluated against the row
indices, returning True if the row should be skipped and False otherwise:</p>
<pre class="literal-block">In [5]: data = ('col1,col2,col3\n'
   ...:         'a,b,1\n'
   ...:         'a,b,2\n'
   ...:         'c,d,3')
   ...: 

In [6]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-6-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [7]: pd.read_csv(StringIO(data), skiprows=lambda x: x % 2 != 0)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-7-790d86ad71ce&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), skiprows=lambda x: x % 2 != 0)

NameError: name 'StringIO' is not defined</pre>
</dd>
<dt>skipfooter<span class="classifier">int, default <code class="docutils literal notranslate"><span class="pre">0</span></code></span></dt><dd><p>Number of lines at bottom of file to skip (unsupported with engine=’c’).</p>
</dd>
<dt>nrows<span class="classifier">int, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Number of rows of file to read. Useful for reading pieces of large files.</p>
</dd>
<dt>low_memory<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>Internally process the file in chunks, resulting in lower memory use
while parsing, but possibly mixed type inference.  To ensure no mixed
types either set <code class="docutils literal notranslate"><span class="pre">False</span></code>, or specify the type with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter.
Note that the entire file is read into a single <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> regardless,
use the <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> or <code class="docutils literal notranslate"><span class="pre">iterator</span></code> parameter to return the data in chunks.
(Only valid with C parser)</p>
</dd>
<dt>memory_map<span class="classifier">boolean, default False</span></dt><dd><p>If a filepath is provided for <code class="docutils literal notranslate"><span class="pre">filepath_or_buffer</span></code>, map the file object
directly onto memory and access the data directly from there. Using this
option can improve performance because there is no longer any I/O overhead.</p>
</dd>
</dl>
</div>
<div class="section" id="na-and-missing-data-handling">
<h4>NA and Missing Data Handling<a class="headerlink" href="#na-and-missing-data-handling" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>na_values<span class="classifier">scalar, str, list-like, or dict, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Additional strings to recognize as NA/NaN. If dict passed, specific per-column
NA values. See <a class="reference internal" href="#io-navaluesconst"><span class="std std-ref">na values const</span></a> below
for a list of the values interpreted as NaN by default.</p>
</dd>
<dt>keep_default_na<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>Whether or not to include the default NaN values when parsing the data.
Depending on whether <cite>na_values</cite> is passed in, the behavior is as follows:</p>
<ul class="simple">
<li><p>If <cite>keep_default_na</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and <cite>na_values</cite> are specified, <cite>na_values</cite>
is appended to the default NaN values used for parsing.</p></li>
<li><p>If <cite>keep_default_na</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and <cite>na_values</cite> are not specified, only
the default NaN values are used for parsing.</p></li>
<li><p>If <cite>keep_default_na</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, and <cite>na_values</cite> are specified, only
the NaN values specified <cite>na_values</cite> are used for parsing.</p></li>
<li><p>If <cite>keep_default_na</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, and <cite>na_values</cite> are not specified, no
strings will be parsed as NaN.</p></li>
</ul>
<p>Note that if <cite>na_filter</cite> is passed in as <code class="docutils literal notranslate"><span class="pre">False</span></code>, the <cite>keep_default_na</cite> and
<cite>na_values</cite> parameters will be ignored.</p>
</dd>
<dt>na_filter<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>Detect missing value markers (empty strings and the value of na_values). In
data without any NAs, passing <code class="docutils literal notranslate"><span class="pre">na_filter=False</span></code> can improve the performance
of reading a large file.</p>
</dd>
<dt>verbose<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>Indicate number of NA values placed in non-numeric columns.</p>
</dd>
<dt>skip_blank_lines<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, skip over blank lines rather than interpreting as NaN values.</p>
</dd>
</dl>
</div>
<div class="section" id="datetime-handling">
<h4>Datetime Handling<a class="headerlink" href="#datetime-handling" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>parse_dates<span class="classifier">boolean or list of ints or names or list of lists or dict, default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> -&gt; try parsing the index.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> -&gt;  try parsing columns 1, 2, 3 each as a separate date
column.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">3]]</span></code> -&gt; combine columns 1 and 3 and parse as a single date
column.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">{'foo':</span> <span class="pre">[1,</span> <span class="pre">3]}</span></code> -&gt; parse columns 1, 3 as date and call result ‘foo’.
A fast-path exists for iso8601-formatted dates.</p></li>
</ul>
</dd>
<dt>infer_datetime_format<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> and parse_dates is enabled for a column, attempt to infer the
datetime format to speed up the processing.</p>
</dd>
<dt>keep_date_col<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> and parse_dates specifies combining multiple columns then keep the
original columns.</p>
</dd>
<dt>date_parser<span class="classifier">function, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Function to use for converting a sequence of string columns to an array of
datetime instances. The default uses <code class="docutils literal notranslate"><span class="pre">dateutil.parser.parser</span></code> to do the
conversion. Pandas will try to call date_parser in three different ways,
advancing to the next if an exception occurs: 1) Pass one or more arrays (as
defined by parse_dates) as arguments; 2) concatenate (row-wise) the string
values from the columns defined by parse_dates into a single array and pass
that; and 3) call date_parser once for each row using one or more strings
(corresponding to the columns defined by parse_dates) as arguments.</p>
</dd>
<dt>dayfirst<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>DD/MM format dates, international and European format.</p>
</dd>
</dl>
</div>
<div class="section" id="iteration">
<h4>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>iterator<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>Return <cite>TextFileReader</cite> object for iteration or getting chunks with
<code class="docutils literal notranslate"><span class="pre">get_chunk()</span></code>.</p>
</dd>
<dt>chunksize<span class="classifier">int, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Return <cite>TextFileReader</cite> object for iteration. See <a class="reference internal" href="#io-chunking"><span class="std std-ref">iterating and chunking</span></a> below.</p>
</dd>
</dl>
</div>
<div class="section" id="quoting-compression-and-file-format">
<h4>Quoting, Compression, and File Format<a class="headerlink" href="#quoting-compression-and-file-format" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>compression<span class="classifier">{<code class="docutils literal notranslate"><span class="pre">'infer'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>}, default <code class="docutils literal notranslate"><span class="pre">'infer'</span></code></span></dt><dd><p>For on-the-fly decompression of on-disk data. If ‘infer’, then use gzip,
bz2, zip, or xz if filepath_or_buffer is a string ending in ‘.gz’, ‘.bz2’,
‘.zip’, or ‘.xz’, respectively, and no decompression otherwise. If using ‘zip’,
the ZIP file must contain only one data file to be read in.
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no decompression.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.1: </span>support for ‘zip’ and ‘xz’ compression.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.24.0: </span>‘infer’ option added and set to default.</p>
</div>
</dd>
<dt>thousands<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Thousands separator.</p>
</dd>
<dt>decimal<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">'.'</span></code></span></dt><dd><p>Character to recognize as decimal point. E.g. use <code class="docutils literal notranslate"><span class="pre">','</span></code> for European data.</p>
</dd>
<dt>float_precision<span class="classifier">string, default None</span></dt><dd><p>Specifies which converter the C engine should use for floating-point values.
The options are <code class="docutils literal notranslate"><span class="pre">None</span></code> for the ordinary converter, <code class="docutils literal notranslate"><span class="pre">high</span></code> for the
high-precision converter, and <code class="docutils literal notranslate"><span class="pre">round_trip</span></code> for the round-trip converter.</p>
</dd>
<dt>lineterminator<span class="classifier">str (length 1), default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Character to break file into lines. Only valid with C parser.</p>
</dd>
<dt>quotechar<span class="classifier">str (length 1)</span></dt><dd><p>The character used to denote the start and end of a quoted item. Quoted items
can include the delimiter and it will be ignored.</p>
</dd>
<dt>quoting<span class="classifier">int or <code class="docutils literal notranslate"><span class="pre">csv.QUOTE_*</span></code> instance, default <code class="docutils literal notranslate"><span class="pre">0</span></code></span></dt><dd><p>Control field quoting behavior per <code class="docutils literal notranslate"><span class="pre">csv.QUOTE_*</span></code> constants. Use one of
<code class="docutils literal notranslate"><span class="pre">QUOTE_MINIMAL</span></code> (0), <code class="docutils literal notranslate"><span class="pre">QUOTE_ALL</span></code> (1), <code class="docutils literal notranslate"><span class="pre">QUOTE_NONNUMERIC</span></code> (2) or
<code class="docutils literal notranslate"><span class="pre">QUOTE_NONE</span></code> (3).</p>
</dd>
<dt>doublequote<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">quotechar</span></code> is specified and <code class="docutils literal notranslate"><span class="pre">quoting</span></code> is not <code class="docutils literal notranslate"><span class="pre">QUOTE_NONE</span></code>,
indicate whether or not to interpret two consecutive <code class="docutils literal notranslate"><span class="pre">quotechar</span></code> elements
<strong>inside</strong> a field as a single <code class="docutils literal notranslate"><span class="pre">quotechar</span></code> element.</p>
</dd>
<dt>escapechar<span class="classifier">str (length 1), default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>One-character string used to escape delimiter when quoting is <code class="docutils literal notranslate"><span class="pre">QUOTE_NONE</span></code>.</p>
</dd>
<dt>comment<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Indicates remainder of line should not be parsed. If found at the beginning of
a line, the line will be ignored altogether. This parameter must be a single
character. Like empty lines (as long as <code class="docutils literal notranslate"><span class="pre">skip_blank_lines=True</span></code>), fully
commented lines are ignored by the parameter <cite>header</cite> but not by <cite>skiprows</cite>.
For example, if <code class="docutils literal notranslate"><span class="pre">comment='#'</span></code>, parsing ‘#empty\na,b,c\n1,2,3’ with
<cite>header=0</cite> will result in ‘a,b,c’ being treated as the header.</p>
</dd>
<dt>encoding<span class="classifier">str, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Encoding to use for UTF when reading/writing (e.g. <code class="docutils literal notranslate"><span class="pre">'utf-8'</span></code>). <a class="reference external" href="https://docs.python.org/3/library/codecs.html#standard-encodings">List of
Python standard encodings</a>.</p>
</dd>
<dt>dialect<span class="classifier">str or <a class="reference external" href="https://docs.python.org/3/library/csv.html#csv.Dialect" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">csv.Dialect</span></code></a> instance, default <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>If provided, this parameter will override values (default or not) for the
following parameters: <cite>delimiter</cite>, <cite>doublequote</cite>, <cite>escapechar</cite>,
<cite>skipinitialspace</cite>, <cite>quotechar</cite>, and <cite>quoting</cite>. If it is necessary to
override values, a ParserWarning will be issued. See <a class="reference external" href="https://docs.python.org/3/library/csv.html#csv.Dialect" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">csv.Dialect</span></code></a>
documentation for more details.</p>
</dd>
<dt>tupleize_cols<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><blockquote>
<div><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.21.0.</span></p>
</div>
<p>This argument will be removed and will always convert to MultiIndex</p>
</div></blockquote>
<p>Leave a list of tuples on columns as is (default is to convert to a MultiIndex
on the columns).</p>
</dd>
</dl>
</div>
<div class="section" id="error-handling">
<h4>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h4>
<dl>
<dt>error_bad_lines<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>Lines with too many fields (e.g. a csv line with too many commas) will by
default cause an exception to be raised, and no <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> will be
returned. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then these “bad lines” will dropped from the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> that is returned. See <a class="reference internal" href="#io-bad-lines"><span class="std std-ref">bad lines</span></a>
below.</p>
</dd>
<dt>warn_bad_lines<span class="classifier">boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code></span></dt><dd><p>If error_bad_lines is <code class="docutils literal notranslate"><span class="pre">False</span></code>, and warn_bad_lines is <code class="docutils literal notranslate"><span class="pre">True</span></code>, a warning for
each “bad line” will be output.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="specifying-column-data-types">
<span id="io-dtypes"></span><h3>Specifying column data types<a class="headerlink" href="#specifying-column-data-types" title="Permalink to this headline">¶</a></h3>
<p>You can indicate the data type for the whole <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or individual
columns:</p>
<pre class="literal-block">In [8]: data = ('a,b,c,d\n'
   ...:         '1,2,3,4\n'
   ...:         '5,6,7,8\n'
   ...:         '9,10,11')
   ...: 

In [9]: print(data)
a,b,c,d
1,2,3,4
5,6,7,8
9,10,11

In [10]: df = pd.read_csv(StringIO(data), dtype=object)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-10-bbbfae4dffce&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(data), dtype=object)

NameError: name 'StringIO' is not defined

In [11]: df
Out[11]: 
     A  B  C
0    1  1  a
1    2  1  a
2  NaN  3  b

In [12]: df['a'][0]
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-12-607a06f79ce4&gt; in &lt;module&gt;
----&gt; 1 df['a'][0]

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'

In [13]: df = pd.read_csv(StringIO(data),
   ....:                  dtype={'b': object, 'c': np.float64, 'd': 'Int64'})
   ....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-13-92bbec8d7f4d&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(data),
      2                  dtype={'b': object, 'c': np.float64, 'd': 'Int64'})

NameError: name 'StringIO' is not defined

In [14]: df.dtypes
Out[14]: 
A     Int64
B     int64
C    object
dtype: object</pre>
<p>Fortunately, pandas offers more than one way to ensure that your column(s)
contain only one <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. If you’re unfamiliar with these concepts, you can
see <a class="reference internal" href="../getting_started/basics.html#basics-dtypes"><span class="std std-ref">here</span></a> to learn more about dtypes, and
<a class="reference internal" href="../getting_started/basics.html#basics-object-conversion"><span class="std std-ref">here</span></a> to learn more about <code class="docutils literal notranslate"><span class="pre">object</span></code> conversion in
pandas.</p>
<p>For instance, you can use the <code class="docutils literal notranslate"><span class="pre">converters</span></code> argument
of <a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a>:</p>
<pre class="literal-block">In [15]: data = (&quot;col_1\n&quot;
   ....:         &quot;1\n&quot;
   ....:         &quot;2\n&quot;
   ....:         &quot;'A'\n&quot;
   ....:         &quot;4.22&quot;)
   ....: 

In [16]: df = pd.read_csv(StringIO(data), converters={'col_1': str})
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-16-7749c14f3246&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(data), converters={'col_1': str})

NameError: name 'StringIO' is not defined

In [17]: df
Out[17]: 
     A  B  C
0    1  1  a
1    2  1  a
2  NaN  3  b

In [18]: df['col_1'].apply(type).value_counts()
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-18-b2a42d4700e2&gt; in &lt;module&gt;
----&gt; 1 df['col_1'].apply(type).value_counts()

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'</pre>
<p>Or you can use the <a class="reference internal" href="../reference/api/pandas.to_numeric.html#pandas.to_numeric" title="pandas.to_numeric"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_numeric()</span></code></a> function to coerce the
dtypes after reading in the data,</p>
<pre class="literal-block">In [19]: df2 = pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-19-ea1f91a44591&gt; in &lt;module&gt;
----&gt; 1 df2 = pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [20]: df2['col_1'] = pd.to_numeric(df2['col_1'], errors='coerce')
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-20-2a4764c68415&gt; in &lt;module&gt;
----&gt; 1 df2['col_1'] = pd.to_numeric(df2['col_1'], errors='coerce')

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'

In [21]: df2
Out[21]: 
       a  b         c
0    one  x -1.067137
1    one  y  0.309500
2    two  x -0.211056
3    two  y -1.842023
4    two  x -0.390820
5  three  x -1.964475
6   four  x  1.298329

In [22]: df2['col_1'].apply(type).value_counts()
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-22-87f319d10e3e&gt; in &lt;module&gt;
----&gt; 1 df2['col_1'].apply(type).value_counts()

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col_1'</pre>
<p>which will convert all valid parsing to floats, leaving the invalid parsing
as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>Ultimately, how you deal with reading in columns containing mixed dtypes
depends on your specific needs. In the case above, if you wanted to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> out
the data anomalies, then <a class="reference internal" href="../reference/api/pandas.to_numeric.html#pandas.to_numeric" title="pandas.to_numeric"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_numeric()</span></code></a> is probably your best option.
However, if you wanted for all the data to be coerced, no matter the type, then
using the <code class="docutils literal notranslate"><span class="pre">converters</span></code> argument of <a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a> would certainly be
worth trying.</p>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0: </span>support for the Python parser.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> option is supported by the ‘python’ engine.</p>
</div>
</div></blockquote>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>In some cases, reading in abnormal data with columns containing mixed dtypes
will result in an inconsistent dataset. If you rely on pandas to infer the
dtypes of your columns, the parsing engine will go and infer the dtypes for
different chunks of the data, rather than the whole dataset at once. Consequently,
you can end up with column(s) with mixed dtypes. For example,</p>
<pre class="literal-block">In [23]: col_1 = list(range(500000)) + ['a', 'b'] + list(range(500000))

In [24]: df = pd.DataFrame({'col_1': col_1})

In [25]: df.to_csv('foo.csv')

In [26]: mixed_df = pd.read_csv('foo.csv')

In [27]: mixed_df['col_1'].apply(type).value_counts()
Out[27]: 
&lt;class 'int'&gt;    737858
&lt;class 'str'&gt;    262144
Name: col_1, dtype: int64

In [28]: mixed_df['col_1'].dtype
Out[28]: dtype('O')</pre>
<p>will result with <cite>mixed_df</cite> containing an <code class="docutils literal notranslate"><span class="pre">int</span></code> dtype for certain chunks
of the column, and <code class="docutils literal notranslate"><span class="pre">str</span></code> for others due to the mixed dtypes from the
data that was read in. It is important to note that the overall column will be
marked with a <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of <code class="docutils literal notranslate"><span class="pre">object</span></code>, which is used for columns with mixed dtypes.</p>
</div>
</div>
<div class="section" id="specifying-categorical-dtype">
<span id="io-categorical"></span><h3>Specifying Categorical dtype<a class="headerlink" href="#specifying-categorical-dtype" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Categorical</span></code> columns can be parsed directly by specifying <code class="docutils literal notranslate"><span class="pre">dtype='category'</span></code> or
<code class="docutils literal notranslate"><span class="pre">dtype=CategoricalDtype(categories,</span> <span class="pre">ordered)</span></code>.</p>
<pre class="literal-block">In [29]: data = ('col1,col2,col3\n'
   ....:         'a,b,1\n'
   ....:         'a,b,2\n'
   ....:         'c,d,3')
   ....: 

In [30]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-30-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [31]: pd.read_csv(StringIO(data)).dtypes
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-31-cd6cd4297c83&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data)).dtypes

NameError: name 'StringIO' is not defined

In [32]: pd.read_csv(StringIO(data), dtype='category').dtypes
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-32-0ffbe6392c83&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), dtype='category').dtypes

NameError: name 'StringIO' is not defined</pre>
<p>Individual columns can be parsed as a <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> using a dict
specification:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [33]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="s1">&#39;category&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">33</span><span class="o">-</span><span class="n">d5a0135225b6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="s1">&#39;category&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">dtypes</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.0.</span></p>
</div>
<p>Specifying <code class="docutils literal notranslate"><span class="pre">dtype='cateogry'</span></code> will result in an unordered <code class="docutils literal notranslate"><span class="pre">Categorical</span></code>
whose <code class="docutils literal notranslate"><span class="pre">categories</span></code> are the unique values observed in the data. For more
control on the categories and order, create a
<code class="xref py py-class docutils literal notranslate"><span class="pre">CategoricalDtype</span></code> ahead of time, and pass that for
that column’s <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="kn">from</span> <span class="nn">pandas.api.types</span> <span class="kn">import</span> <span class="n">CategoricalDtype</span>

<span class="gp">In [35]: </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">CategoricalDtype</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [36]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="n">dtype</span><span class="p">})</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">36</span><span class="o">-</span><span class="n">dacb1d0f3b29</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="n">dtype</span><span class="p">})</span><span class="o">.</span><span class="n">dtypes</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>When using <code class="docutils literal notranslate"><span class="pre">dtype=CategoricalDtype</span></code>, “unexpected” values outside of
<code class="docutils literal notranslate"><span class="pre">dtype.categories</span></code> are treated as missing values.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">CategoricalDtype</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>  <span class="c1"># No &#39;c&#39;</span>

<span class="gp">In [38]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="n">dtype</span><span class="p">})</span><span class="o">.</span><span class="n">col1</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">38</span><span class="o">-</span><span class="mi">32</span><span class="n">a3404741bf</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="n">dtype</span><span class="p">})</span><span class="o">.</span><span class="n">col1</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>This matches the behavior of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Categorical.set_categories()</span></code>.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>With <code class="docutils literal notranslate"><span class="pre">dtype='category'</span></code>, the resulting categories will always be parsed
as strings (object dtype). If the categories are numeric they can be
converted using the <a class="reference internal" href="../reference/api/pandas.to_numeric.html#pandas.to_numeric" title="pandas.to_numeric"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_numeric()</span></code></a> function, or as appropriate, another
converter such as <a class="reference internal" href="../reference/api/pandas.to_datetime.html#pandas.to_datetime" title="pandas.to_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_datetime()</span></code></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is a <code class="docutils literal notranslate"><span class="pre">CategoricalDtype</span></code> with homogeneous <code class="docutils literal notranslate"><span class="pre">categories</span></code> (
all numeric, all datetimes, etc.), the conversion is done automatically.</p>
<pre class="literal-block">In [39]: df = pd.read_csv(StringIO(data), dtype='category')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-39-60ceab231460&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(data), dtype='category')

NameError: name 'StringIO' is not defined

In [40]: df.dtypes
Out[40]: 
col_1    object
dtype: object

In [41]: df['col3']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-41-eda135eea498&gt; in &lt;module&gt;
----&gt; 1 df['col3']

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'

In [42]: df['col3'].cat.categories = pd.to_numeric(df['col3'].cat.categories)
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-42-e7d2be996c96&gt; in &lt;module&gt;
----&gt; 1 df['col3'].cat.categories = pd.to_numeric(df['col3'].cat.categories)

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'

In [43]: df['col3']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-43-eda135eea498&gt; in &lt;module&gt;
----&gt; 1 df['col3']

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'col3'</pre>
</div>
</div>
<div class="section" id="naming-and-using-columns">
<h3>Naming and Using Columns<a class="headerlink" href="#naming-and-using-columns" title="Permalink to this headline">¶</a></h3>
<div class="section" id="handling-column-names">
<span id="io-headers"></span><h4>Handling column names<a class="headerlink" href="#handling-column-names" title="Permalink to this headline">¶</a></h4>
<p>A file may or may not have a header row. pandas assumes the first row should be
used as the column names:</p>
<pre class="literal-block">In [44]: data = ('a,b,c\n'
   ....:         '1,2,3\n'
   ....:         '4,5,6\n'
   ....:         '7,8,9')
   ....: 

In [45]: print(data)
a,b,c
1,2,3
4,5,6
7,8,9

In [46]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-46-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined</pre>
<p>By specifying the <code class="docutils literal notranslate"><span class="pre">names</span></code> argument in conjunction with <code class="docutils literal notranslate"><span class="pre">header</span></code> you can
indicate other names to use and whether or not to throw away the header row (if
any):</p>
<pre class="literal-block">In [47]: print(data)
a,b,c
1,2,3
4,5,6
7,8,9

In [48]: pd.read_csv(StringIO(data), names=['foo', 'bar', 'baz'], header=0)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-48-2147df153168&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), names=['foo', 'bar', 'baz'], header=0)

NameError: name 'StringIO' is not defined

In [49]: pd.read_csv(StringIO(data), names=['foo', 'bar', 'baz'], header=None)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-49-4d8d7c94aa2c&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), names=['foo', 'bar', 'baz'], header=None)

NameError: name 'StringIO' is not defined</pre>
<p>If the header is in a row other than the first, pass the row number to
<code class="docutils literal notranslate"><span class="pre">header</span></code>. This will skip the preceding rows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;skip this skip it</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;1,2,3</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;4,5,6</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;7,8,9&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [51]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">51</span><span class="o">-</span><span class="n">d2f67f16f9b3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Default behavior is to infer the column names: if no names are
passed the behavior is identical to <code class="docutils literal notranslate"><span class="pre">header=0</span></code> and column names
are inferred from the first non-blank line of the file, if column
names are passed explicitly then the behavior is identical to
<code class="docutils literal notranslate"><span class="pre">header=None</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="duplicate-names-parsing">
<span id="io-dupe-names"></span><h3>Duplicate names parsing<a class="headerlink" href="#duplicate-names-parsing" title="Permalink to this headline">¶</a></h3>
<p>If the file or header contains duplicate names, pandas will by default
distinguish between them so as to prevent overwriting data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a,b,a</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;0,1,2</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;3,4,5&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [53]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">53</span><span class="o">-</span><span class="mi">6388</span><span class="n">c394e6b8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>There is no more duplicate data because <code class="docutils literal notranslate"><span class="pre">mangle_dupe_cols=True</span></code> by default,
which modifies a series of duplicate columns ‘X’, …, ‘X’ to become
‘X’, ‘X.1’, …, ‘X.N’.  If <code class="docutils literal notranslate"><span class="pre">mangle_dupe_cols=False</span></code>, duplicate data can
arise:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;a,b,a</span><span class="se">\n</span><span class="s1">0,1,2</span><span class="se">\n</span><span class="s1">3,4,5&#39;</span>
<span class="gp">In [3]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">mangle_dupe_cols</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">   a  b  a</span>
<span class="go">0  2  1  2</span>
<span class="go">1  5  4  5</span>
</pre></div>
</div>
<p>To prevent users from encountering this problem with duplicate data, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>
exception is raised if <code class="docutils literal notranslate"><span class="pre">mangle_dupe_cols</span> <span class="pre">!=</span> <span class="pre">True</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;a,b,a</span><span class="se">\n</span><span class="s1">0,1,2</span><span class="se">\n</span><span class="s1">3,4,5&#39;</span>
<span class="gp">In [3]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">mangle_dupe_cols</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">...</span>
<span class="go">ValueError: Setting mangle_dupe_cols=False is not supported yet</span>
</pre></div>
</div>
<div class="section" id="filtering-columns-usecols">
<span id="io-usecols"></span><h4>Filtering columns (<code class="docutils literal notranslate"><span class="pre">usecols</span></code>)<a class="headerlink" href="#filtering-columns-usecols" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">usecols</span></code> argument allows you to select any subset of the columns in a
file, either using the column names, position numbers or a callable:</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0: </span>support for callable <cite>usecols</cite> arguments</p>
</div>
<pre class="literal-block">In [54]: data = 'a,b,c,d\n1,2,3,foo\n4,5,6,bar\n7,8,9,baz'

In [55]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-55-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [56]: pd.read_csv(StringIO(data), usecols=['b', 'd'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-56-9323c31a5fae&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=['b', 'd'])

NameError: name 'StringIO' is not defined

In [57]: pd.read_csv(StringIO(data), usecols=[0, 2, 3])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-57-0092abd9aa50&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=[0, 2, 3])

NameError: name 'StringIO' is not defined

In [58]: pd.read_csv(StringIO(data), usecols=lambda x: x.upper() in ['A', 'C'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-58-ab30b8631d38&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=lambda x: x.upper() in ['A', 'C'])

NameError: name 'StringIO' is not defined</pre>
<p>The <code class="docutils literal notranslate"><span class="pre">usecols</span></code> argument can also be used to specify which columns not to
use in the final result:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [59]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">59</span><span class="o">-</span><span class="mi">88</span><span class="n">cd5a066934</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>In this case, the callable is specifying that we exclude the “a” and “c”
columns from the output.</p>
</div>
</div>
<div class="section" id="comments-and-empty-lines">
<h3>Comments and Empty Lines<a class="headerlink" href="#comments-and-empty-lines" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ignoring-line-comments-and-empty-lines">
<span id="io-skiplines"></span><h4>Ignoring line comments and empty lines<a class="headerlink" href="#ignoring-line-comments-and-empty-lines" title="Permalink to this headline">¶</a></h4>
<p>If the <code class="docutils literal notranslate"><span class="pre">comment</span></code> parameter is specified, then completely commented lines will
be ignored. By default, completely blank lines will be ignored as well.</p>
<pre class="literal-block">In [60]: data = ('\n'
   ....:         'a,b,c\n'
   ....:         '  \n'
   ....:         '# commented line\n'
   ....:         '1,2,3\n'
   ....:         '\n'
   ....:         '4,5,6')
   ....: 

In [61]: print(data)

a,b,c
  
# commented line
1,2,3

4,5,6

In [62]: pd.read_csv(StringIO(data), comment='#')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-62-d1502d08a8c8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), comment='#')

NameError: name 'StringIO' is not defined</pre>
<p>If <code class="docutils literal notranslate"><span class="pre">skip_blank_lines=False</span></code>, then <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> will not ignore blank lines:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [63]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;1,2,3</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;4,5,6&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [64]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="mi">261387</span><span class="n">fe229d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">skip_blank_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>The presence of ignored lines might create ambiguities involving line numbers;
the parameter <code class="docutils literal notranslate"><span class="pre">header</span></code> uses row numbers (ignoring commented/empty
lines), while <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> uses line numbers (including commented/empty lines):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [65]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;#comment</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;A,B,C</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;1,2,3&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [66]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">66</span><span class="o">-</span><span class="n">f63d94cef040</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined

<span class="gp">In [67]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A,B,C</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;#comment</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;1,2,3&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [68]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">68</span><span class="o">-</span><span class="n">c4753cb4e55a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>If both <code class="docutils literal notranslate"><span class="pre">header</span></code> and <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> are specified, <code class="docutils literal notranslate"><span class="pre">header</span></code> will be
relative to the end of <code class="docutils literal notranslate"><span class="pre">skiprows</span></code>. For example:</p>
</div>
<pre class="literal-block">In [69]: data = ('# empty\n'
   ....:         '# second empty line\n'
   ....:         '# third emptyline\n'
   ....:         'X,Y,Z\n'
   ....:         '1,2,3\n'
   ....:         'A,B,C\n'
   ....:         '1,2.,4.\n'
   ....:         '5.,NaN,10.0\n')
   ....: 

In [70]: print(data)
# empty
# second empty line
# third emptyline
X,Y,Z
1,2,3
A,B,C
1,2.,4.
5.,NaN,10.0


In [71]: pd.read_csv(StringIO(data), comment='#', skiprows=4, header=1)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-71-2ad3ec79b56f&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), comment='#', skiprows=4, header=1)

NameError: name 'StringIO' is not defined</pre>
</div>
<div class="section" id="comments">
<span id="io-comments"></span><h4>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h4>
<p>Sometimes comments or meta data may be included in a file:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [72]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">ID,level,category</span>
<span class="go">Patient1,123000,x # really unpleasant</span>
<span class="go">Patient2,23000,y # wouldn&#39;t take his medicine</span>
<span class="go">Patient3,1234018,z # awesome</span>
</pre></div>
</div>
<p>By default, the parser includes the comments in the output:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [73]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">)</span>

<span class="gp">In [74]: </span><span class="n">df</span>
<span class="gh">Out[74]: </span><span class="go"></span>
<span class="go">         ID    level                        category</span>
<span class="go">0  Patient1   123000           x # really unpleasant</span>
<span class="go">1  Patient2    23000  y # wouldn&#39;t take his medicine</span>
<span class="go">2  Patient3  1234018                     z # awesome</span>
</pre></div>
</div>
<p>We can suppress the comments using the <code class="docutils literal notranslate"><span class="pre">comment</span></code> keyword:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [75]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="gp">In [76]: </span><span class="n">df</span>
<span class="gh">Out[76]: </span><span class="go"></span>
<span class="go">         ID    level category</span>
<span class="go">0  Patient1   123000       x </span>
<span class="go">1  Patient2    23000       y </span>
<span class="go">2  Patient3  1234018       z </span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dealing-with-unicode-data">
<span id="io-unicode"></span><h3>Dealing with Unicode Data<a class="headerlink" href="#dealing-with-unicode-data" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">encoding</span></code> argument should be used for encoded unicode data, which will
result in byte strings being decoded to unicode in the result:</p>
<pre class="literal-block">In [77]: data = (b'word,length\n'
   ....:         b'Tr\xc3\xa4umen,7\n'
   ....:         b'Gr\xc3\xbc\xc3\x9fe,5')
   ....: 

In [78]: data = data.decode('utf8').encode('latin-1')

In [79]: df = pd.read_csv(BytesIO(data), encoding='latin-1')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-79-e612e15dfde2&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(BytesIO(data), encoding='latin-1')

NameError: name 'BytesIO' is not defined

In [80]: df
Out[80]: 
         ID    level category
0  Patient1   123000       x 
1  Patient2    23000       y 
2  Patient3  1234018       z 

In [81]: df['word'][1]
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'word'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-81-c6e6b696c1e3&gt; in &lt;module&gt;
----&gt; 1 df['word'][1]

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'word'</pre>
<p>Some formats which encode all characters as multiple bytes, like UTF-16, won’t
parse correctly at all without specifying the encoding. <a class="reference external" href="https://docs.python.org/3/library/codecs.html#standard-encodings">Full list of Python
standard encodings</a>.</p>
</div>
<div class="section" id="index-columns-and-trailing-delimiters">
<span id="io-index-col"></span><h3>Index columns and trailing delimiters<a class="headerlink" href="#index-columns-and-trailing-delimiters" title="Permalink to this headline">¶</a></h3>
<p>If a file has one more column of data than the number of column names, the
first column will be used as the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>’s row names:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [82]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;4,apple,bat,5.7</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;8,orange,cow,10&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [83]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">83</span><span class="o">-</span><span class="mi">6388</span><span class="n">c394e6b8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [84]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;index,a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;4,apple,bat,5.7</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;8,orange,cow,10&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [85]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">85</span><span class="o">-</span><span class="mi">64749427</span><span class="n">ea81</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>Ordinarily, you can achieve this behavior using the <code class="docutils literal notranslate"><span class="pre">index_col</span></code> option.</p>
<p>There are some exception cases when a file has been prepared with delimiters at
the end of each data line, confusing the parser. To explicitly disable the
index column inference and discard the last column, pass <code class="docutils literal notranslate"><span class="pre">index_col=False</span></code>:</p>
<pre class="literal-block">In [86]: data = ('a,b,c\n'
   ....:         '4,apple,bat,\n'
   ....:         '8,orange,cow,')
   ....: 

In [87]: print(data)
a,b,c
4,apple,bat,
8,orange,cow,

In [88]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-88-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [89]: pd.read_csv(StringIO(data), index_col=False)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-89-11f1c5260390&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), index_col=False)

NameError: name 'StringIO' is not defined</pre>
<p>If a subset of data is being parsed using the <code class="docutils literal notranslate"><span class="pre">usecols</span></code> option, the
<code class="docutils literal notranslate"><span class="pre">index_col</span></code> specification is based on that subset, not the original data.</p>
<pre class="literal-block">In [90]: data = ('a,b,c\n'
   ....:         '4,apple,bat,\n'
   ....:         '8,orange,cow,')
   ....: 

In [91]: print(data)
a,b,c
4,apple,bat,
8,orange,cow,

In [92]: pd.read_csv(StringIO(data), usecols=['b', 'c'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-92-0342dcc15acb&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=['b', 'c'])

NameError: name 'StringIO' is not defined

In [93]: pd.read_csv(StringIO(data), usecols=['b', 'c'], index_col=0)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-93-bd0dea172826&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), usecols=['b', 'c'], index_col=0)

NameError: name 'StringIO' is not defined</pre>
</div>
<div class="section" id="date-handling">
<span id="io-parse-dates"></span><h3>Date Handling<a class="headerlink" href="#date-handling" title="Permalink to this headline">¶</a></h3>
<div class="section" id="specifying-date-columns">
<h4>Specifying Date Columns<a class="headerlink" href="#specifying-date-columns" title="Permalink to this headline">¶</a></h4>
<p>To better facilitate working with datetime data, <a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a>
uses the keyword arguments <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> and <code class="docutils literal notranslate"><span class="pre">date_parser</span></code>
to allow users to specify a variety of columns and date/time formats to turn the
input text data into <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects.</p>
<p>The simplest case is to just pass in <code class="docutils literal notranslate"><span class="pre">parse_dates=True</span></code>:</p>
<pre class="literal-block"># Use a column as an index, and parse it as dates.
In [94]: df = pd.read_csv('foo.csv', index_col=0, parse_dates=True)

In [95]: df
Out[95]: 
            A  B  C
date               
2009-01-01  a  1  2
2009-01-02  b  3  4
2009-01-03  c  4  5

# These are Python datetime objects
In [96]: df.index
Out[96]: DatetimeIndex(['2009-01-01', '2009-01-02', '2009-01-03'], dtype='datetime64[ns]', name='date', freq=None)</pre>
<p>It is often the case that we may want to store date and time data separately,
or store various date fields separately. the <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> keyword can be
used to specify a combination of columns to parse the dates and/or times from.</p>
<p>You can specify a list of column lists to <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code>, the resulting date
columns will be prepended to the output (so as to not affect the existing column
order) and the new column names will be the concatenation of the component
column names:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [97]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">KORD,19990127, 19:00:00, 18:56:00, 0.8100</span>
<span class="go">KORD,19990127, 20:00:00, 19:56:00, 0.0100</span>
<span class="go">KORD,19990127, 21:00:00, 20:56:00, -0.5900</span>
<span class="go">KORD,19990127, 21:00:00, 21:18:00, -0.9900</span>
<span class="go">KORD,19990127, 22:00:00, 21:56:00, -0.5900</span>
<span class="go">KORD,19990127, 23:00:00, 22:56:00, -0.5900</span>

<span class="gp">In [98]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>

<span class="gp">In [99]: </span><span class="n">df</span>
<span class="gh">Out[99]: </span><span class="go"></span>
<span class="go">                  1_2                 1_3     0     4</span>
<span class="go">0 1999-01-27 19:00:00 1999-01-27 18:56:00  KORD  0.81</span>
<span class="go">1 1999-01-27 20:00:00 1999-01-27 19:56:00  KORD  0.01</span>
<span class="go">2 1999-01-27 21:00:00 1999-01-27 20:56:00  KORD -0.59</span>
<span class="go">3 1999-01-27 21:00:00 1999-01-27 21:18:00  KORD -0.99</span>
<span class="go">4 1999-01-27 22:00:00 1999-01-27 21:56:00  KORD -0.59</span>
<span class="go">5 1999-01-27 23:00:00 1999-01-27 22:56:00  KORD -0.59</span>
</pre></div>
</div>
<p>By default the parser removes the component date columns, but you can choose
to retain them via the <code class="docutils literal notranslate"><span class="pre">keep_date_col</span></code> keyword:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [100]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>
<span class="gp">   .....: </span>                 <span class="n">keep_date_col</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [101]: </span><span class="n">df</span>
<span class="gh">Out[101]: </span><span class="go"></span>
<span class="go">                  1_2                 1_3     0  ...          2          3     4</span>
<span class="go">0 1999-01-27 19:00:00 1999-01-27 18:56:00  KORD  ...   19:00:00   18:56:00  0.81</span>
<span class="go">1 1999-01-27 20:00:00 1999-01-27 19:56:00  KORD  ...   20:00:00   19:56:00  0.01</span>
<span class="go">2 1999-01-27 21:00:00 1999-01-27 20:56:00  KORD  ...   21:00:00   20:56:00 -0.59</span>
<span class="go">3 1999-01-27 21:00:00 1999-01-27 21:18:00  KORD  ...   21:00:00   21:18:00 -0.99</span>
<span class="go">4 1999-01-27 22:00:00 1999-01-27 21:56:00  KORD  ...   22:00:00   21:56:00 -0.59</span>
<span class="go">5 1999-01-27 23:00:00 1999-01-27 22:56:00  KORD  ...   23:00:00   22:56:00 -0.59</span>

<span class="go">[6 rows x 7 columns]</span>
</pre></div>
</div>
<p>Note that if you wish to combine multiple columns into a single date column, a
nested list must be used. In other words, <code class="docutils literal notranslate"><span class="pre">parse_dates=[1,</span> <span class="pre">2]</span></code> indicates that
the second and third columns should each be parsed as separate date columns
while <code class="docutils literal notranslate"><span class="pre">parse_dates=[[1,</span> <span class="pre">2]]</span></code> means the two columns should be parsed into a
single column.</p>
<p>You can also use a dict to specify custom name columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [102]: </span><span class="n">date_spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nominal&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;actual&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>

<span class="gp">In [103]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_spec</span><span class="p">)</span>

<span class="gp">In [104]: </span><span class="n">df</span>
<span class="gh">Out[104]: </span><span class="go"></span>
<span class="go">              nominal              actual     0     4</span>
<span class="go">0 1999-01-27 19:00:00 1999-01-27 18:56:00  KORD  0.81</span>
<span class="go">1 1999-01-27 20:00:00 1999-01-27 19:56:00  KORD  0.01</span>
<span class="go">2 1999-01-27 21:00:00 1999-01-27 20:56:00  KORD -0.59</span>
<span class="go">3 1999-01-27 21:00:00 1999-01-27 21:18:00  KORD -0.99</span>
<span class="go">4 1999-01-27 22:00:00 1999-01-27 21:56:00  KORD -0.59</span>
<span class="go">5 1999-01-27 23:00:00 1999-01-27 22:56:00  KORD -0.59</span>
</pre></div>
</div>
<p>It is important to remember that if multiple text columns are to be parsed into
a single date column, then a new column is prepended to the data. The <cite>index_col</cite>
specification is based off of this new set of columns rather than the original
data columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [105]: </span><span class="n">date_spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nominal&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;actual&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>

<span class="gp">In [106]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_spec</span><span class="p">,</span>
<span class="gp">   .....: </span>                 <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># index is the nominal column</span>
<span class="gp">   .....: </span>

<span class="gp">In [107]: </span><span class="n">df</span>
<span class="gh">Out[107]: </span><span class="go"></span>
<span class="go">                                 actual     0     4</span>
<span class="go">nominal                                            </span>
<span class="go">1999-01-27 19:00:00 1999-01-27 18:56:00  KORD  0.81</span>
<span class="go">1999-01-27 20:00:00 1999-01-27 19:56:00  KORD  0.01</span>
<span class="go">1999-01-27 21:00:00 1999-01-27 20:56:00  KORD -0.59</span>
<span class="go">1999-01-27 21:00:00 1999-01-27 21:18:00  KORD -0.99</span>
<span class="go">1999-01-27 22:00:00 1999-01-27 21:56:00  KORD -0.59</span>
<span class="go">1999-01-27 23:00:00 1999-01-27 22:56:00  KORD -0.59</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>If a column or index contains an unparsable date, the entire column or
index will be returned unaltered as an object data type. For non-standard
datetime parsing, use <a class="reference internal" href="../reference/api/pandas.to_datetime.html#pandas.to_datetime" title="pandas.to_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_datetime()</span></code></a> after <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>.</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>read_csv has a fast_path for parsing datetime strings in iso8601 format,
e.g “2000-01-01T00:01:02+00:00” and similar variations. If you can arrange
for your data to store datetimes in this format, load times will be
significantly faster, ~20x has been observed.</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>When passing a dict as the <cite>parse_dates</cite> argument, the order of
the columns prepended is not guaranteed, because <cite>dict</cite> objects do not impose
an ordering on their keys. On Python 2.7+ you may use <cite>collections.OrderedDict</cite>
instead of a regular <cite>dict</cite> if this matters to you. Because of this, when using a
dict for ‘parse_dates’ in conjunction with the <cite>index_col</cite> argument, it’s best to
specify <cite>index_col</cite> as a column label rather then as an index on the resulting frame.</p>
</div>
</div>
<div class="section" id="date-parsing-functions">
<h4>Date Parsing Functions<a class="headerlink" href="#date-parsing-functions" title="Permalink to this headline">¶</a></h4>
<p>Finally, the parser allows you to specify a custom <code class="docutils literal notranslate"><span class="pre">date_parser</span></code> function to
take full advantage of the flexibility of the date parsing API:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [108]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_spec</span><span class="p">,</span>
<span class="gp">   .....: </span>                 <span class="n">date_parser</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">date_converters</span><span class="o">.</span><span class="n">parse_date_time</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [109]: </span><span class="n">df</span>
<span class="gh">Out[109]: </span><span class="go"></span>
<span class="go">              nominal              actual     0     4</span>
<span class="go">0 1999-01-27 19:00:00 1999-01-27 18:56:00  KORD  0.81</span>
<span class="go">1 1999-01-27 20:00:00 1999-01-27 19:56:00  KORD  0.01</span>
<span class="go">2 1999-01-27 21:00:00 1999-01-27 20:56:00  KORD -0.59</span>
<span class="go">3 1999-01-27 21:00:00 1999-01-27 21:18:00  KORD -0.99</span>
<span class="go">4 1999-01-27 22:00:00 1999-01-27 21:56:00  KORD -0.59</span>
<span class="go">5 1999-01-27 23:00:00 1999-01-27 22:56:00  KORD -0.59</span>
</pre></div>
</div>
<p>Pandas will try to call the <code class="docutils literal notranslate"><span class="pre">date_parser</span></code> function in three different ways. If
an exception is raised, the next one is tried:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">date_parser</span></code> is first called with one or more arrays as arguments,
as defined using <cite>parse_dates</cite> (e.g., <code class="docutils literal notranslate"><span class="pre">date_parser(['2013',</span> <span class="pre">'2013'],</span> <span class="pre">['1',</span> <span class="pre">'2'])</span></code>).</p></li>
<li><p>If #1 fails, <code class="docutils literal notranslate"><span class="pre">date_parser</span></code> is called with all the columns
concatenated row-wise into a single array (e.g., <code class="docutils literal notranslate"><span class="pre">date_parser(['2013</span> <span class="pre">1',</span> <span class="pre">'2013</span> <span class="pre">2'])</span></code>).</p></li>
<li><p>If #2 fails, <code class="docutils literal notranslate"><span class="pre">date_parser</span></code> is called once for every row with one or more
string arguments from the columns indicated with <cite>parse_dates</cite>
(e.g., <code class="docutils literal notranslate"><span class="pre">date_parser('2013',</span> <span class="pre">'1')</span></code> for the first row, <code class="docutils literal notranslate"><span class="pre">date_parser('2013',</span> <span class="pre">'2')</span></code>
for the second, etc.).</p></li>
</ol>
<p>Note that performance-wise, you should try these methods of parsing dates in order:</p>
<ol class="arabic simple">
<li><p>Try to infer the format using <code class="docutils literal notranslate"><span class="pre">infer_datetime_format=True</span></code> (see section below).</p></li>
<li><p>If you know the format, use <code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code>:
<code class="docutils literal notranslate"><span class="pre">date_parser=lambda</span> <span class="pre">x:</span> <span class="pre">pd.to_datetime(x,</span> <span class="pre">format=...)</span></code>.</p></li>
<li><p>If you have a really non-standard format, use a custom <code class="docutils literal notranslate"><span class="pre">date_parser</span></code> function.
For optimal performance, this should be vectorized, i.e., it should accept arrays
as arguments.</p></li>
</ol>
<p>You can explore the date parsing functionality in
<a class="reference external" href="https://github.com/pandas-dev/pandas/blob/master/pandas/io/date_converters.py">date_converters.py</a>
and add your own. We would love to turn this module into a community supported
set of date/time parsers. To get you started, <code class="docutils literal notranslate"><span class="pre">date_converters.py</span></code> contains
functions to parse dual date and time columns, year/month/day columns,
and year/month/day/hour/minute/second columns. It also contains a
<code class="docutils literal notranslate"><span class="pre">generic_parser</span></code> function so you can curry it with a function that deals with
a single date rather than the entire array.</p>
</div>
<div class="section" id="parsing-a-csv-with-mixed-timezones">
<span id="io-csv-mixed-timezones"></span><h4>Parsing a CSV with mixed Timezones<a class="headerlink" href="#parsing-a-csv-with-mixed-timezones" title="Permalink to this headline">¶</a></h4>
<p>Pandas cannot natively represent a column or index with mixed timezones. If your CSV
file contains columns with a mixture of timezones, the default result will be
an object-dtype column with strings, even with <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code>.</p>
<pre class="literal-block">In [110]: content = &quot;&quot;&quot;\
   .....: a
   .....: 2000-01-01T00:00:00+05:00
   .....: 2000-01-01T00:00:00+06:00&quot;&quot;&quot;
   .....: 

In [111]: df = pd.read_csv(StringIO(content), parse_dates=['a'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-111-131f2f1dff55&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(content), parse_dates=['a'])

NameError: name 'StringIO' is not defined

In [112]: df['a']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-112-0030cc624053&gt; in &lt;module&gt;
----&gt; 1 df['a']

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'</pre>
<p>To parse the mixed-timezone values as a datetime column, pass a partially-applied
<a class="reference internal" href="../reference/api/pandas.to_datetime.html#pandas.to_datetime" title="pandas.to_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_datetime()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">utc=True</span></code> as the <code class="docutils literal notranslate"><span class="pre">date_parser</span></code>.</p>
<pre class="literal-block">In [113]: df = pd.read_csv(StringIO(content), parse_dates=['a'],
   .....:                  date_parser=lambda col: pd.to_datetime(col, utc=True))
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-113-4166c8c71a81&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_csv(StringIO(content), parse_dates=['a'],
      2                  date_parser=lambda col: pd.to_datetime(col, utc=True))

NameError: name 'StringIO' is not defined

In [114]: df['a']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2896             try:
-&gt; 2897                 return self._engine.get_loc(key)
   2898             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-114-0030cc624053&gt; in &lt;module&gt;
----&gt; 1 df['a']

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2993             if self.columns.nlevels &gt; 1:
   2994                 return self._getitem_multilevel(key)
-&gt; 2995             indexer = self.columns.get_loc(key)
   2996             if is_integer(indexer):
   2997                 indexer = [indexer]

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2897                 return self._engine.get_loc(key)
   2898             except KeyError:
-&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: 'a'</pre>
</div>
<div class="section" id="inferring-datetime-format">
<span id="io-dayfirst"></span><h4>Inferring Datetime Format<a class="headerlink" href="#inferring-datetime-format" title="Permalink to this headline">¶</a></h4>
<p>If you have <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> enabled for some or all of your columns, and your
datetime strings are all formatted the same way, you may get a large speed
up by setting <code class="docutils literal notranslate"><span class="pre">infer_datetime_format=True</span></code>.  If set, pandas will attempt
to guess the format of your datetime strings, and then use a faster means
of parsing the strings.  5-10x parsing speeds have been observed.  pandas
will fallback to the usual parsing if either the format cannot be guessed
or the format that was guessed cannot properly parse the entire column
of strings.  So in general, <code class="docutils literal notranslate"><span class="pre">infer_datetime_format</span></code> should not have any
negative consequences if enabled.</p>
<p>Here are some examples of datetime strings that can be guessed (All
representing December 30th, 2011 at 00:00:00):</p>
<ul class="simple">
<li><p>“20111230”</p></li>
<li><p>“2011/12/30”</p></li>
<li><p>“20111230 00:00:00”</p></li>
<li><p>“12/30/2011 00:00:00”</p></li>
<li><p>“30/Dec/2011 00:00:00”</p></li>
<li><p>“30/December/2011 00:00:00”</p></li>
</ul>
<p>Note that <code class="docutils literal notranslate"><span class="pre">infer_datetime_format</span></code> is sensitive to <code class="docutils literal notranslate"><span class="pre">dayfirst</span></code>.  With
<code class="docutils literal notranslate"><span class="pre">dayfirst=True</span></code>, it will guess “01/12/2011” to be December 1st. With
<code class="docutils literal notranslate"><span class="pre">dayfirst=False</span></code> (default) it will guess “01/12/2011” to be January 12th.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Try to infer the format for the index column</span>
<span class="gp">In [115]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;foo.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">   .....: </span>                 <span class="n">infer_datetime_format</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [116]: </span><span class="n">df</span>
<span class="gh">Out[116]: </span><span class="go"></span>
<span class="go">            A  B  C</span>
<span class="go">date               </span>
<span class="go">2009-01-01  a  1  2</span>
<span class="go">2009-01-02  b  3  4</span>
<span class="go">2009-01-03  c  4  5</span>
</pre></div>
</div>
</div>
<div class="section" id="international-date-formats">
<h4>International Date Formats<a class="headerlink" href="#international-date-formats" title="Permalink to this headline">¶</a></h4>
<p>While US date formats tend to be MM/DD/YYYY, many international formats use
DD/MM/YYYY instead. For convenience, a <code class="docutils literal notranslate"><span class="pre">dayfirst</span></code> keyword is provided:</p>
<pre class="literal-block">In [117]: print(open('tmp.csv').read())
date,value,cat
1/6/2000,5,a
2/6/2000,10,b
3/6/2000,15,c

In [118]: pd.read_csv('tmp.csv', parse_dates=[0])
Out[118]: 
        date  value cat
0 2000-01-06      5   a
1 2000-02-06     10   b
2 2000-03-06     15   c

In [119]: pd.read_csv('tmp.csv', dayfirst=True, parse_dates=[0])
Out[119]: 
        date  value cat
0 2000-06-01      5   a
1 2000-06-02     10   b
2 2000-06-03     15   c</pre>
</div>
</div>
<div class="section" id="specifying-method-for-floating-point-conversion">
<span id="io-float-precision"></span><h3>Specifying method for floating-point conversion<a class="headerlink" href="#specifying-method-for-floating-point-conversion" title="Permalink to this headline">¶</a></h3>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">float_precision</span></code> can be specified in order to use
a specific floating-point converter during parsing with the C engine.
The options are the ordinary converter, the high-precision converter, and
the round-trip converter (which is guaranteed to round-trip values after
writing to a file). For example:</p>
<pre class="literal-block">In [120]: val = '0.3066101993807095471566981359501369297504425048828125'

In [121]: data = 'a,b,c\n1,2,{0}'.format(val)

In [122]: abs(pd.read_csv(StringIO(data), engine='c',
   .....:                 float_precision=None)['c'][0] - float(val))
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-122-b56c76955161&gt; in &lt;module&gt;
----&gt; 1 abs(pd.read_csv(StringIO(data), engine='c',
      2                 float_precision=None)['c'][0] - float(val))

NameError: name 'StringIO' is not defined

In [123]: abs(pd.read_csv(StringIO(data), engine='c',
   .....:                 float_precision='high')['c'][0] - float(val))
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-123-d1b11396e0fb&gt; in &lt;module&gt;
----&gt; 1 abs(pd.read_csv(StringIO(data), engine='c',
      2                 float_precision='high')['c'][0] - float(val))

NameError: name 'StringIO' is not defined

In [124]: abs(pd.read_csv(StringIO(data), engine='c',
   .....:                 float_precision='round_trip')['c'][0] - float(val))
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-124-2cf06c56cf90&gt; in &lt;module&gt;
----&gt; 1 abs(pd.read_csv(StringIO(data), engine='c',
      2                 float_precision='round_trip')['c'][0] - float(val))

NameError: name 'StringIO' is not defined</pre>
</div>
<div class="section" id="thousand-separators">
<span id="io-thousands"></span><h3>Thousand Separators<a class="headerlink" href="#thousand-separators" title="Permalink to this headline">¶</a></h3>
<p>For large numbers that have been written with a thousands separator, you can
set the <code class="docutils literal notranslate"><span class="pre">thousands</span></code> keyword to a string of length 1 so that integers will be parsed
correctly:</p>
<p>By default, numbers with a thousands separator will be parsed as strings:</p>
<pre class="literal-block">In [125]: print(open('tmp.csv').read())
ID|level|category
Patient1|123,000|x
Patient2|23,000|y
Patient3|1,234,018|z

In [126]: df = pd.read_csv('tmp.csv', sep='|')

In [127]: df
Out[127]: 
         ID      level category
0  Patient1    123,000        x
1  Patient2     23,000        y
2  Patient3  1,234,018        z

In [128]: df.level.dtype
Out[128]: dtype('O')</pre>
<p>The <code class="docutils literal notranslate"><span class="pre">thousands</span></code> keyword allows integers to be parsed correctly:</p>
<pre class="literal-block">In [129]: print(open('tmp.csv').read())
ID|level|category
Patient1|123,000|x
Patient2|23,000|y
Patient3|1,234,018|z

In [130]: df = pd.read_csv('tmp.csv', sep='|', thousands=',')

In [131]: df
Out[131]: 
         ID    level category
0  Patient1   123000        x
1  Patient2    23000        y
2  Patient3  1234018        z

In [132]: df.level.dtype
Out[132]: dtype('int64')</pre>
</div>
<div class="section" id="na-values">
<span id="io-na-values"></span><h3>NA Values<a class="headerlink" href="#na-values" title="Permalink to this headline">¶</a></h3>
<p>To control which values are parsed as missing values (which are signified by
<code class="docutils literal notranslate"><span class="pre">NaN</span></code>), specify a string in <code class="docutils literal notranslate"><span class="pre">na_values</span></code>. If you specify a list of strings,
then all values in it are considered to be missing values. If you specify a
number (a <code class="docutils literal notranslate"><span class="pre">float</span></code>, like <code class="docutils literal notranslate"><span class="pre">5.0</span></code> or an <code class="docutils literal notranslate"><span class="pre">integer</span></code> like <code class="docutils literal notranslate"><span class="pre">5</span></code>), the
corresponding equivalent values will also imply a missing value (in this case
effectively <code class="docutils literal notranslate"><span class="pre">[5.0,</span> <span class="pre">5]</span></code> are recognized as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>).</p>
<p>To completely override the default values that are recognized as missing, specify <code class="docutils literal notranslate"><span class="pre">keep_default_na=False</span></code>.</p>
<p id="io-navaluesconst">The default <code class="docutils literal notranslate"><span class="pre">NaN</span></code> recognized values are <code class="docutils literal notranslate"><span class="pre">['-1.#IND',</span> <span class="pre">'1.#QNAN',</span> <span class="pre">'1.#IND',</span> <span class="pre">'-1.#QNAN',</span> <span class="pre">'#N/A</span> <span class="pre">N/A',</span> <span class="pre">'#N/A',</span> <span class="pre">'N/A',</span>
<span class="pre">'n/a',</span> <span class="pre">'NA',</span> <span class="pre">'#NA',</span> <span class="pre">'NULL',</span> <span class="pre">'null',</span> <span class="pre">'NaN',</span> <span class="pre">'-NaN',</span> <span class="pre">'nan',</span> <span class="pre">'-nan',</span> <span class="pre">'']</span></code>.</p>
<p>Let us consider some examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;path_to_file.csv&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>In the example above <code class="docutils literal notranslate"><span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">5.0</span></code> will be recognized as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, in
addition to the defaults. A string will first be interpreted as a numerical
<code class="docutils literal notranslate"><span class="pre">5</span></code>, then as a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;path_to_file.csv&#39;</span><span class="p">,</span> <span class="n">keep_default_na</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Above, only an empty field will be recognized as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;path_to_file.csv&#39;</span><span class="p">,</span> <span class="n">keep_default_na</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NA&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Above, both <code class="docutils literal notranslate"><span class="pre">NA</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code> as strings are <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;path_to_file.csv&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Nope&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The default values, in addition to the string <code class="docutils literal notranslate"><span class="pre">&quot;Nope&quot;</span></code> are recognized as
<code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</div>
<div class="section" id="infinity">
<span id="io-infinity"></span><h3>Infinity<a class="headerlink" href="#infinity" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">inf</span></code> like values will be parsed as <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> (positive infinity), and <code class="docutils literal notranslate"><span class="pre">-inf</span></code> as <code class="docutils literal notranslate"><span class="pre">-np.inf</span></code> (negative infinity).
These will ignore the case of the value, meaning <code class="docutils literal notranslate"><span class="pre">Inf</span></code>, will also be parsed as <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p>
</div>
<div class="section" id="returning-series">
<h3>Returning Series<a class="headerlink" href="#returning-series" title="Permalink to this headline">¶</a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">squeeze</span></code> keyword, the parser will return output with a single column
as a <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<pre class="literal-block">In [133]: print(open('tmp.csv').read())
level
Patient1,123000
Patient2,23000
Patient3,1234018

In [134]: output = pd.read_csv('tmp.csv', squeeze=True)

In [135]: output
Out[135]: 
Patient1     123000
Patient2      23000
Patient3    1234018
Name: level, dtype: int64

In [136]: type(output)
Out[136]: pandas.core.series.Series</pre>
</div>
<div class="section" id="boolean-values">
<span id="io-boolean"></span><h3>Boolean values<a class="headerlink" href="#boolean-values" title="Permalink to this headline">¶</a></h3>
<p>The common values <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, and <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> are all
recognized as boolean. Occasionally you might want to recognize other values
as being boolean. To do this, use the <code class="docutils literal notranslate"><span class="pre">true_values</span></code> and <code class="docutils literal notranslate"><span class="pre">false_values</span></code>
options as follows:</p>
<pre class="literal-block">In [137]: data = ('a,b,c\n'
   .....:         '1,Yes,2\n'
   .....:         '3,No,4')
   .....: 

In [138]: print(data)
a,b,c
1,Yes,2
3,No,4

In [139]: pd.read_csv(StringIO(data))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-139-6388c394e6b8&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data))

NameError: name 'StringIO' is not defined

In [140]: pd.read_csv(StringIO(data), true_values=['Yes'], false_values=['No'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-140-ff49bdb02694&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), true_values=['Yes'], false_values=['No'])

NameError: name 'StringIO' is not defined</pre>
</div>
<div class="section" id="handling-bad-lines">
<span id="io-bad-lines"></span><h3>Handling “bad” lines<a class="headerlink" href="#handling-bad-lines" title="Permalink to this headline">¶</a></h3>
<p>Some files may have malformed lines with too few fields or too many. Lines with
too few fields will have NA values filled in the trailing fields. Lines with
too many fields will raise an error by default:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [141]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a,b,c</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   .....: </span>        <span class="s1">&#39;1,2,3</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   .....: </span>        <span class="s1">&#39;4,5,6,7</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">   .....: </span>        <span class="s1">&#39;8,9,10&#39;</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [142]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">142</span><span class="o">-</span><span class="mi">6388</span><span class="n">c394e6b8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>You can elect to skip bad lines:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Skipping line 3: expected 3 fields, saw 4</span>

<span class="gh">Out[29]:</span>
<span class="go">   a  b   c</span>
<span class="go">0  1  2   3</span>
<span class="go">1  8  9  10</span>
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">usecols</span></code> parameter to eliminate extraneous column
data that appear in some lines but not others:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="go"> Out[30]:</span>
<span class="go">    a  b   c</span>
<span class="go"> 0  1  2   3</span>
<span class="go"> 1  4  5   6</span>
<span class="go"> 2  8  9  10</span>
</pre></div>
</div>
</div>
<div class="section" id="dialect">
<span id="io-dialect"></span><h3>Dialect<a class="headerlink" href="#dialect" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">dialect</span></code> keyword gives greater flexibility in specifying the file format.
By default it uses the Excel dialect but you can specify either the dialect name
or a <a class="reference external" href="https://docs.python.org/3/library/csv.html#csv.Dialect" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">csv.Dialect</span></code></a> instance.</p>
<p>Suppose you had data with unenclosed quotes:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [143]: </span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">label1,label2,label3</span>
<span class="go">index1,&quot;a,c,e</span>
<span class="go">index2,b,d,f</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> uses the Excel dialect and treats the double quote as
the quote character, which causes it to fail when it finds a newline before it
finds the closing double quote.</p>
<p>We can get around this using <code class="docutils literal notranslate"><span class="pre">dialect</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [144]: </span><span class="kn">import</span> <span class="nn">csv</span>

<span class="gp">In [145]: </span><span class="n">dia</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">()</span>

<span class="gp">In [146]: </span><span class="n">dia</span><span class="o">.</span><span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span>

<span class="gp">In [147]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dia</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">147</span><span class="o">-</span><span class="mi">7775</span><span class="n">ae9d058e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dia</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>All of the dialect options can be specified separately by keyword arguments:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [148]: </span><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;a,b,c~1,2,3~4,5,6&#39;</span>

<span class="gp">In [149]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">lineterminator</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">149</span><span class="o">-</span><span class="mi">89</span><span class="n">dc3dd973a0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">lineterminator</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;StringIO&#39; is not defined
</pre></div>
</div>
<p>Another common dialect option is <code class="docutils literal notranslate"><span class="pre">skipinitialspace</span></code>, to skip any whitespace
after a delimiter:</p>
<pre class="literal-block">In [150]: data = 'a, b, c\n1, 2, 3\n4, 5, 6'

In [151]: print(data)
a, b, c
1, 2, 3
4, 5, 6

In [152]: pd.read_csv(StringIO(data), skipinitialspace=True)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-152-3a209fe403b1&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), skipinitialspace=True)

NameError: name 'StringIO' is not defined</pre>
<p>The parsers make every attempt to “do the right thing” and not be fragile. Type
inference is a pretty big deal. If a column can be coerced to integer dtype
without altering the contents, the parser will do so. Any non-numeric
columns will come through as object dtype as with the rest of pandas objects.</p>
</div>
<div class="section" id="quoting-and-escape-characters">
<span id="io-quoting"></span><h3>Quoting and Escape Characters<a class="headerlink" href="#quoting-and-escape-characters" title="Permalink to this headline">¶</a></h3>
<p>Quotes (and other escape characters) in embedded fields can be handled in any
number of ways. One way is to use backslashes; to properly parse this data, you
should pass the <code class="docutils literal notranslate"><span class="pre">escapechar</span></code> option:</p>
<pre class="literal-block">In [153]: data = 'a,b\n&quot;hello, \\&quot;Bob\\&quot;, nice to see you&quot;,5'

In [154]: print(data)
a,b
&quot;hello, \&quot;Bob\&quot;, nice to see you&quot;,5

In [155]: pd.read_csv(StringIO(data), escapechar='\\')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-155-d1d047479a7b&gt; in &lt;module&gt;
----&gt; 1 pd.read_csv(StringIO(data), escapechar='\\')

NameError: name 'StringIO' is not defined</pre>
</div>
<div class="section" id="files-with-fixed-width-columns">
<span id="io-fwf"></span><h3>Files with Fixed Width Columns<a class="headerlink" href="#files-with-fixed-width-columns" title="Permalink to this headline">¶</a></h3>
<p>While <a class="reference internal" href="../reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_csv()</span></code></a> reads delimited data, the <a class="reference internal" href="../reference/api/pandas.read_fwf.html#pandas.read_fwf" title="pandas.read_fwf"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_fwf()</span></code></a> function works
with data files that have known and fixed column widths. The function parameters
to <code class="docutils literal notranslate"><span class="pre">read_fwf</span></code> are largely the same as <cite>read_csv</cite> with two extra parameters, and
a different usage of the <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">colspecs</span></code>: A list of pairs (tuples) giving the extents of the
fixed-width fields of each line as half-open intervals (i.e.,  [from, to[ ).
String value ‘infer’ can be used to instruct the parser to try detecting
the column specifications from the first 100 rows of the data. Default
behavior, if not specified, is to infer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">widths</span></code>: A list of field widths which can be used instead of ‘colspecs’
if the intervals are contiguous.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delimiter</span></code>: Characters to consider as filler characters in the fixed-width file.
Can be used to specify the filler character of the fields
if it is not spaces (e.g., ‘~’).</p></li>
</ul>
<p>Consider a typical fixed-width data file:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [156]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;bar.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">id8141    360.242940   149.910199   11950.7</span>
<span class="go">id1594    444.953632   166.985655   11788.4</span>
<span class="go">id1849    364.136849   183.628767   11806.2</span>
<span class="go">id1230    413.836124   184.375703   11916.8</span>
<span class="go">id1948    502.953953   173.237159   12468.3</span>
</pre></div>
</div>
<p>In order to parse this file into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, we simply need to supply the
column specifications to the <cite>read_fwf</cite> function along with the file name:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Column specifications are a list of half-intervals</span>
<span class="gp">In [157]: </span><span class="n">colspecs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mi">43</span><span class="p">)]</span>

<span class="gp">In [158]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s1">&#39;bar.csv&#39;</span><span class="p">,</span> <span class="n">colspecs</span><span class="o">=</span><span class="n">colspecs</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [159]: </span><span class="n">df</span>
<span class="gh">Out[159]: </span><span class="go"></span>
<span class="go">                 1           2        3</span>
<span class="go">0                                      </span>
<span class="go">id8141  360.242940  149.910199  11950.7</span>
<span class="go">id1594  444.953632  166.985655  11788.4</span>
<span class="go">id1849  364.136849  183.628767  11806.2</span>
<span class="go">id1230  413.836124  184.375703  11916.8</span>
<span class="go">id1948  502.953953  173.237159  12468.3</span>
</pre></div>
</div>
<p>Note how the parser automatically picks column names X.&lt;column number&gt; when
<code class="docutils literal notranslate"><span class="pre">header=None</span></code> argument is specified. Alternatively, you can supply just the
column widths for contiguous columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Widths are a list of integers</span>
<span class="gp">In [160]: </span><span class="n">widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="gp">In [161]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s1">&#39;bar.csv&#39;</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="gp">In [162]: </span><span class="n">df</span>
<span class="gh">Out[162]: </span><span class="go"></span>
<span class="go">        0           1           2        3</span>
<span class="go">0  id8141  360.242940  149.910199  11950.7</span>
<span class="go">1  id1594  444.953632  166.985655  11788.4</span>
<span class="go">2  id1849  364.136849  183.628767  11806.2</span>
<span class="go">3  id1230  413.836124  184.375703  11916.8</span>
<span class="go">4  id1948  502.953953  173.237159  12468.3</span>
</pre></div>
</div>
<p>The parser will take care of extra white spaces around the columns
so it’s ok to have extra separation between the columns in the file.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">read_fwf</span></code> will try to infer the file’s <code class="docutils literal notranslate"><span class="pre">colspecs</span></code> by using the
first 100 rows of the file. It can do it only in cases when the columns are
aligned and correctly separated by the provided <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> (default delimiter
is whitespace).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [163]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s1">&#39;bar.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [164]: </span><span class="n">df</span>
<span class="gh">Out[164]: </span><span class="go"></span>
<span class="go">                 1           2        3</span>
<span class="go">0                                      </span>
<span class="go">id8141  360.242940  149.910199  11950.7</span>
<span class="go">id1594  444.953632  166.985655  11788.4</span>
<span class="go">id1849  364.136849  183.628767  11806.2</span>
<span class="go">id1230  413.836124  184.375703  11916.8</span>
<span class="go">id1948  502.953953  173.237159  12468.3</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">read_fwf</span></code> supports the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter for specifying the types of
parsed columns to be different from the inferred type.</p>
<pre class="literal-block">In [165]: pd.read_fwf('bar.csv', header=None, index_col=0).dtypes
Out[165]: 
1    float64
2    float64
3    float64
dtype: object

In [166]: pd.read_fwf('bar.csv', header=None, dtype={2: 'object'}).dtypes
Out[166]: 
0     object
1    float64
2     object
3    float64
dtype: object</pre>
</div>
<div class="section" id="indexes">
<h3>Indexes<a class="headerlink" href="#indexes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="files-with-an-implicit-index-column">
<h4>Files with an “implicit” index column<a class="headerlink" href="#files-with-an-implicit-index-column" title="Permalink to this headline">¶</a></h4>
<p>Consider a file with one less entry in the header than the number of data
column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [167]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;foo.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">A,B,C</span>
<span class="go">20090101,a,1,2</span>
<span class="go">20090102,b,3,4</span>
<span class="go">20090103,c,4,5</span>
</pre></div>
</div>
<p>In this special case, <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> assumes that the first column is to be used
as the index of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [168]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;foo.csv&#39;</span><span class="p">)</span>
<span class="gh">Out[168]: </span><span class="go"></span>
<span class="go">          A  B  C</span>
<span class="go">20090101  a  1  2</span>
<span class="go">20090102  b  3  4</span>
<span class="go">20090103  c  4  5</span>
</pre></div>
</div>
<p>Note that the dates weren’t automatically parsed. In that case you would need
to do as before:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [169]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;foo.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [170]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="gh">Out[170]: </span><span class="go">DatetimeIndex([&#39;2009-01-01&#39;, &#39;2009-01-02&#39;, &#39;2009-01-03&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-an-index-with-a-multiindex">
<h4>Reading an index with a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code><a class="headerlink" href="#reading-an-index-with-a-multiindex" title="Permalink to this headline">¶</a></h4>
<p id="io-csv-multiindex">Suppose you have data indexed by two columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [171]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/mindex_ex.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">year,indiv,zit,xit</span>
<span class="go">1977,&quot;A&quot;,1.2,.6</span>
<span class="go">1977,&quot;B&quot;,1.5,.5</span>
<span class="go">1977,&quot;C&quot;,1.7,.8</span>
<span class="go">1978,&quot;A&quot;,.2,.06</span>
<span class="go">1978,&quot;B&quot;,.7,.2</span>
<span class="go">1978,&quot;C&quot;,.8,.3</span>
<span class="go">1978,&quot;D&quot;,.9,.5</span>
<span class="go">1978,&quot;E&quot;,1.4,.9</span>
<span class="go">1979,&quot;C&quot;,.2,.15</span>
<span class="go">1979,&quot;D&quot;,.14,.05</span>
<span class="go">1979,&quot;E&quot;,.5,.15</span>
<span class="go">1979,&quot;F&quot;,1.2,.5</span>
<span class="go">1979,&quot;G&quot;,3.4,1.9</span>
<span class="go">1979,&quot;H&quot;,5.4,2.7</span>
<span class="go">1979,&quot;I&quot;,6.4,1.2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">index_col</span></code> argument to <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> can take a list of
column numbers to turn multiple columns into a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> for the index of the
returned object:</p>
<pre class="literal-block">In [172]: df = pd.read_csv(&quot;data/mindex_ex.csv&quot;, index_col=[0, 1])

In [173]: df
Out[173]: 
             zit   xit
year indiv            
1977 A      1.20  0.60
     B      1.50  0.50
     C      1.70  0.80
1978 A      0.20  0.06
     B      0.70  0.20
     C      0.80  0.30
     D      0.90  0.50
     E      1.40  0.90
1979 C      0.20  0.15
     D      0.14  0.05
     E      0.50  0.15
     F      1.20  0.50
     G      3.40  1.90
     H      5.40  2.70
     I      6.40  1.20

In [174]: df.loc[1978]
Out[174]: 
       zit   xit
indiv           
A      0.2  0.06
B      0.7  0.20
C      0.8  0.30
D      0.9  0.50
E      1.4  0.90</pre>
</div>
<div class="section" id="reading-columns-with-a-multiindex">
<span id="io-multi-index-columns"></span><h4>Reading columns with a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code><a class="headerlink" href="#reading-columns-with-a-multiindex" title="Permalink to this headline">¶</a></h4>
<p>By specifying list of row locations for the <code class="docutils literal notranslate"><span class="pre">header</span></code> argument, you
can read in a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> for the columns. Specifying non-consecutive
rows will skip the intervening rows.</p>
<pre class="literal-block">In [175]: from pandas.util.testing import makeCustomDataframe as mkdf

In [176]: df = mkdf(5, 3, r_idx_nlevels=2, c_idx_nlevels=4)

In [177]: df.to_csv('mi.csv')

In [178]: print(open('mi.csv').read())
C0,,C_l0_g0,C_l0_g1,C_l0_g2
C1,,C_l1_g0,C_l1_g1,C_l1_g2
C2,,C_l2_g0,C_l2_g1,C_l2_g2
C3,,C_l3_g0,C_l3_g1,C_l3_g2
R0,R1,,,
R_l0_g0,R_l1_g0,R0C0,R0C1,R0C2
R_l0_g1,R_l1_g1,R1C0,R1C1,R1C2
R_l0_g2,R_l1_g2,R2C0,R2C1,R2C2
R_l0_g3,R_l1_g3,R3C0,R3C1,R3C2
R_l0_g4,R_l1_g4,R4C0,R4C1,R4C2


In [179]: pd.read_csv('mi.csv', header=[0, 1, 2, 3], index_col=[0, 1])
Out[179]: 
C0              C_l0_g0 C_l0_g1 C_l0_g2
C1              C_l1_g0 C_l1_g1 C_l1_g2
C2              C_l2_g0 C_l2_g1 C_l2_g2
C3              C_l3_g0 C_l3_g1 C_l3_g2
R0      R1                             
R_l0_g0 R_l1_g0    R0C0    R0C1    R0C2
R_l0_g1 R_l1_g1    R1C0    R1C1    R1C2
R_l0_g2 R_l1_g2    R2C0    R2C1    R2C2
R_l0_g3 R_l1_g3    R3C0    R3C1    R3C2
R_l0_g4 R_l1_g4    R4C0    R4C1    R4C2</pre>
<p><code class="docutils literal notranslate"><span class="pre">read_csv</span></code> is also able to interpret a more common format
of multi-columns indices.</p>
<pre class="literal-block">In [180]: print(open('mi2.csv').read())
,a,a,a,b,c,c
,q,r,s,t,u,v
one,1,2,3,4,5,6
two,7,8,9,10,11,12

In [181]: pd.read_csv('mi2.csv', header=[0, 1], index_col=0)
Out[181]: 
     a         b   c    
     q  r  s   t   u   v
one  1  2  3   4   5   6
two  7  8  9  10  11  12</pre>
<p>Note: If an <code class="docutils literal notranslate"><span class="pre">index_col</span></code> is not specified (e.g. you don’t have an index, or wrote it
with <code class="docutils literal notranslate"><span class="pre">df.to_csv(...,</span> <span class="pre">index=False)</span></code>, then any <code class="docutils literal notranslate"><span class="pre">names</span></code> on the columns index will be <em>lost</em>.</p>
</div>
</div>
<div class="section" id="automatically-sniffing-the-delimiter">
<span id="io-sniff"></span><h3>Automatically “sniffing” the delimiter<a class="headerlink" href="#automatically-sniffing-the-delimiter" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">read_csv</span></code> is capable of inferring delimited (not necessarily
comma-separated) files, as pandas uses the <a class="reference external" href="https://docs.python.org/3/library/csv.html#csv.Sniffer" title="(in Python v3.8)"><code class="docutils literal notranslate"><span class="pre">csv.Sniffer</span></code></a>
class of the csv module. For this, you have to specify <code class="docutils literal notranslate"><span class="pre">sep=None</span></code>.</p>
<pre class="literal-block">In [182]: print(open('tmp2.sv').read())
:0:1:2:3
0:0.4691122999071863:-0.2828633443286633:-1.5090585031735124:-1.1356323710171934
1:1.2121120250208506:-0.17321464905330858:0.11920871129693428:-1.0442359662799567
2:-0.8618489633477999:-2.1045692188948086:-0.4949292740687813:1.071803807037338
3:0.7215551622443669:-0.7067711336300845:-1.0395749851146963:0.27185988554282986
4:-0.42497232978883753:0.567020349793672:0.27623201927771873:-1.0874006912859915
5:-0.6736897080883706:0.1136484096888855:-1.4784265524372235:0.5249876671147047
6:0.4047052186802365:0.5770459859204836:-1.7150020161146375:-1.0392684835147725
7:-0.3706468582364464:-1.1578922506419993:-1.344311812731667:0.8448851414248841
8:1.0757697837155533:-0.10904997528022223:1.6435630703622064:-1.4693879595399115
9:0.35702056413309086:-0.6746001037299882:-1.776903716971867:-0.9689138124473498


In [183]: pd.read_csv('tmp2.sv', sep=None, engine='python')
Out[183]: 
   Unnamed: 0         0         1         2         3
0           0  0.469112 -0.282863 -1.509059 -1.135632
1           1  1.212112 -0.173215  0.119209 -1.044236
2           2 -0.861849 -2.104569 -0.494929  1.071804
3           3  0.721555 -0.706771 -1.039575  0.271860
4           4 -0.424972  0.567020  0.276232 -1.087401
5           5 -0.673690  0.113648 -1.478427  0.524988
6           6  0.404705  0.577046 -1.715002 -1.039268
7           7 -0.370647 -1.157892 -1.344312  0.844885
8           8  1.075770 -0.109050  1.643563 -1.469388
9           9  0.357021 -0.674600 -1.776904 -0.968914</pre>
</div>
<div class="section" id="reading-multiple-files-to-create-a-single-dataframe">
<span id="io-multiple-files"></span><h3>Reading multiple files to create a single DataFrame<a class="headerlink" href="#reading-multiple-files-to-create-a-single-dataframe" title="Permalink to this headline">¶</a></h3>
<p>It’s best to use <a class="reference internal" href="../reference/api/pandas.concat.html#pandas.concat" title="pandas.concat"><code class="xref py py-func docutils literal notranslate"><span class="pre">concat()</span></code></a> to combine multiple files.
See the <a class="reference internal" href="cookbook.html#cookbook-csv-multiple-files"><span class="std std-ref">cookbook</span></a> for an example.</p>
</div>
<div class="section" id="iterating-through-files-chunk-by-chunk">
<span id="io-chunking"></span><h3>Iterating through files chunk by chunk<a class="headerlink" href="#iterating-through-files-chunk-by-chunk" title="Permalink to this headline">¶</a></h3>
<p>Suppose you wish to iterate through a (potentially very large) file lazily
rather than reading the entire file into memory, such as the following:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [184]: </span><span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tmp.sv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">|0|1|2|3</span>
<span class="go">0|0.4691122999071863|-0.2828633443286633|-1.5090585031735124|-1.1356323710171934</span>
<span class="go">1|1.2121120250208506|-0.17321464905330858|0.11920871129693428|-1.0442359662799567</span>
<span class="go">2|-0.8618489633477999|-2.1045692188948086|-0.4949292740687813|1.071803807037338</span>
<span class="go">3|0.7215551622443669|-0.7067711336300845|-1.0395749851146963|0.27185988554282986</span>
<span class="go">4|-0.42497232978883753|0.567020349793672|0.27623201927771873|-1.0874006912859915</span>
<span class="go">5|-0.6736897080883706|0.1136484096888855|-1.4784265524372235|0.5249876671147047</span>
<span class="go">6|0.4047052186802365|0.5770459859204836|-1.7150020161146375|-1.0392684835147725</span>
<span class="go">7|-0.3706468582364464|-1.1578922506419993|-1.344311812731667|0.8448851414248841</span>
<span class="go">8|1.0757697837155533|-0.10904997528022223|1.6435630703622064|-1.4693879595399115</span>
<span class="go">9|0.35702056413309086|-0.6746001037299882|-1.776903716971867|-0.9689138124473498</span>


<span class="gp">In [185]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.sv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

<span class="gp">In [186]: </span><span class="n">table</span>
<span class="gh">Out[186]: </span><span class="go"></span>
<span class="go">   Unnamed: 0         0         1         2         3</span>
<span class="go">0           0  0.469112 -0.282863 -1.509059 -1.135632</span>
<span class="go">1           1  1.212112 -0.173215  0.119209 -1.044236</span>
<span class="go">2           2 -0.861849 -2.104569 -0.494929  1.071804</span>
<span class="go">3           3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">4           4 -0.424972  0.567020  0.276232 -1.087401</span>
<span class="go">5           5 -0.673690  0.113648 -1.478427  0.524988</span>
<span class="go">6           6  0.404705  0.577046 -1.715002 -1.039268</span>
<span class="go">7           7 -0.370647 -1.157892 -1.344312  0.844885</span>
<span class="go">8           8  1.075770 -0.109050  1.643563 -1.469388</span>
<span class="go">9           9  0.357021 -0.674600 -1.776904 -0.968914</span>
</pre></div>
</div>
<p>By specifying a <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> to <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>, the return
value will be an iterable object of type <code class="docutils literal notranslate"><span class="pre">TextFileReader</span></code>:</p>
<pre class="literal-block">In [187]: reader = pd.read_csv('tmp.sv', sep='|', chunksize=4)

In [188]: reader
Out[188]: &lt;pandas.io.parsers.TextFileReader at 0x7f4bc866cb90&gt;

In [189]: for chunk in reader:
   .....:     print(chunk)
   .....: 
  Unnamed: 0         0         1         2         3
0           0  0.469112 -0.282863 -1.509059 -1.135632
1           1  1.212112 -0.173215  0.119209 -1.044236
2           2 -0.861849 -2.104569 -0.494929  1.071804
3           3  0.721555 -0.706771 -1.039575  0.271860
   Unnamed: 0         0         1         2         3
4           4 -0.424972  0.567020  0.276232 -1.087401
5           5 -0.673690  0.113648 -1.478427  0.524988
6           6  0.404705  0.577046 -1.715002 -1.039268
7           7 -0.370647 -1.157892 -1.344312  0.844885
   Unnamed: 0         0        1         2         3
8           8  1.075770 -0.10905  1.643563 -1.469388
9           9  0.357021 -0.67460 -1.776904 -0.968914</pre>
<p>Specifying <code class="docutils literal notranslate"><span class="pre">iterator=True</span></code> will also return the <code class="docutils literal notranslate"><span class="pre">TextFileReader</span></code> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [190]: </span><span class="n">reader</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tmp.sv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">iterator</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [191]: </span><span class="n">reader</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gh">Out[191]: </span><span class="go"></span>
<span class="go">   Unnamed: 0         0         1         2         3</span>
<span class="go">0           0  0.469112 -0.282863 -1.509059 -1.135632</span>
<span class="go">1           1  1.212112 -0.173215  0.119209 -1.044236</span>
<span class="go">2           2 -0.861849 -2.104569 -0.494929  1.071804</span>
<span class="go">3           3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">4           4 -0.424972  0.567020  0.276232 -1.087401</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-the-parser-engine">
<h3>Specifying the parser engine<a class="headerlink" href="#specifying-the-parser-engine" title="Permalink to this headline">¶</a></h3>
<p>Under the hood pandas uses a fast and efficient parser implemented in C as well
as a Python implementation which is currently more feature-complete. Where
possible pandas uses the C parser (specified as <code class="docutils literal notranslate"><span class="pre">engine='c'</span></code>), but may fall
back to Python if C-unsupported options are specified. Currently, C-unsupported
options include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sep</span></code> other than a single character (e.g. regex separators)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skipfooter</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sep=None</span></code> with <code class="docutils literal notranslate"><span class="pre">delim_whitespace=False</span></code></p></li>
</ul>
<p>Specifying any of the above options will produce a <code class="docutils literal notranslate"><span class="pre">ParserWarning</span></code> unless the
python engine is selected explicitly using <code class="docutils literal notranslate"><span class="pre">engine='python'</span></code>.</p>
</div>
<div class="section" id="reading-remote-files">
<h3>Reading remote files<a class="headerlink" href="#reading-remote-files" title="Permalink to this headline">¶</a></h3>
<p>You can pass in a URL to a CSV file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://download.bls.gov/pub/time.series/cu/cu.item&#39;</span><span class="p">,</span>
                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>S3 URLs are handled as well but require installing the <a class="reference external" href="https://pypi.org/project/s3fs/">S3Fs</a> library:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;s3://pandas-test/tips.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If your S3 bucket requires cedentials you will need to set them as environment
variables or in the <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> config file, refer to the <a class="reference external" href="https://s3fs.readthedocs.io/en/latest/#credentials">S3Fs
documentation on credentials</a>.</p>
</div>
<div class="section" id="writing-out-data">
<h3>Writing out Data<a class="headerlink" href="#writing-out-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="writing-to-csv-format">
<span id="io-store-in-csv"></span><h4>Writing to CSV format<a class="headerlink" href="#writing-to-csv-format" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects have an instance method <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> which
allows storing the contents of the object as a comma-separated-values file. The
function takes a number of arguments. Only the first is required.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path_or_buf</span></code>: A string path to the file to write or a file object.  If a file object it must be opened with <cite>newline=’’</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sep</span></code> : Field delimiter for the output file (default “,”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">na_rep</span></code>: A string representation of a missing value (default ‘’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float_format</span></code>: Format string for floating point numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code>: Columns to write (default None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code>: Whether to write out the column names (default True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: whether to write row (index) names (default True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index_label</span></code>: Column label(s) for index column(s) if desired. If None
(default), and <cite>header</cite> and <cite>index</cite> are True, then the index names are
used. (A sequence should be given if the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> uses MultiIndex).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code> : Python write mode, default ‘w’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encoding</span></code>: a string representing the encoding to use if the contents are
non-ASCII, for Python versions prior to 3</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">line_terminator</span></code>: Character sequence denoting line end (default <cite>os.linesep</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quoting</span></code>: Set quoting rules as in csv module (default csv.QUOTE_MINIMAL). Note that if you have set a <cite>float_format</cite> then floats are converted to strings and csv.QUOTE_NONNUMERIC will treat them as non-numeric</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quotechar</span></code>: Character used to quote fields (default ‘”’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doublequote</span></code>: Control quoting of <code class="docutils literal notranslate"><span class="pre">quotechar</span></code> in fields (default True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">escapechar</span></code>: Character used to escape <code class="docutils literal notranslate"><span class="pre">sep</span></code> and <code class="docutils literal notranslate"><span class="pre">quotechar</span></code> when
appropriate (default None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunksize</span></code>: Number of rows to write at a time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tupleize_cols</span></code>: If False (default), write as a list of tuples, otherwise
write in an expanded line format suitable for <code class="docutils literal notranslate"><span class="pre">read_csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_format</span></code>: Format string for datetime objects</p></li>
</ul>
</div>
<div class="section" id="writing-a-formatted-string">
<h4>Writing a formatted string<a class="headerlink" href="#writing-a-formatted-string" title="Permalink to this headline">¶</a></h4>
<p id="io-formatting">The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object has an instance method <code class="docutils literal notranslate"><span class="pre">to_string</span></code> which allows control
over the string representation of the object. All arguments are optional:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">buf</span></code> default None, for example a StringIO object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code> default None, which columns to write</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">col_space</span></code> default None, minimum width of each column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">na_rep</span></code> default <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, representation of NA value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formatters</span></code> default None, a dictionary (by column) of functions each of
which takes a single argument and returns a formatted string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float_format</span></code> default None, a function which takes a single (float)
argument and returns a formatted string; to be applied to floats in the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sparsify</span></code> default True, set to False for a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with a hierarchical
index to print every MultiIndex key at each row.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index_names</span></code> default True, will print the names of the indices</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> default True, will print the index (ie, row labels)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code> default True, will print the column labels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">justify</span></code> default <code class="docutils literal notranslate"><span class="pre">left</span></code>, will print column headers left- or
right-justified</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Series</span></code> object also has a <code class="docutils literal notranslate"><span class="pre">to_string</span></code> method, but with only the <code class="docutils literal notranslate"><span class="pre">buf</span></code>,
<code class="docutils literal notranslate"><span class="pre">na_rep</span></code>, <code class="docutils literal notranslate"><span class="pre">float_format</span></code> arguments. There is also a <code class="docutils literal notranslate"><span class="pre">length</span></code> argument
which, if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, will additionally output the length of the Series.</p>
</div>
</div>
</div>
<div class="section" id="json">
<span id="io-json"></span><h2>JSON<a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h2>
<p>Read and write <code class="docutils literal notranslate"><span class="pre">JSON</span></code> format files and strings.</p>
<div class="section" id="writing-json">
<span id="io-json-writer"></span><h3>Writing JSON<a class="headerlink" href="#writing-json" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be converted to a valid JSON string. Use <code class="docutils literal notranslate"><span class="pre">to_json</span></code>
with optional parameters:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">path_or_buf</span></code> : the pathname or buffer to write the output
This can be <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case a JSON string is returned</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orient</span></code> :</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Series</span></code>:</dt><dd><ul class="simple">
<li><p>default is <code class="docutils literal notranslate"><span class="pre">index</span></code></p></li>
<li><p>allowed values are {<code class="docutils literal notranslate"><span class="pre">split</span></code>, <code class="docutils literal notranslate"><span class="pre">records</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>}</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</dt><dd><ul class="simple">
<li><p>default is <code class="docutils literal notranslate"><span class="pre">columns</span></code></p></li>
<li><p>allowed values are {<code class="docutils literal notranslate"><span class="pre">split</span></code>, <code class="docutils literal notranslate"><span class="pre">records</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">columns</span></code>, <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">table</span></code>}</p></li>
</ul>
</dd>
</dl>
<p>The format of the JSON string</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">split</span></code></p></td>
<td><p>dict like {index -&gt; [index], columns -&gt; [columns], data -&gt; [values]}</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">records</span></code></p></td>
<td><p>list like [{column -&gt; value}, … , {column -&gt; value}]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">index</span></code></p></td>
<td><p>dict like {index -&gt; {column -&gt; value}}</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">columns</span></code></p></td>
<td><p>dict like {column -&gt; {index -&gt; value}}</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
<td><p>just the values array</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_format</span></code> : string, type of date conversion, ‘epoch’ for timestamp, ‘iso’ for ISO8601.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double_precision</span></code> : The number of decimal places to use when encoding floating point values, default 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_ascii</span></code> : force encoded string to be ASCII, default True.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_unit</span></code> : The time unit to encode to, governs timestamp and ISO8601 precision. One of ‘s’, ‘ms’, ‘us’ or ‘ns’ for seconds, milliseconds, microseconds and nanoseconds respectively. Default ‘ms’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_handler</span></code> : The handler to call if an object cannot otherwise be converted to a suitable format for JSON. Takes a single argument, which is the object to convert, and returns a serializable object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lines</span></code> : If <code class="docutils literal notranslate"><span class="pre">records</span></code> orient, then will write each record per line as json.</p></li>
</ul>
<p>Note <code class="docutils literal notranslate"><span class="pre">NaN</span></code>’s, <code class="docutils literal notranslate"><span class="pre">NaT</span></code>’s and <code class="docutils literal notranslate"><span class="pre">None</span></code> will be converted to <code class="docutils literal notranslate"><span class="pre">null</span></code> and <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects will be converted based on the <code class="docutils literal notranslate"><span class="pre">date_format</span></code> and <code class="docutils literal notranslate"><span class="pre">date_unit</span></code> parameters.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [192]: </span><span class="n">dfj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>

<span class="gp">In [193]: </span><span class="n">json</span> <span class="o">=</span> <span class="n">dfj</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

<span class="gp">In [194]: </span><span class="n">json</span>
<span class="gh">Out[194]: </span><span class="go">&#39;{&quot;A&quot;:{&quot;0&quot;:-1.2945235903,&quot;1&quot;:0.2766617129,&quot;2&quot;:-0.0139597524,&quot;3&quot;:-0.0061535699,&quot;4&quot;:0.8957173022},&quot;B&quot;:{&quot;0&quot;:0.4137381054,&quot;1&quot;:-0.472034511,&quot;2&quot;:-0.3625429925,&quot;3&quot;:-0.923060654,&quot;4&quot;:0.8052440254}}&#39;</span>
</pre></div>
</div>
<div class="section" id="orient-options">
<h4>Orient Options<a class="headerlink" href="#orient-options" title="Permalink to this headline">¶</a></h4>
<p>There are a number of different options for the format of the resulting JSON
file / string. Consider the following <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [195]: </span><span class="n">dfjo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">B</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">C</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
<span class="gp">   .....: </span>                    <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [196]: </span><span class="n">dfjo</span>
<span class="gh">Out[196]: </span><span class="go"></span>
<span class="go">   A  B  C</span>
<span class="go">x  1  4  7</span>
<span class="go">y  2  5  8</span>
<span class="go">z  3  6  9</span>

<span class="gp">In [197]: </span><span class="n">sjo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">17</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="gp">In [198]: </span><span class="n">sjo</span>
<span class="gh">Out[198]: </span><span class="go"></span>
<span class="go">x    15</span>
<span class="go">y    16</span>
<span class="go">z    17</span>
<span class="go">Name: D, dtype: int64</span>
</pre></div>
</div>
<p><strong>Column oriented</strong> (the default for <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>) serializes the data as
nested JSON objects with column labels acting as the primary index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [199]: </span><span class="n">dfjo</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="gh">Out[199]: </span><span class="go">&#39;{&quot;A&quot;:{&quot;x&quot;:1,&quot;y&quot;:2,&quot;z&quot;:3},&quot;B&quot;:{&quot;x&quot;:4,&quot;y&quot;:5,&quot;z&quot;:6},&quot;C&quot;:{&quot;x&quot;:7,&quot;y&quot;:8,&quot;z&quot;:9}}&#39;</span>

<span class="go"># Not available for Series</span>
</pre></div>
</div>
<p><strong>Index oriented</strong> (the default for <code class="docutils literal notranslate"><span class="pre">Series</span></code>) similar to column oriented
but the index labels are now primary:</p>
<pre class="literal-block">In [200]: dfjo.to_json(orient=&quot;index&quot;)
Out[200]: '{&quot;x&quot;:{&quot;A&quot;:1,&quot;B&quot;:4,&quot;C&quot;:7},&quot;y&quot;:{&quot;A&quot;:2,&quot;B&quot;:5,&quot;C&quot;:8},&quot;z&quot;:{&quot;A&quot;:3,&quot;B&quot;:6,&quot;C&quot;:9}}'

In [201]: sjo.to_json(orient=&quot;index&quot;)
Out[201]: '{&quot;x&quot;:15,&quot;y&quot;:16,&quot;z&quot;:17}'</pre>
<p><strong>Record oriented</strong> serializes the data to a JSON array of column -&gt; value records,
index labels are not included. This is useful for passing <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> data to plotting
libraries, for example the JavaScript library <code class="docutils literal notranslate"><span class="pre">d3.js</span></code>:</p>
<pre class="literal-block">In [202]: dfjo.to_json(orient=&quot;records&quot;)
Out[202]: '[{&quot;A&quot;:1,&quot;B&quot;:4,&quot;C&quot;:7},{&quot;A&quot;:2,&quot;B&quot;:5,&quot;C&quot;:8},{&quot;A&quot;:3,&quot;B&quot;:6,&quot;C&quot;:9}]'

In [203]: sjo.to_json(orient=&quot;records&quot;)
Out[203]: '[15,16,17]'</pre>
<p><strong>Value oriented</strong> is a bare-bones option which serializes to nested JSON arrays of
values only, column and index labels are not included:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [204]: </span><span class="n">dfjo</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="gh">Out[204]: </span><span class="go">&#39;[[1,4,7],[2,5,8],[3,6,9]]&#39;</span>

<span class="go"># Not available for Series</span>
</pre></div>
</div>
<p><strong>Split oriented</strong> serializes to a JSON object containing separate entries for
values, index and columns. Name is also included for <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<pre class="literal-block">In [205]: dfjo.to_json(orient=&quot;split&quot;)
Out[205]: '{&quot;columns&quot;:[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;],&quot;index&quot;:[&quot;x&quot;,&quot;y&quot;,&quot;z&quot;],&quot;data&quot;:[[1,4,7],[2,5,8],[3,6,9]]}'

In [206]: sjo.to_json(orient=&quot;split&quot;)
Out[206]: '{&quot;name&quot;:&quot;D&quot;,&quot;index&quot;:[&quot;x&quot;,&quot;y&quot;,&quot;z&quot;],&quot;data&quot;:[15,16,17]}'</pre>
<p><strong>Table oriented</strong> serializes to the JSON <a class="reference external" href="https://specs.frictionlessdata.io/json-table-schema/">Table Schema</a>, allowing for the
preservation of metadata including but not limited to dtypes and index names.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Any orient option that encodes to a JSON object will not preserve the ordering of
index and column labels during round-trip serialization. If you wish to preserve
label ordering use the <cite>split</cite> option as it uses ordered containers.</p>
</div>
</div>
<div class="section" id="id1">
<h4>Date Handling<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Writing in ISO date format:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [207]: </span><span class="n">dfd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>

<span class="gp">In [208]: </span><span class="n">dfd</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">)</span>

<span class="gp">In [209]: </span><span class="n">dfd</span> <span class="o">=</span> <span class="n">dfd</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [210]: </span><span class="n">json</span> <span class="o">=</span> <span class="n">dfd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>

<span class="gp">In [211]: </span><span class="n">json</span>
<span class="gh">Out[211]: </span><span class="go">&#39;{&quot;date&quot;:{&quot;0&quot;:&quot;2013-01-01T00:00:00.000Z&quot;,&quot;1&quot;:&quot;2013-01-01T00:00:00.000Z&quot;,&quot;2&quot;:&quot;2013-01-01T00:00:00.000Z&quot;,&quot;3&quot;:&quot;2013-01-01T00:00:00.000Z&quot;,&quot;4&quot;:&quot;2013-01-01T00:00:00.000Z&quot;},&quot;B&quot;:{&quot;0&quot;:2.5656459463,&quot;1&quot;:1.3403088498,&quot;2&quot;:-0.2261692849,&quot;3&quot;:0.8138502857,&quot;4&quot;:-0.8273169356},&quot;A&quot;:{&quot;0&quot;:-1.2064117817,&quot;1&quot;:1.4312559863,&quot;2&quot;:-1.1702987971,&quot;3&quot;:0.4108345112,&quot;4&quot;:0.1320031703}}&#39;</span>
</pre></div>
</div>
<p>Writing in ISO date format, with microseconds:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [212]: </span><span class="n">json</span> <span class="o">=</span> <span class="n">dfd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="n">date_unit</span><span class="o">=</span><span class="s1">&#39;us&#39;</span><span class="p">)</span>

<span class="gp">In [213]: </span><span class="n">json</span>
<span class="gh">Out[213]: </span><span class="go">&#39;{&quot;date&quot;:{&quot;0&quot;:&quot;2013-01-01T00:00:00.000000Z&quot;,&quot;1&quot;:&quot;2013-01-01T00:00:00.000000Z&quot;,&quot;2&quot;:&quot;2013-01-01T00:00:00.000000Z&quot;,&quot;3&quot;:&quot;2013-01-01T00:00:00.000000Z&quot;,&quot;4&quot;:&quot;2013-01-01T00:00:00.000000Z&quot;},&quot;B&quot;:{&quot;0&quot;:2.5656459463,&quot;1&quot;:1.3403088498,&quot;2&quot;:-0.2261692849,&quot;3&quot;:0.8138502857,&quot;4&quot;:-0.8273169356},&quot;A&quot;:{&quot;0&quot;:-1.2064117817,&quot;1&quot;:1.4312559863,&quot;2&quot;:-1.1702987971,&quot;3&quot;:0.4108345112,&quot;4&quot;:0.1320031703}}&#39;</span>
</pre></div>
</div>
<p>Epoch timestamps, in seconds:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [214]: </span><span class="n">json</span> <span class="o">=</span> <span class="n">dfd</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;epoch&#39;</span><span class="p">,</span> <span class="n">date_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="gp">In [215]: </span><span class="n">json</span>
<span class="gh">Out[215]: </span><span class="go">&#39;{&quot;date&quot;:{&quot;0&quot;:1356998400,&quot;1&quot;:1356998400,&quot;2&quot;:1356998400,&quot;3&quot;:1356998400,&quot;4&quot;:1356998400},&quot;B&quot;:{&quot;0&quot;:2.5656459463,&quot;1&quot;:1.3403088498,&quot;2&quot;:-0.2261692849,&quot;3&quot;:0.8138502857,&quot;4&quot;:-0.8273169356},&quot;A&quot;:{&quot;0&quot;:-1.2064117817,&quot;1&quot;:1.4312559863,&quot;2&quot;:-1.1702987971,&quot;3&quot;:0.4108345112,&quot;4&quot;:0.1320031703}}&#39;</span>
</pre></div>
</div>
<p>Writing to a file, with a date index and a date column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [216]: </span><span class="n">dfj2</span> <span class="o">=</span> <span class="n">dfj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [217]: </span><span class="n">dfj2</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">)</span>

<span class="gp">In [218]: </span><span class="n">dfj2</span><span class="p">[</span><span class="s1">&#39;ints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [219]: </span><span class="n">dfj2</span><span class="p">[</span><span class="s1">&#39;bools&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

<span class="gp">In [220]: </span><span class="n">dfj2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [221]: </span><span class="n">dfj2</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">)</span>

<span class="gp">In [222]: </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">   .....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="gp">   .....: </span>
<span class="go">{&quot;A&quot;:{&quot;1356998400000&quot;:-1.2945235903,&quot;1357084800000&quot;:0.2766617129,&quot;1357171200000&quot;:-0.0139597524,&quot;1357257600000&quot;:-0.0061535699,&quot;1357344000000&quot;:0.8957173022},&quot;B&quot;:{&quot;1356998400000&quot;:0.4137381054,&quot;1357084800000&quot;:-0.472034511,&quot;1357171200000&quot;:-0.3625429925,&quot;1357257600000&quot;:-0.923060654,&quot;1357344000000&quot;:0.8052440254},&quot;date&quot;:{&quot;1356998400000&quot;:1356998400000,&quot;1357084800000&quot;:1356998400000,&quot;1357171200000&quot;:1356998400000,&quot;1357257600000&quot;:1356998400000,&quot;1357344000000&quot;:1356998400000},&quot;ints&quot;:{&quot;1356998400000&quot;:0,&quot;1357084800000&quot;:1,&quot;1357171200000&quot;:2,&quot;1357257600000&quot;:3,&quot;1357344000000&quot;:4},&quot;bools&quot;:{&quot;1356998400000&quot;:true,&quot;1357084800000&quot;:true,&quot;1357171200000&quot;:true,&quot;1357257600000&quot;:true,&quot;1357344000000&quot;:true}}</span>
</pre></div>
</div>
</div>
<div class="section" id="fallback-behavior">
<h4>Fallback Behavior<a class="headerlink" href="#fallback-behavior" title="Permalink to this headline">¶</a></h4>
<p>If the JSON serializer cannot handle the container contents directly it will
fall back in the following manner:</p>
<ul>
<li><p>if the dtype is unsupported (e.g. <code class="docutils literal notranslate"><span class="pre">np.complex</span></code>) then the <code class="docutils literal notranslate"><span class="pre">default_handler</span></code>, if provided, will be called
for each value, otherwise an exception is raised.</p></li>
<li><p>if an object is unsupported it will attempt the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>check if the object has defined a <code class="docutils literal notranslate"><span class="pre">toDict</span></code> method and call it.
A <code class="docutils literal notranslate"><span class="pre">toDict</span></code> method should return a <code class="docutils literal notranslate"><span class="pre">dict</span></code> which will then be JSON serialized.</p></li>
<li><p>invoke the <code class="docutils literal notranslate"><span class="pre">default_handler</span></code> if one was provided.</p></li>
<li><p>convert the object to a <code class="docutils literal notranslate"><span class="pre">dict</span></code> by traversing its contents. However this will often fail
with an <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> or give unexpected results.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>In general the best approach for unsupported objects or dtypes is to provide a <code class="docutils literal notranslate"><span class="pre">default_handler</span></code>.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DataFrame</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)])</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>  <span class="c1"># raises</span>
<span class="go">RuntimeError: Unhandled numpy dtype 15</span>
</pre></div>
</div>
<p>can be dealt with by specifying a simple <code class="docutils literal notranslate"><span class="pre">default_handler</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [223]: </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)])</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">default_handler</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="gh">Out[223]: </span><span class="go">&#39;{&quot;0&quot;:{&quot;0&quot;:&quot;(1+0j)&quot;,&quot;1&quot;:&quot;(2+0j)&quot;,&quot;2&quot;:&quot;(1+2j)&quot;}}&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-json">
<span id="io-json-reader"></span><h3>Reading JSON<a class="headerlink" href="#reading-json" title="Permalink to this headline">¶</a></h3>
<p>Reading a JSON string to pandas object can take a number of parameters.
The parser will try to parse a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> if <code class="docutils literal notranslate"><span class="pre">typ</span></code> is not supplied or
is <code class="docutils literal notranslate"><span class="pre">None</span></code>. To explicitly force <code class="docutils literal notranslate"><span class="pre">Series</span></code> parsing, pass <code class="docutils literal notranslate"><span class="pre">typ=series</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">filepath_or_buffer</span></code> : a <strong>VALID</strong> JSON string or file handle / StringIO. The string could be
a URL. Valid URL schemes include http, ftp, S3, and file. For file URLs, a host
is expected. For instance, a local file could be
file ://localhost/path/to/table.json</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typ</span></code>    : type of object to recover (series or frame), default ‘frame’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orient</span></code> :</p>
<dl class="simple">
<dt>Series :</dt><dd><ul class="simple">
<li><p>default is <code class="docutils literal notranslate"><span class="pre">index</span></code></p></li>
<li><p>allowed values are {<code class="docutils literal notranslate"><span class="pre">split</span></code>, <code class="docutils literal notranslate"><span class="pre">records</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>}</p></li>
</ul>
</dd>
<dt>DataFrame</dt><dd><ul class="simple">
<li><p>default is <code class="docutils literal notranslate"><span class="pre">columns</span></code></p></li>
<li><p>allowed values are {<code class="docutils literal notranslate"><span class="pre">split</span></code>, <code class="docutils literal notranslate"><span class="pre">records</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">columns</span></code>, <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">table</span></code>}</p></li>
</ul>
</dd>
</dl>
<p>The format of the JSON string</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">split</span></code></p></td>
<td><p>dict like {index -&gt; [index], columns -&gt; [columns], data -&gt; [values]}</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">records</span></code></p></td>
<td><p>list like [{column -&gt; value}, … , {column -&gt; value}]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">index</span></code></p></td>
<td><p>dict like {index -&gt; {column -&gt; value}}</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">columns</span></code></p></td>
<td><p>dict like {column -&gt; {index -&gt; value}}</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
<td><p>just the values array</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">table</span></code></p></td>
<td><p>adhering to the JSON <a class="reference external" href="https://specs.frictionlessdata.io/json-table-schema/">Table Schema</a></p></td>
</tr>
</tbody>
</table>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> : if True, infer dtypes, if a dict of column to dtype, then use those, if <code class="docutils literal notranslate"><span class="pre">False</span></code>, then don’t infer dtypes at all, default is True, apply only to the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convert_axes</span></code> : boolean, try to convert the axes to the proper dtypes, default is <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convert_dates</span></code> : a list of columns to parse for dates; If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then try to parse date-like columns, default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep_default_dates</span></code> : boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code>. If parsing dates, then parse the default date-like columns.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> : direct decoding to NumPy arrays. default is <code class="docutils literal notranslate"><span class="pre">False</span></code>;
Supports numeric data only, although labels may be non-numeric. Also note that the JSON ordering <strong>MUST</strong> be the same for each term if <code class="docutils literal notranslate"><span class="pre">numpy=True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precise_float</span></code> : boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code>. Set to enable usage of higher precision (strtod) function when decoding string to double values. Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>) is to use fast but less precise builtin functionality.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_unit</span></code> : string, the timestamp unit to detect if converting dates. Default
None. By default the timestamp precision will be detected, if this is not desired
then pass one of ‘s’, ‘ms’, ‘us’ or ‘ns’ to force timestamp precision to
seconds, milliseconds, microseconds or nanoseconds respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lines</span></code> : reads file as one json object per line.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encoding</span></code> : The encoding to use to decode py3 bytes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunksize</span></code> : when used in combination with <code class="docutils literal notranslate"><span class="pre">lines=True</span></code>, return a JsonReader which reads in <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> lines per iteration.</p></li>
</ul>
<p>The parser will raise one of <code class="docutils literal notranslate"><span class="pre">ValueError/TypeError/AssertionError</span></code> if the JSON is not parseable.</p>
<p>If a non-default <code class="docutils literal notranslate"><span class="pre">orient</span></code> was used when encoding to JSON be sure to pass the same
option here so that decoding produces sensible results, see <a class="reference internal" href="#orient-options">Orient Options</a> for an
overview.</p>
<div class="section" id="data-conversion">
<h4>Data Conversion<a class="headerlink" href="#data-conversion" title="Permalink to this headline">¶</a></h4>
<p>The default of <code class="docutils literal notranslate"><span class="pre">convert_axes=True</span></code>, <code class="docutils literal notranslate"><span class="pre">dtype=True</span></code>, and <code class="docutils literal notranslate"><span class="pre">convert_dates=True</span></code>
will try to parse the axes, and all of the data into appropriate types,
including dates. If you need to override specific dtypes, pass a dict to
<code class="docutils literal notranslate"><span class="pre">dtype</span></code>. <code class="docutils literal notranslate"><span class="pre">convert_axes</span></code> should only be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if you need to
preserve string-like numbers (e.g. ‘1’, ‘2’) in an axes.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Large integer values may be converted to dates if <code class="docutils literal notranslate"><span class="pre">convert_dates=True</span></code> and the data and / or column labels appear ‘date-like’. The exact threshold depends on the <code class="docutils literal notranslate"><span class="pre">date_unit</span></code> specified. ‘date-like’ means that the column label meets one of the following criteria:</p>
<blockquote>
<div><ul class="simple">
<li><p>it ends with <code class="docutils literal notranslate"><span class="pre">'_at'</span></code></p></li>
<li><p>it ends with <code class="docutils literal notranslate"><span class="pre">'_time'</span></code></p></li>
<li><p>it begins with <code class="docutils literal notranslate"><span class="pre">'timestamp'</span></code></p></li>
<li><p>it is <code class="docutils literal notranslate"><span class="pre">'modified'</span></code></p></li>
<li><p>it is <code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
</ul>
</div></blockquote>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>When reading JSON data, automatic coercing into dtypes has some quirks:</p>
<blockquote>
<div><ul class="simple">
<li><p>an index can be reconstructed in a different order from serialization, that is, the returned order is not guaranteed to be the same as before serialization</p></li>
<li><p>a column that was <code class="docutils literal notranslate"><span class="pre">float</span></code> data will be converted to <code class="docutils literal notranslate"><span class="pre">integer</span></code> if it can be done safely, e.g. a column of <code class="docutils literal notranslate"><span class="pre">1.</span></code></p></li>
<li><p>bool columns will be converted to <code class="docutils literal notranslate"><span class="pre">integer</span></code> on reconstruction</p></li>
</ul>
</div></blockquote>
<p>Thus there are times where you may want to specify specific dtypes via the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword argument.</p>
</div>
<p>Reading from a JSON string:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [224]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
<span class="gh">Out[224]: </span><span class="go"></span>
<span class="go">        date         B         A</span>
<span class="go">0 2013-01-01  2.565646 -1.206412</span>
<span class="go">1 2013-01-01  1.340309  1.431256</span>
<span class="go">2 2013-01-01 -0.226169 -1.170299</span>
<span class="go">3 2013-01-01  0.813850  0.410835</span>
<span class="go">4 2013-01-01 -0.827317  0.132003</span>
</pre></div>
</div>
<p>Reading from a file:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [225]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">)</span>
<span class="gh">Out[225]: </span><span class="go"></span>
<span class="go">                   A         B       date  ints  bools</span>
<span class="go">2013-01-01 -1.294524  0.413738 2013-01-01     0   True</span>
<span class="go">2013-01-02  0.276662 -0.472035 2013-01-01     1   True</span>
<span class="go">2013-01-03 -0.013960 -0.362543 2013-01-01     2   True</span>
<span class="go">2013-01-04 -0.006154 -0.923061 2013-01-01     3   True</span>
<span class="go">2013-01-05  0.895717  0.805244 2013-01-01     4   True</span>
</pre></div>
</div>
<p>Don’t convert any data (but still convert axes and dates):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [226]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[226]: </span><span class="go"></span>
<span class="go">A        object</span>
<span class="go">B        object</span>
<span class="go">date     object</span>
<span class="go">ints     object</span>
<span class="go">bools    object</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>Specify dtypes for conversion:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [227]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="s1">&#39;bools&#39;</span><span class="p">:</span> <span class="s1">&#39;int8&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[227]: </span><span class="go"></span>
<span class="go">A               float32</span>
<span class="go">B               float64</span>
<span class="go">date     datetime64[ns]</span>
<span class="go">ints              int64</span>
<span class="go">bools              int8</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>Preserve string indices:</p>
<pre class="literal-block">In [228]: si = pd.DataFrame(np.zeros((4, 4)), columns=list(range(4)),
   .....:                   index=[str(i) for i in range(4)])
   .....: 

In [229]: si
Out[229]: 
     0    1    2    3
0  0.0  0.0  0.0  0.0
1  0.0  0.0  0.0  0.0
2  0.0  0.0  0.0  0.0
3  0.0  0.0  0.0  0.0

In [230]: si.index
Out[230]: Index(['0', '1', '2', '3'], dtype='object')

In [231]: si.columns
Out[231]: Int64Index([0, 1, 2, 3], dtype='int64')

In [232]: json = si.to_json()

In [233]: sij = pd.read_json(json, convert_axes=False)

In [234]: sij
Out[234]: 
   0  1  2  3
0  0  0  0  0
1  0  0  0  0
2  0  0  0  0
3  0  0  0  0

In [235]: sij.index
Out[235]: Index(['0', '1', '2', '3'], dtype='object')

In [236]: sij.columns
Out[236]: Index(['0', '1', '2', '3'], dtype='object')</pre>
<p>Dates written in nanoseconds need to be read back in nanoseconds:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [237]: </span><span class="n">json</span> <span class="o">=</span> <span class="n">dfj2</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">date_unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>

<span class="go"># Try to parse timestamps as millseconds -&gt; Won&#39;t Work</span>
<span class="gp">In [238]: </span><span class="n">dfju</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">date_unit</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>

<span class="gp">In [239]: </span><span class="n">dfju</span>
<span class="gh">Out[239]: </span><span class="go"></span>
<span class="go">                            A         B                 date  ints  bools</span>
<span class="go">1356998400000000000 -1.294524  0.413738  1356998400000000000     0   True</span>
<span class="go">1357084800000000000  0.276662 -0.472035  1356998400000000000     1   True</span>
<span class="go">1357171200000000000 -0.013960 -0.362543  1356998400000000000     2   True</span>
<span class="go">1357257600000000000 -0.006154 -0.923061  1356998400000000000     3   True</span>
<span class="go">1357344000000000000  0.895717  0.805244  1356998400000000000     4   True</span>

<span class="go"># Let pandas detect the correct precision</span>
<span class="gp">In [240]: </span><span class="n">dfju</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>

<span class="gp">In [241]: </span><span class="n">dfju</span>
<span class="gh">Out[241]: </span><span class="go"></span>
<span class="go">                   A         B       date  ints  bools</span>
<span class="go">2013-01-01 -1.294524  0.413738 2013-01-01     0   True</span>
<span class="go">2013-01-02  0.276662 -0.472035 2013-01-01     1   True</span>
<span class="go">2013-01-03 -0.013960 -0.362543 2013-01-01     2   True</span>
<span class="go">2013-01-04 -0.006154 -0.923061 2013-01-01     3   True</span>
<span class="go">2013-01-05  0.895717  0.805244 2013-01-01     4   True</span>

<span class="go"># Or specify that all timestamps are in nanoseconds</span>
<span class="gp">In [242]: </span><span class="n">dfju</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">date_unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>

<span class="gp">In [243]: </span><span class="n">dfju</span>
<span class="gh">Out[243]: </span><span class="go"></span>
<span class="go">                   A         B       date  ints  bools</span>
<span class="go">2013-01-01 -1.294524  0.413738 2013-01-01     0   True</span>
<span class="go">2013-01-02  0.276662 -0.472035 2013-01-01     1   True</span>
<span class="go">2013-01-03 -0.013960 -0.362543 2013-01-01     2   True</span>
<span class="go">2013-01-04 -0.006154 -0.923061 2013-01-01     3   True</span>
<span class="go">2013-01-05  0.895717  0.805244 2013-01-01     4   True</span>
</pre></div>
</div>
</div>
<div class="section" id="the-numpy-parameter">
<h4>The Numpy Parameter<a class="headerlink" href="#the-numpy-parameter" title="Permalink to this headline">¶</a></h4>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>This supports numeric data only. Index and columns labels may be non-numeric, e.g. strings, dates etc.</p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">numpy=True</span></code> is passed to <code class="docutils literal notranslate"><span class="pre">read_json</span></code> an attempt will be made to sniff
an appropriate dtype during deserialization and to subsequently decode directly
to NumPy arrays, bypassing the need for intermediate Python objects.</p>
<p>This can provide speedups if you are deserialising a large amount of numeric
data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [244]: </span><span class="n">randfloats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="gp">In [245]: </span><span class="n">randfloats</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">In [246]: </span><span class="n">dffloats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">randfloats</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGHIJ&#39;</span><span class="p">))</span>

<span class="gp">In [247]: </span><span class="n">jsonfloats</span> <span class="o">=</span> <span class="n">dffloats</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [248]: </span><span class="o">%</span><span class="k">timeit</span> pd.read_json(jsonfloats)
<span class="go">11.9 ms +- 119 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [249]: </span><span class="o">%</span><span class="k">timeit</span> pd.read_json(jsonfloats, numpy=True)
<span class="go">8.56 ms +- 108 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
</pre></div>
</div>
<p>The speedup is less noticeable for smaller datasets:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [250]: </span><span class="n">jsonfloats</span> <span class="o">=</span> <span class="n">dffloats</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [251]: </span><span class="o">%</span><span class="k">timeit</span> pd.read_json(jsonfloats)
<span class="go">7.79 ms +- 128 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [252]: </span><span class="o">%</span><span class="k">timeit</span> pd.read_json(jsonfloats, numpy=True)
<span class="go">6.84 ms +- 120 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Direct NumPy decoding makes a number of assumptions and may fail or produce
unexpected output if these assumptions are not satisfied:</p>
<blockquote>
<div><ul class="simple">
<li><p>data is numeric.</p></li>
<li><p>data is uniform. The dtype is sniffed from the first value decoded.
A <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> may be raised, or incorrect output may be produced
if this condition is not satisfied.</p></li>
<li><p>labels are ordered. Labels are only read from the first container, it is assumed
that each subsequent row / column has been encoded in the same order. This should be satisfied if the
data was encoded using <code class="docutils literal notranslate"><span class="pre">to_json</span></code> but may not be the case if the JSON
is from another source.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="normalization">
<span id="io-json-normalize"></span><h3>Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline">¶</a></h3>
<p>pandas provides a utility function to take a dict or list of dicts and <em>normalize</em> this semi-structured data
into a flat table.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [253]: </span><span class="kn">from</span> <span class="nn">pandas.io.json</span> <span class="kn">import</span> <span class="n">json_normalize</span>

<span class="gp">In [254]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="s1">&#39;Coleen&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span> <span class="s1">&#39;Volk&#39;</span><span class="p">}},</span>
<span class="gp">   .....: </span>        <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;given&#39;</span><span class="p">:</span> <span class="s1">&#39;Mose&#39;</span><span class="p">,</span> <span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;Regner&#39;</span><span class="p">}},</span>
<span class="gp">   .....: </span>        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Faye Raker&#39;</span><span class="p">}]</span>
<span class="gp">   .....: </span>

<span class="gp">In [255]: </span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gh">Out[255]: </span><span class="go"></span>
<span class="go">    id name.first name.last name.given name.family        name</span>
<span class="go">0  1.0     Coleen      Volk        NaN         NaN         NaN</span>
<span class="go">1  NaN        NaN       NaN       Mose      Regner         NaN</span>
<span class="go">2  2.0        NaN       NaN        NaN         NaN  Faye Raker</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [256]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="s1">&#39;Florida&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;governor&#39;</span><span class="p">:</span> <span class="s1">&#39;Rick Scott&#39;</span><span class="p">},</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;counties&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dade&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">},</span>
<span class="gp">   .....: </span>                      <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Broward&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="mi">40000</span><span class="p">},</span>
<span class="gp">   .....: </span>                      <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Palm Beach&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="mi">60000</span><span class="p">}]},</span>
<span class="gp">   .....: </span>        <span class="p">{</span><span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;governor&#39;</span><span class="p">:</span> <span class="s1">&#39;John Kasich&#39;</span><span class="p">},</span>
<span class="gp">   .....: </span>         <span class="s1">&#39;counties&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Summit&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="mi">1234</span><span class="p">},</span>
<span class="gp">   .....: </span>                      <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuyahoga&#39;</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="mi">1337</span><span class="p">}]}]</span>
<span class="gp">   .....: </span>

<span class="gp">In [257]: </span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;counties&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;shortname&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;governor&#39;</span><span class="p">]])</span>
<span class="gh">Out[257]: </span><span class="go"></span>
<span class="go">         name  population    state shortname info.governor</span>
<span class="go">0        Dade       12345  Florida        FL    Rick Scott</span>
<span class="go">1     Broward       40000  Florida        FL    Rick Scott</span>
<span class="go">2  Palm Beach       60000  Florida        FL    Rick Scott</span>
<span class="go">3      Summit        1234     Ohio        OH   John Kasich</span>
<span class="go">4    Cuyahoga        1337     Ohio        OH   John Kasich</span>
</pre></div>
</div>
</div>
<div class="section" id="line-delimited-json">
<span id="io-jsonl"></span><h3>Line delimited json<a class="headerlink" href="#line-delimited-json" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
<p>pandas is able to read and write line-delimited json files that are common in data processing pipelines
using Hadoop or Spark.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.0.</span></p>
</div>
<p>For line-delimited json files, pandas can also return an iterator which reads in <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> lines at a time. This can be useful for large files or to read from a stream.</p>
<pre class="literal-block">In [258]: jsonl = '''
   .....:     {&quot;a&quot;: 1, &quot;b&quot;: 2}
   .....:     {&quot;a&quot;: 3, &quot;b&quot;: 4}
   .....: '''
   .....: 

In [259]: df = pd.read_json(jsonl, lines=True)

In [260]: df
Out[260]: 
   a  b
0  1  2
1  3  4

In [261]: df.to_json(orient='records', lines=True)
Out[261]: '{&quot;a&quot;:1,&quot;b&quot;:2}\n{&quot;a&quot;:3,&quot;b&quot;:4}'

# reader is an iterator that returns `chunksize` lines each iteration
In [262]: reader = pd.read_json(StringIO(jsonl), lines=True, chunksize=1)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-262-7d55b117421e&gt; in &lt;module&gt;
----&gt; 1 reader = pd.read_json(StringIO(jsonl), lines=True, chunksize=1)

NameError: name 'StringIO' is not defined

In [263]: reader
Out[263]: &lt;pandas.io.parsers.TextFileReader at 0x7f4bc3461590&gt;

In [264]: for chunk in reader:
   .....:     print(chunk)
   .....: 
  Unnamed: 0         0         1         2         3
5           5 -0.673690  0.113648 -1.478427  0.524988
6           6  0.404705  0.577046 -1.715002 -1.039268
7           7 -0.370647 -1.157892 -1.344312  0.844885
8           8  1.075770 -0.109050  1.643563 -1.469388
9           9  0.357021 -0.674600 -1.776904 -0.968914</pre>
</div>
<div class="section" id="table-schema">
<span id="io-table-schema"></span><h3>Table Schema<a class="headerlink" href="#table-schema" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p><a class="reference external" href="https://specs.frictionlessdata.io/json-table-schema/">Table Schema</a> is a spec for describing tabular datasets as a JSON
object. The JSON includes information on the field names, types, and
other attributes. You can use the orient <code class="docutils literal notranslate"><span class="pre">table</span></code> to build
a JSON string with two fields, <code class="docutils literal notranslate"><span class="pre">schema</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<pre class="literal-block">In [265]: df = pd.DataFrame({'A': [1, 2, 3],
   .....:                    'B': ['a', 'b', 'c'],
   .....:                    'C': pd.date_range('2016-01-01', freq='d', periods=3)},
   .....:                   index=pd.Index(range(3), name='idx'))
   .....: 

In [266]: df
Out[266]: 
     A  B          C
idx                 
0    1  a 2016-01-01
1    2  b 2016-01-02
2    3  c 2016-01-03

In [267]: df.to_json(orient='table', date_format=&quot;iso&quot;)
Out[267]: '{&quot;schema&quot;: {&quot;fields&quot;:[{&quot;name&quot;:&quot;idx&quot;,&quot;type&quot;:&quot;integer&quot;},{&quot;name&quot;:&quot;A&quot;,&quot;type&quot;:&quot;integer&quot;},{&quot;name&quot;:&quot;B&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;C&quot;,&quot;type&quot;:&quot;datetime&quot;}],&quot;primaryKey&quot;:[&quot;idx&quot;],&quot;pandas_version&quot;:&quot;0.20.0&quot;}, &quot;data&quot;: [{&quot;idx&quot;:0,&quot;A&quot;:1,&quot;B&quot;:&quot;a&quot;,&quot;C&quot;:&quot;2016-01-01T00:00:00.000Z&quot;},{&quot;idx&quot;:1,&quot;A&quot;:2,&quot;B&quot;:&quot;b&quot;,&quot;C&quot;:&quot;2016-01-02T00:00:00.000Z&quot;},{&quot;idx&quot;:2,&quot;A&quot;:3,&quot;B&quot;:&quot;c&quot;,&quot;C&quot;:&quot;2016-01-03T00:00:00.000Z&quot;}]}'</pre>
<p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> field contains the <code class="docutils literal notranslate"><span class="pre">fields</span></code> key, which itself contains
a list of column name to type pairs, including the <code class="docutils literal notranslate"><span class="pre">Index</span></code> or <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>
(see below for a list of types).
The <code class="docutils literal notranslate"><span class="pre">schema</span></code> field also contains a <code class="docutils literal notranslate"><span class="pre">primaryKey</span></code> field if the (Multi)index
is unique.</p>
<p>The second field, <code class="docutils literal notranslate"><span class="pre">data</span></code>, contains the serialized data with the <code class="docutils literal notranslate"><span class="pre">records</span></code>
orient.
The index is included, and any datetimes are ISO 8601 formatted, as required
by the Table Schema spec.</p>
<p>The full list of types supported are described in the Table Schema
spec. This table shows the mapping from pandas types:</p>
<table class="table">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Pandas type</p></th>
<th class="head"><p>Table Schema type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int64</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p>float64</p></td>
<td><p>number</p></td>
</tr>
<tr class="row-even"><td><p>bool</p></td>
<td><p>boolean</p></td>
</tr>
<tr class="row-odd"><td><p>datetime64[ns]</p></td>
<td><p>datetime</p></td>
</tr>
<tr class="row-even"><td><p>timedelta64[ns]</p></td>
<td><p>duration</p></td>
</tr>
<tr class="row-odd"><td><p>categorical</p></td>
<td><p>any</p></td>
</tr>
<tr class="row-even"><td><p>object</p></td>
<td><p>str</p></td>
</tr>
</tbody>
</table>
<p>A few notes on the generated table schema:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> object contains a <code class="docutils literal notranslate"><span class="pre">pandas_version</span></code> field. This contains
the version of pandas’ dialect of the schema, and will be incremented
with each revision.</p></li>
<li><p>All dates are converted to UTC when serializing. Even timezone naive values,
which are treated as UTC with an offset of 0.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [268]: </span><span class="kn">from</span> <span class="nn">pandas.io.json</span> <span class="kn">import</span> <span class="n">build_table_schema</span>

<span class="gp">In [269]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">In [270]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gh">Out[270]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;index&#39;, &#39;type&#39;: &#39;integer&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;, &#39;type&#39;: &#39;datetime&#39;}],</span>
<span class="go"> &#39;primaryKey&#39;: [&#39;index&#39;],</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>datetimes with a timezone (before serializing), include an additional field
<code class="docutils literal notranslate"><span class="pre">tz</span></code> with the time zone name (e.g. <code class="docutils literal notranslate"><span class="pre">'US/Central'</span></code>).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [271]: </span><span class="n">s_tz</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="gp">   .....: </span>                               <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;US/Central&#39;</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [272]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s_tz</span><span class="p">)</span>
<span class="gh">Out[272]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;index&#39;, &#39;type&#39;: &#39;integer&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;, &#39;type&#39;: &#39;datetime&#39;, &#39;tz&#39;: &#39;US/Central&#39;}],</span>
<span class="go"> &#39;primaryKey&#39;: [&#39;index&#39;],</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>Periods are converted to timestamps before serialization, and so have the
same behavior of being converted to UTC. In addition, periods will contain
and additional field <code class="docutils literal notranslate"><span class="pre">freq</span></code> with the period’s frequency, e.g. <code class="docutils literal notranslate"><span class="pre">'A-DEC'</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [273]: </span><span class="n">s_per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;A-DEC&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                           <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [274]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s_per</span><span class="p">)</span>
<span class="gh">Out[274]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;index&#39;, &#39;type&#39;: &#39;datetime&#39;, &#39;freq&#39;: &#39;A-DEC&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;, &#39;type&#39;: &#39;integer&#39;}],</span>
<span class="go"> &#39;primaryKey&#39;: [&#39;index&#39;],</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>Categoricals use the <code class="docutils literal notranslate"><span class="pre">any</span></code> type and an <code class="docutils literal notranslate"><span class="pre">enum</span></code> constraint listing
the set of possible values. Additionally, an <code class="docutils literal notranslate"><span class="pre">ordered</span></code> field is included:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [275]: </span><span class="n">s_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]))</span>

<span class="gp">In [276]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s_cat</span><span class="p">)</span>
<span class="gh">Out[276]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;index&#39;, &#39;type&#39;: &#39;integer&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;,</span>
<span class="go">   &#39;type&#39;: &#39;any&#39;,</span>
<span class="go">   &#39;constraints&#39;: {&#39;enum&#39;: [&#39;a&#39;, &#39;b&#39;]},</span>
<span class="go">   &#39;ordered&#39;: False}],</span>
<span class="go"> &#39;primaryKey&#39;: [&#39;index&#39;],</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">primaryKey</span></code> field, containing an array of labels, is included
<em>if the index is unique</em>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [277]: </span><span class="n">s_dupe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="gp">In [278]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s_dupe</span><span class="p">)</span>
<span class="gh">Out[278]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;index&#39;, &#39;type&#39;: &#39;integer&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;, &#39;type&#39;: &#39;integer&#39;}],</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">primaryKey</span></code> behavior is the same with MultiIndexes, but in this
case the <code class="docutils literal notranslate"><span class="pre">primaryKey</span></code> is an array:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [279]: </span><span class="n">s_multi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                                                         <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]))</span>
<span class="gp">   .....: </span>

<span class="gp">In [280]: </span><span class="n">build_table_schema</span><span class="p">(</span><span class="n">s_multi</span><span class="p">)</span>
<span class="gh">Out[280]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: [{&#39;name&#39;: &#39;level_0&#39;, &#39;type&#39;: &#39;string&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;level_1&#39;, &#39;type&#39;: &#39;integer&#39;},</span>
<span class="go">  {&#39;name&#39;: &#39;values&#39;, &#39;type&#39;: &#39;integer&#39;}],</span>
<span class="go"> &#39;primaryKey&#39;: FrozenList([&#39;level_0&#39;, &#39;level_1&#39;]),</span>
<span class="go"> &#39;pandas_version&#39;: &#39;0.20.0&#39;}</span>
</pre></div>
</div>
</li>
<li><p>The default naming roughly follows these rules:</p>
<blockquote>
<div><ul class="simple">
<li><p>For series, the <code class="docutils literal notranslate"><span class="pre">object.name</span></code> is used. If that’s none, then the
name is <code class="docutils literal notranslate"><span class="pre">values</span></code></p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>, the stringified version of the column name is used</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Index</span></code> (not <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>), <code class="docutils literal notranslate"><span class="pre">index.name</span></code> is used, with a
fallback to <code class="docutils literal notranslate"><span class="pre">index</span></code> if that is None.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, <code class="docutils literal notranslate"><span class="pre">mi.names</span></code> is used. If any level has no name,
then <code class="docutils literal notranslate"><span class="pre">level_&lt;i&gt;</span></code> is used.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.23.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">read_json</span></code> also accepts <code class="docutils literal notranslate"><span class="pre">orient='table'</span></code> as an argument. This allows for
the preservation of metadata such as dtypes and index names in a
round-trippable manner.</p>
<blockquote>
<div><pre class="literal-block">In [281]: df = pd.DataFrame({'foo': [1, 2, 3, 4],
   .....:                    'bar': ['a', 'b', 'c', 'd'],
   .....:                    'baz': pd.date_range('2018-01-01', freq='d', periods=4),
   .....:                    'qux': pd.Categorical(['a', 'b', 'c', 'c'])
   .....:                    }, index=pd.Index(range(4), name='idx'))
   .....: 

In [282]: df
Out[282]: 
     foo bar        baz qux
idx                        
0      1   a 2018-01-01   a
1      2   b 2018-01-02   b
2      3   c 2018-01-03   c
3      4   d 2018-01-04   c

In [283]: df.dtypes
Out[283]: 
foo             int64
bar            object
baz    datetime64[ns]
qux          category
dtype: object

In [284]: df.to_json('test.json', orient='table')

In [285]: new_df = pd.read_json('test.json', orient='table')

In [286]: new_df
Out[286]: 
     foo bar        baz qux
idx                        
0      1   a 2018-01-01   a
1      2   b 2018-01-02   b
2      3   c 2018-01-03   c
3      4   d 2018-01-04   c

In [287]: new_df.dtypes
Out[287]: 
foo             int64
bar            object
baz    datetime64[ns]
qux          category
dtype: object</pre>
</div></blockquote>
<p>Please note that the literal string ‘index’ as the name of an <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code>
is not round-trippable, nor are any names beginning with <code class="docutils literal notranslate"><span class="pre">'level_'</span></code> within a
<code class="xref py py-class docutils literal notranslate"><span class="pre">MultiIndex</span></code>. These are used by default in <a class="reference internal" href="../reference/api/pandas.DataFrame.to_json.html#pandas.DataFrame.to_json" title="pandas.DataFrame.to_json"><code class="xref py py-func docutils literal notranslate"><span class="pre">DataFrame.to_json()</span></code></a> to
indicate missing values and the subsequent read cannot distinguish the intent.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [288]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>

<span class="gp">In [289]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>

<span class="gp">In [290]: </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;test.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>

<span class="gp">In [291]: </span><span class="k">print</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="html">
<h2>HTML<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reading-html-content">
<span id="io-read-html"></span><h3>Reading HTML Content<a class="headerlink" href="#reading-html-content" title="Permalink to this headline">¶</a></h3>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>We <strong>highly encourage</strong> you to read the <a class="reference internal" href="#io-html-gotchas"><span class="std std-ref">HTML Table Parsing gotchas</span></a>
below regarding the issues surrounding the BeautifulSoup4/html5lib/lxml parsers.</p>
</div>
<p>The top-level <code class="xref py py-func docutils literal notranslate"><span class="pre">read_html()</span></code> function can accept an HTML
string/file/URL and will parse HTML tables into list of pandas <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>.
Let’s look at a few examples.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">read_html</span></code> returns a <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, even if there is
only a single table contained in the HTML content.</p>
</div>
<p>Read a URL with no options:</p>
<pre class="literal-block">In [292]: url = 'https://www.fdic.gov/bank/individual/failed/banklist.html'

In [293]: dfs = pd.read_html(url)
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-293-fafba0f26e7e&gt; in &lt;module&gt;
----&gt; 1 dfs = pd.read_html(url)

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in read_html(io, match, flavor, header, index_col, skiprows, attrs, parse_dates, thousands, encoding, decimal, converters, na_values, keep_default_na, displayed_only)
   1103         na_values=na_values,
   1104         keep_default_na=keep_default_na,
-&gt; 1105         displayed_only=displayed_only,
   1106     )

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in _parse(flavor, io, match, attrs, encoding, displayed_only, **kwargs)
    886     retained = None
    887     for flav in flavor:
--&gt; 888         parser = _parser_dispatch(flav)
    889         p = parser(io, compiled_match, attrs, encoding, displayed_only)
    890 

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in _parser_dispatch(flavor)
    841     else:
    842         if not _HAS_LXML:
--&gt; 843             raise ImportError(&quot;lxml not found, please install it&quot;)
    844     return _valid_parsers[flavor]
    845 

ImportError: lxml not found, please install it

In [294]: dfs
Out[294]: 
(  Case      Data
 0    A  0.276232
 1    A -1.087401
 2    A -0.673690
 3    B  0.113648,   Case      Data
 4    A -1.478427
 5    A  0.524988
 6    B  0.404705,   Case      Data
 7    A  0.577046
 8    A -1.715002)</pre>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The data from the above URL changes every Monday so the resulting data above
and the data below may be slightly different.</p>
</div>
<p>Read in the content of the file from the above URL and pass it to <code class="docutils literal notranslate"><span class="pre">read_html</span></code>
as a string:</p>
<pre class="literal-block">In [295]: with open(file_path, 'r') as f:
   .....:     dfs = pd.read_html(f.read())
   .....: 
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-295-088a5feb8d3b&gt; in &lt;module&gt;
      1 with open(file_path, 'r') as f:
----&gt; 2     dfs = pd.read_html(f.read())

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in read_html(io, match, flavor, header, index_col, skiprows, attrs, parse_dates, thousands, encoding, decimal, converters, na_values, keep_default_na, displayed_only)
   1103         na_values=na_values,
   1104         keep_default_na=keep_default_na,
-&gt; 1105         displayed_only=displayed_only,
   1106     )

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in _parse(flavor, io, match, attrs, encoding, displayed_only, **kwargs)
    886     retained = None
    887     for flav in flavor:
--&gt; 888         parser = _parser_dispatch(flav)
    889         p = parser(io, compiled_match, attrs, encoding, displayed_only)
    890 

~/miniconda/lib/python3.7/site-packages/pandas/io/html.py in _parser_dispatch(flavor)
    841     else:
    842         if not _HAS_LXML:
--&gt; 843             raise ImportError(&quot;lxml not found, please install it&quot;)
    844     return _valid_parsers[flavor]
    845 

ImportError: lxml not found, please install it

In [296]: dfs
Out[296]: 
(  Case      Data
 0    A  0.276232
 1    A -1.087401
 2    A -0.673690
 3    B  0.113648,   Case      Data
 4    A -1.478427
 5    A  0.524988
 6    B  0.404705,   Case      Data
 7    A  0.577046
 8    A -1.715002)</pre>
<p>You can even pass in an instance of <code class="docutils literal notranslate"><span class="pre">StringIO</span></code> if you so desire:</p>
<pre class="literal-block">In [297]: with open(file_path, 'r') as f:
   .....:     sio = StringIO(f.read())
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-297-f7178f240fc5&gt; in &lt;module&gt;
      1 with open(file_path, 'r') as f:
----&gt; 2     sio = StringIO(f.read())

NameError: name 'StringIO' is not defined

In [298]: dfs = pd.read_html(sio)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-298-b11088569efd&gt; in &lt;module&gt;
----&gt; 1 dfs = pd.read_html(sio)

NameError: name 'sio' is not defined

In [299]: dfs
Out[299]: 
(  Case      Data
 0    A  0.276232
 1    A -1.087401
 2    A -0.673690
 3    B  0.113648,   Case      Data
 4    A -1.478427
 5    A  0.524988
 6    B  0.404705,   Case      Data
 7    A  0.577046
 8    A -1.715002)</pre>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The following examples are not run by the IPython evaluator due to the fact
that having so many network-accessing functions slows down the documentation
build. If you spot an error or an example that doesn’t run, please do not
hesitate to report it over on <a class="reference external" href="https://www.github.com/pandas-dev/pandas/issues">pandas GitHub issues page</a>.</p>
</div>
<p>Read a URL and match a table that contains specific text:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Metcalf Bank&#39;</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="n">match</span><span class="p">)</span>
</pre></div>
</div>
<p>Specify a header row (by default <code class="docutils literal notranslate"><span class="pre">&lt;th&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;td&gt;</span></code> elements located within a
<code class="docutils literal notranslate"><span class="pre">&lt;thead&gt;</span></code> are used to form the column index, if multiple rows are contained within
<code class="docutils literal notranslate"><span class="pre">&lt;thead&gt;</span></code> then a MultiIndex is created); if specified, the header row is taken
from the data minus the parsed header elements (<code class="docutils literal notranslate"><span class="pre">&lt;th&gt;</span></code> elements).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Specify an index column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Specify a number of rows to skip:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Specify a number of rows to skip using a list (<code class="docutils literal notranslate"><span class="pre">xrange</span></code> (Python 2 only) works
as well):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>Specify an HTML attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;table&#39;</span><span class="p">})</span>
<span class="n">dfs2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;sortable&#39;</span><span class="p">})</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">dfs1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfs2</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># Should be True</span>
</pre></div>
</div>
<p>Specify values that should be converted to NaN:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No Acquirer&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.</span></p>
</div>
<p>Specify whether to keep the default set of NaN values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">keep_default_na</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.</span></p>
</div>
<p>Specify converters for columns. This is useful for numerical text data that has
leading zeros.  By default columns that are numerical are cast to numeric
types and the leading zeros are lost. To avoid this, we can convert these
columns to strings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url_mcc</span> <span class="o">=</span> <span class="s1">&#39;https://en.wikipedia.org/wiki/Mobile_country_code&#39;</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url_mcc</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;Telekom Albania&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MNC&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.</span></p>
</div>
<p>Use some combination of the above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;Metcalf Bank&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Read in pandas <code class="docutils literal notranslate"><span class="pre">to_html</span></code> output (with some loss of floating point precision):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;{0:.40g}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">dfin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lxml</span></code> backend will raise an error on a failed parse if that is the only
parser you provide. If you only have a single parser you can provide just a
string, but it is considered good practice to pass a list with one string if,
for example, the function expects a sequence of strings. You may use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;Metcalf Bank&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lxml&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Or you could pass <code class="docutils literal notranslate"><span class="pre">flavor='lxml'</span></code> without a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;Metcalf Bank&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>However, if you have bs4 and html5lib installed and pass <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">['lxml',</span>
<span class="pre">'bs4']</span></code> then the parse will most likely succeed. Note that <em>as soon as a parse
succeeds, the function will return</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;Metcalf Bank&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lxml&#39;</span><span class="p">,</span> <span class="s1">&#39;bs4&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-to-html-files">
<span id="io-html"></span><h3>Writing to HTML files<a class="headerlink" href="#writing-to-html-files" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects have an instance method <code class="docutils literal notranslate"><span class="pre">to_html</span></code> which renders the
contents of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as an HTML table. The function arguments are as
in the method <code class="docutils literal notranslate"><span class="pre">to_string</span></code> described above.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Not all of the possible options for <code class="docutils literal notranslate"><span class="pre">DataFrame.to_html</span></code> are shown here for
brevity’s sake. See <code class="xref py py-func docutils literal notranslate"><span class="pre">to_html()</span></code> for the
full set of options.</p>
</div>
<pre class="literal-block">In [300]: df = pd.DataFrame(np.random.randn(2, 2))

In [301]: df
Out[301]: 
          0         1
0 -0.184744  0.496971
1 -0.856240  1.857977

In [302]: print(df.to_html())  # raw html
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;1&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;-0.184744&lt;/td&gt;
      &lt;td&gt;0.496971&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;-0.856240&lt;/td&gt;
      &lt;td&gt;1.857977&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</pre>
<p>HTML:</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.184744</td>
      <td>0.496971</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.856240</td>
      <td>1.857977</td>
    </tr>
  </tbody>
</table><p>The <code class="docutils literal notranslate"><span class="pre">columns</span></code> argument will limit the columns shown:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [303]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.184744&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.856240&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<p>HTML:</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.184744</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.856240</td>
    </tr>
  </tbody>
</table><p><code class="docutils literal notranslate"><span class="pre">float_format</span></code> takes a Python callable to control the precision of floating
point values:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [304]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;{0:.10f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.1847438576&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;0.4969711327&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.8562396763&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;1.8579766508&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<p>HTML:</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.1847438576</td>
      <td>0.4969711327</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.8562396763</td>
      <td>1.8579766508</td>
    </tr>
  </tbody>
</table><p><code class="docutils literal notranslate"><span class="pre">bold_rows</span></code> will make the row labels bold by default, but you can turn that
off:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [305]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">bold_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;td&gt;0&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.184744&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;0.496971&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;td&gt;1&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.856240&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;1.857977&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.184744</td>
      <td>0.496971</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.856240</td>
      <td>1.857977</td>
    </tr>
  </tbody>
</table><p>The <code class="docutils literal notranslate"><span class="pre">classes</span></code> argument provides the ability to give the resulting HTML
table CSS classes. Note that these classes are <em>appended</em> to the existing
<code class="docutils literal notranslate"><span class="pre">'dataframe'</span></code> class.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [306]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;awesome_table_class&#39;</span><span class="p">,</span> <span class="s1">&#39;even_more_awesome_class&#39;</span><span class="p">]))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe awesome_table_class even_more_awesome_class&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.184744&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;0.496971&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;-0.856240&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;1.857977&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">render_links</span></code> argument provides the ability to add hyperlinks to cells
that contain URLs.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [307]: </span><span class="n">url_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   .....: </span>    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Pandas&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">,</span> <span class="s1">&#39;http://pandas.pydata.org&#39;</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [308]: </span><span class="k">print</span><span class="p">(</span><span class="n">url_df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">render_links</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;name&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;url&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;Python&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;&lt;a href=&quot;https://www.python.org/&quot; target=&quot;_blank&quot;&gt;https://www.python.org/&lt;/a&gt;&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;Pandas&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;&lt;a href=&quot;http://pandas.pydata.org&quot; target=&quot;_blank&quot;&gt;http://pandas.pydata.org&lt;/a&gt;&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<p>HTML:</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Python</td>
      <td><a href="https://www.python.org/" target="_blank">https://www.python.org/</a></td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pandas</td>
      <td><a href="http://pandas.pydata.org" target="_blank">http://pandas.pydata.org</a></td>
    </tr>
  </tbody>
</table><p>Finally, the <code class="docutils literal notranslate"><span class="pre">escape</span></code> argument allows you to control whether the
“&lt;”, “&gt;” and “&amp;” characters escaped in the resulting HTML (by default it is
<code class="docutils literal notranslate"><span class="pre">True</span></code>). So to get the HTML without escaped characters pass <code class="docutils literal notranslate"><span class="pre">escape=False</span></code></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [309]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;&amp;&lt;&gt;&#39;</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">)})</span>
</pre></div>
</div>
<p>Escaped:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [310]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">())</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;a&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;b&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&amp;amp;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.474063&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&amp;lt;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.230305&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;2&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&amp;gt;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.400654&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&amp;</td>
      <td>-0.474063</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;</td>
      <td>-0.230305</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&gt;</td>
      <td>-0.400654</td>
    </tr>
  </tbody>
</table><p>Not escaped:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [311]: </span><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="go">  &lt;thead&gt;</span>
<span class="go">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="go">      &lt;th&gt;&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;a&lt;/th&gt;</span>
<span class="go">      &lt;th&gt;b&lt;/th&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/thead&gt;</span>
<span class="go">  &lt;tbody&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&amp;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.474063&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&lt;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.230305&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">    &lt;tr&gt;</span>
<span class="go">      &lt;th&gt;2&lt;/th&gt;</span>
<span class="go">      &lt;td&gt;&gt;&lt;/td&gt;</span>
<span class="go">      &lt;td&gt;-0.400654&lt;/td&gt;</span>
<span class="go">    &lt;/tr&gt;</span>
<span class="go">  &lt;/tbody&gt;</span>
<span class="go">&lt;/table&gt;</span>
</pre></div>
</div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&</td>
      <td>-0.474063</td>
    </tr>
    <tr>
      <th>1</th>
      <td><</td>
      <td>-0.230305</td>
    </tr>
    <tr>
      <th>2</th>
      <td>></td>
      <td>-0.400654</td>
    </tr>
  </tbody>
</table><div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Some browsers may not show a difference in the rendering of the previous two
HTML tables.</p>
</div>
</div>
<div class="section" id="html-table-parsing-gotchas">
<span id="io-html-gotchas"></span><h3>HTML Table Parsing Gotchas<a class="headerlink" href="#html-table-parsing-gotchas" title="Permalink to this headline">¶</a></h3>
<p>There are some versioning issues surrounding the libraries that are used to
parse HTML tables in the top-level pandas io function <code class="docutils literal notranslate"><span class="pre">read_html</span></code>.</p>
<p><strong>Issues with</strong> <a class="reference external" href="https://lxml.de"><strong>lxml</strong></a></p>
<ul>
<li><p>Benefits</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> is very fast.</p></li>
<li><p><a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> requires Cython to install correctly.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Drawbacks</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> does <em>not</em> make any guarantees about the results of its parse
<em>unless</em> it is given <a class="reference external" href="https://validator.w3.org/docs/help.html#validation_basics"><strong>strictly valid markup</strong></a>.</p></li>
<li><p>In light of the above, we have chosen to allow you, the user, to use the
<a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> backend, but <strong>this backend will use</strong> <a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> if <a class="reference external" href="https://lxml.de"><strong>lxml</strong></a>
fails to parse</p></li>
<li><p>It is therefore <em>highly recommended</em> that you install both
<a class="reference external" href="https://www.crummy.com/software/BeautifulSoup"><strong>BeautifulSoup4</strong></a> and <a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a>, so that you will still get a valid
result (provided everything else is valid) even if <a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> fails.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>Issues with</strong> <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup"><strong>BeautifulSoup4</strong></a> <strong>using</strong> <a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> <strong>as a backend</strong></p>
<ul class="simple">
<li><p>The above issues hold here as well since <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup"><strong>BeautifulSoup4</strong></a> is essentially
just a wrapper around a parser backend.</p></li>
</ul>
<p><strong>Issues with</strong> <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup"><strong>BeautifulSoup4</strong></a> <strong>using</strong> <a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> <strong>as a backend</strong></p>
<ul>
<li><p>Benefits</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> is far more lenient than <a class="reference external" href="https://lxml.de"><strong>lxml</strong></a> and consequently deals
with <em>real-life markup</em> in a much saner way rather than just, e.g.,
dropping an element without notifying you.</p></li>
<li><p><a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> <em>generates valid HTML5 markup from invalid markup
automatically</em>. This is extremely important for parsing HTML tables,
since it guarantees a valid document. However, that does NOT mean that
it is “correct”, since the process of fixing markup does not have a
single definition.</p></li>
<li><p><a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> is pure Python and requires no additional build steps beyond
its own installation.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Drawbacks</p>
<blockquote>
<div><ul class="simple">
<li><p>The biggest drawback to using <a class="reference external" href="https://github.com/html5lib/html5lib-python"><strong>html5lib</strong></a> is that it is slow as
molasses.  However consider the fact that many tables on the web are not
big enough for the parsing algorithm runtime to matter. It is more
likely that the bottleneck will be in the process of reading the raw
text from the URL over the web, i.e., IO (input-output). For very large
tables, this might not be true.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="excel-files">
<span id="io-excel"></span><h2>Excel files<a class="headerlink" href="#excel-files" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../reference/api/pandas.read_excel.html#pandas.read_excel" title="pandas.read_excel"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_excel()</span></code></a> method can read Excel 2003 (<code class="docutils literal notranslate"><span class="pre">.xls</span></code>) and
Excel 2007+ (<code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>) files using the <code class="docutils literal notranslate"><span class="pre">xlrd</span></code> Python
module.  The <a class="reference internal" href="../reference/api/pandas.DataFrame.to_excel.html#pandas.DataFrame.to_excel" title="pandas.DataFrame.to_excel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_excel()</span></code></a> instance method is used for
saving a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to Excel.  Generally the semantics are
similar to working with <a class="reference internal" href="#io-read-csv-table"><span class="std std-ref">csv</span></a> data.
See the <a class="reference internal" href="cookbook.html#cookbook-excel"><span class="std std-ref">cookbook</span></a> for some advanced strategies.</p>
<div class="section" id="reading-excel-files">
<span id="io-excel-reader"></span><h3>Reading Excel Files<a class="headerlink" href="#reading-excel-files" title="Permalink to this headline">¶</a></h3>
<p>In the most basic use-case, <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> takes a path to an Excel
file, and the <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code> indicating which sheet to parse.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="excelfile-class">
<span id="io-excel-excelfile-class"></span><h4><code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code> class<a class="headerlink" href="#excelfile-class" title="Permalink to this headline">¶</a></h4>
<p>To facilitate working with multiple sheets from the same file, the <code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code>
class can be used to wrap the file and can be passed into <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>
There will be a performance benefit for reading multiple sheets as the file is
read into memory only once.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xlsx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xlsx</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code> class can also be used as a context manager.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">xls</span><span class="p">:</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sheet_names</span></code> property will generate
a list of the sheet names in the file.</p>
<p>The primary use-case for an <code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code> is parsing multiple sheets with
different parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># For when Sheet1&#39;s format differs from Sheet2</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">xls</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                   <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that if the same parsing parameters are used for all sheets, a list
of sheet names can simply be passed to <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> with no loss in performance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># using the ExcelFile class</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">xls</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                   <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                   <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>

<span class="c1"># equivalent using the read_excel function</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet2&#39;</span><span class="p">],</span>
                     <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-sheets">
<span id="io-excel-specifying-sheets"></span><h4>Specifying Sheets<a class="headerlink" href="#specifying-sheets" title="Permalink to this headline">¶</a></h4>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The second argument is <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code>, not to be confused with <code class="docutils literal notranslate"><span class="pre">ExcelFile.sheet_names</span></code>.</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>An ExcelFile’s attribute <code class="docutils literal notranslate"><span class="pre">sheet_names</span></code> provides access to a list of sheets.</p>
</div>
<ul class="simple">
<li><p>The arguments <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code> allows specifying the sheet or sheets to read.</p></li>
<li><p>The default value for <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code> is 0, indicating to read the first sheet</p></li>
<li><p>Pass a string to refer to the name of a particular sheet in the workbook.</p></li>
<li><p>Pass an integer to refer to the index of a sheet. Indices follow Python
convention, beginning at 0.</p></li>
<li><p>Pass a list of either strings or integers, to return a dictionary of specified sheets.</p></li>
<li><p>Pass a <code class="docutils literal notranslate"><span class="pre">None</span></code> to return a dictionary of all available sheets.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Using the sheet index:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Using all default values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using None to get all sheets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a dictionary of DataFrames</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a list to get multiple sheets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns the 1st and 4th sheet, as a dictionary of DataFrames.</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">read_excel</span></code> can read more than one sheet, by setting <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code> to either
a list of sheet names, a list of sheet positions, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to read all sheets.
Sheets can be specified by sheet index or sheet name, using an integer or string,
respectively.</p>
</div>
<div class="section" id="reading-a-multiindex">
<span id="io-excel-reading-multiindex"></span><h4>Reading a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code><a class="headerlink" href="#reading-a-multiindex" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">read_excel</span></code> can read a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> index, by passing a list of columns to <code class="docutils literal notranslate"><span class="pre">index_col</span></code>
and a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> column by passing a list of rows to <code class="docutils literal notranslate"><span class="pre">header</span></code>.  If either the <code class="docutils literal notranslate"><span class="pre">index</span></code>
or <code class="docutils literal notranslate"><span class="pre">columns</span></code> have serialized level names those will be read in as well by specifying
the rows/columns that make up the levels.</p>
<p>For example, to read in a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> index without names:</p>
<pre class="literal-block">In [312]: df = pd.DataFrame({'a': [1, 2, 3, 4], 'b': [5, 6, 7, 8]},
   .....:                   index=pd.MultiIndex.from_product([['a', 'b'], ['c', 'd']]))
   .....: 

In [313]: df.to_excel('path_to_file.xlsx')
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-313-02ef2d16bef7&gt; in &lt;module&gt;
----&gt; 1 df.to_excel('path_to_file.xlsx')

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes)
   2254             startcol=startcol,
   2255             freeze_panes=freeze_panes,
-&gt; 2256             engine=engine,
   2257         )
   2258 

~/miniconda/lib/python3.7/site-packages/pandas/io/formats/excel.py in write(self, writer, sheet_name, startrow, startcol, freeze_panes, engine)
    728             need_save = False
    729         else:
--&gt; 730             writer = ExcelWriter(_stringify_path(writer), engine=engine)
    731             need_save = True
    732 

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_openpyxl.py in __init__(self, path, engine, mode, **engine_kwargs)
     17     def __init__(self, path, engine=None, mode=&quot;w&quot;, **engine_kwargs):
     18         # Use the openpyxl module as the Excel writer.
---&gt; 19         from openpyxl.workbook import Workbook
     20 
     21         super().__init__(path, mode=mode, **engine_kwargs)

ModuleNotFoundError: No module named 'openpyxl'

In [314]: df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1])
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-314-cb6d294acdd1&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1])

~/miniconda/lib/python3.7/site-packages/pandas/util/_decorators.py in wrapper(*args, **kwargs)
    206                 else:
    207                     kwargs[new_arg_name] = new_arg_value
--&gt; 208             return func(*args, **kwargs)
    209 
    210         return wrapper

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in read_excel(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, verbose, parse_dates, date_parser, thousands, comment, skip_footer, skipfooter, convert_float, mangle_dupe_cols, **kwds)
    308 
    309     if not isinstance(io, ExcelFile):
--&gt; 310         io = ExcelFile(io, engine=engine)
    311     elif engine and engine != io.engine:
    312         raise ValueError(

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in __init__(self, io, engine)
    817         self._io = _stringify_path(io)
    818 
--&gt; 819         self._reader = self._engines[engine](self._io)
    820 
    821     def __fspath__(self):

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_xlrd.py in __init__(self, filepath_or_buffer)
     18         &quot;&quot;&quot;
     19         err_msg = &quot;Install xlrd &gt;= 1.0.0 for Excel support&quot;
---&gt; 20         import_optional_dependency(&quot;xlrd&quot;, extra=err_msg)
     21         super().__init__(filepath_or_buffer)
     22 

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'xlrd'. Install xlrd &gt;= 1.0.0 for Excel support Use pip or conda to install xlrd.

In [315]: df
Out[315]: 
     a  b
a c  1  5
  d  2  6
b c  3  7
  d  4  8</pre>
<p>If the index has level names, they will parsed as well, using the same
parameters.</p>
<pre class="literal-block">In [316]: df.index = df.index.set_names(['lvl1', 'lvl2'])

In [317]: df.to_excel('path_to_file.xlsx')
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-317-02ef2d16bef7&gt; in &lt;module&gt;
----&gt; 1 df.to_excel('path_to_file.xlsx')

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes)
   2254             startcol=startcol,
   2255             freeze_panes=freeze_panes,
-&gt; 2256             engine=engine,
   2257         )
   2258 

~/miniconda/lib/python3.7/site-packages/pandas/io/formats/excel.py in write(self, writer, sheet_name, startrow, startcol, freeze_panes, engine)
    728             need_save = False
    729         else:
--&gt; 730             writer = ExcelWriter(_stringify_path(writer), engine=engine)
    731             need_save = True
    732 

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_openpyxl.py in __init__(self, path, engine, mode, **engine_kwargs)
     17     def __init__(self, path, engine=None, mode=&quot;w&quot;, **engine_kwargs):
     18         # Use the openpyxl module as the Excel writer.
---&gt; 19         from openpyxl.workbook import Workbook
     20 
     21         super().__init__(path, mode=mode, **engine_kwargs)

ModuleNotFoundError: No module named 'openpyxl'

In [318]: df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1])
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-318-cb6d294acdd1&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1])

~/miniconda/lib/python3.7/site-packages/pandas/util/_decorators.py in wrapper(*args, **kwargs)
    206                 else:
    207                     kwargs[new_arg_name] = new_arg_value
--&gt; 208             return func(*args, **kwargs)
    209 
    210         return wrapper

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in read_excel(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, verbose, parse_dates, date_parser, thousands, comment, skip_footer, skipfooter, convert_float, mangle_dupe_cols, **kwds)
    308 
    309     if not isinstance(io, ExcelFile):
--&gt; 310         io = ExcelFile(io, engine=engine)
    311     elif engine and engine != io.engine:
    312         raise ValueError(

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in __init__(self, io, engine)
    817         self._io = _stringify_path(io)
    818 
--&gt; 819         self._reader = self._engines[engine](self._io)
    820 
    821     def __fspath__(self):

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_xlrd.py in __init__(self, filepath_or_buffer)
     18         &quot;&quot;&quot;
     19         err_msg = &quot;Install xlrd &gt;= 1.0.0 for Excel support&quot;
---&gt; 20         import_optional_dependency(&quot;xlrd&quot;, extra=err_msg)
     21         super().__init__(filepath_or_buffer)
     22 

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'xlrd'. Install xlrd &gt;= 1.0.0 for Excel support Use pip or conda to install xlrd.

In [319]: df
Out[319]: 
           a  b
lvl1 lvl2      
a    c     1  5
     d     2  6
b    c     3  7
     d     4  8</pre>
<p>If the source file has both <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> index and columns, lists specifying each
should be passed to <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and <code class="docutils literal notranslate"><span class="pre">header</span></code>:</p>
<pre class="literal-block">In [320]: df.columns = pd.MultiIndex.from_product([['a'], ['b', 'd']],
   .....:                                         names=['c1', 'c2'])
   .....: 

In [321]: df.to_excel('path_to_file.xlsx')
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-321-02ef2d16bef7&gt; in &lt;module&gt;
----&gt; 1 df.to_excel('path_to_file.xlsx')

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes)
   2254             startcol=startcol,
   2255             freeze_panes=freeze_panes,
-&gt; 2256             engine=engine,
   2257         )
   2258 

~/miniconda/lib/python3.7/site-packages/pandas/io/formats/excel.py in write(self, writer, sheet_name, startrow, startcol, freeze_panes, engine)
    728             need_save = False
    729         else:
--&gt; 730             writer = ExcelWriter(_stringify_path(writer), engine=engine)
    731             need_save = True
    732 

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_openpyxl.py in __init__(self, path, engine, mode, **engine_kwargs)
     17     def __init__(self, path, engine=None, mode=&quot;w&quot;, **engine_kwargs):
     18         # Use the openpyxl module as the Excel writer.
---&gt; 19         from openpyxl.workbook import Workbook
     20 
     21         super().__init__(path, mode=mode, **engine_kwargs)

ModuleNotFoundError: No module named 'openpyxl'

In [322]: df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1], header=[0, 1])
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-322-3a6768bb42fd&gt; in &lt;module&gt;
----&gt; 1 df = pd.read_excel('path_to_file.xlsx', index_col=[0, 1], header=[0, 1])

~/miniconda/lib/python3.7/site-packages/pandas/util/_decorators.py in wrapper(*args, **kwargs)
    206                 else:
    207                     kwargs[new_arg_name] = new_arg_value
--&gt; 208             return func(*args, **kwargs)
    209 
    210         return wrapper

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in read_excel(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, verbose, parse_dates, date_parser, thousands, comment, skip_footer, skipfooter, convert_float, mangle_dupe_cols, **kwds)
    308 
    309     if not isinstance(io, ExcelFile):
--&gt; 310         io = ExcelFile(io, engine=engine)
    311     elif engine and engine != io.engine:
    312         raise ValueError(

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_base.py in __init__(self, io, engine)
    817         self._io = _stringify_path(io)
    818 
--&gt; 819         self._reader = self._engines[engine](self._io)
    820 
    821     def __fspath__(self):

~/miniconda/lib/python3.7/site-packages/pandas/io/excel/_xlrd.py in __init__(self, filepath_or_buffer)
     18         &quot;&quot;&quot;
     19         err_msg = &quot;Install xlrd &gt;= 1.0.0 for Excel support&quot;
---&gt; 20         import_optional_dependency(&quot;xlrd&quot;, extra=err_msg)
     21         super().__init__(filepath_or_buffer)
     22 

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'xlrd'. Install xlrd &gt;= 1.0.0 for Excel support Use pip or conda to install xlrd.

In [323]: df
Out[323]: 
c1         a   
c2         b  d
lvl1 lvl2      
a    c     1  5
     d     2  6
b    c     3  7
     d     4  8</pre>
</div>
<div class="section" id="parsing-specific-columns">
<h4>Parsing Specific Columns<a class="headerlink" href="#parsing-specific-columns" title="Permalink to this headline">¶</a></h4>
<p>It is often the case that users will insert columns to do temporary computations
in Excel and you may not want to read in those columns. <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> takes
a <code class="docutils literal notranslate"><span class="pre">usecols</span></code> keyword to allow you to specify a subset of columns to parse.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.24.0.</span></p>
</div>
<p>Passing in an integer for <code class="docutils literal notranslate"><span class="pre">usecols</span></code> has been deprecated. Please pass in a list
of ints from 0 to <code class="docutils literal notranslate"><span class="pre">usecols</span></code> inclusive instead.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">usecols</span></code> is an integer, then it is assumed to indicate the last column
to be parsed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also specify a comma-delimited set of Excel columns and ranges as a string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="s1">&#39;A,C:E&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">usecols</span></code> is a list of integers, then it is assumed to be the file column
indices to be parsed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Element order is ignored, so <code class="docutils literal notranslate"><span class="pre">usecols=[0,</span> <span class="pre">1]</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0]</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">usecols</span></code> is a list of strings, it is assumed that each string corresponds
to a column name provided either by the user in <code class="docutils literal notranslate"><span class="pre">names</span></code> or inferred from the
document header row(s). Those strings define which columns will be parsed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Element order is ignored, so <code class="docutils literal notranslate"><span class="pre">usecols=['baz',</span> <span class="pre">'joe']</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">['joe',</span> <span class="pre">'baz']</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">usecols</span></code> is callable, the callable function will be evaluated against
the column names, returning names where the callable function evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isalpha</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="parsing-dates">
<h4>Parsing Dates<a class="headerlink" href="#parsing-dates" title="Permalink to this headline">¶</a></h4>
<p>Datetime-like values are normally automatically converted to the appropriate
dtype when reading the excel file. But if you have a column of strings that
<em>look</em> like dates (but are not actually formatted as dates in excel), you can
use the <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> keyword to parse those strings to datetimes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_strings&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="cell-converters">
<h4>Cell Converters<a class="headerlink" href="#cell-converters" title="Permalink to this headline">¶</a></h4>
<p>It is possible to transform the contents of Excel cells via the <code class="docutils literal notranslate"><span class="pre">converters</span></code>
option. For instance, to convert a column to boolean:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MyBools&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">})</span>
</pre></div>
</div>
<p>This options handles missing values and treats exceptions in the converters
as missing data. Transformations are applied cell by cell rather than to the
column as a whole, so the array dtype is not guaranteed. For instance, a
column of integers with missing values cannot be transformed to an array
with integer dtype, because NaN is strictly a float. You can manually mask
missing data to recover integer dtype:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>


<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MyInts&#39;</span><span class="p">:</span> <span class="n">cfun</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="dtype-specifications">
<h4>dtype Specifications<a class="headerlink" href="#dtype-specifications" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
<p>As an alternative to converters, the type for an entire column can
be specified using the <cite>dtype</cite> keyword, which takes a dictionary
mapping column names to types.  To interpret data with
no type inference, use the type <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xls&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MyInts&#39;</span><span class="p">:</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;MyText&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-excel-files">
<span id="io-excel-writer"></span><h3>Writing Excel Files<a class="headerlink" href="#writing-excel-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="writing-excel-files-to-disk">
<h4>Writing Excel Files to Disk<a class="headerlink" href="#writing-excel-files-to-disk" title="Permalink to this headline">¶</a></h4>
<p>To write a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object to a sheet of an Excel file, you can use the
<code class="docutils literal notranslate"><span class="pre">to_excel</span></code> instance method.  The arguments are largely the same as <code class="docutils literal notranslate"><span class="pre">to_csv</span></code>
described above, the first argument being the name of the excel file, and the
optional second argument the name of the sheet to which the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> should be
written. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Files with a <code class="docutils literal notranslate"><span class="pre">.xls</span></code> extension will be written using <code class="docutils literal notranslate"><span class="pre">xlwt</span></code> and those with a
<code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> extension will be written using <code class="docutils literal notranslate"><span class="pre">xlsxwriter</span></code> (if available) or
<code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> will be written in a way that tries to mimic the REPL output.
The <code class="docutils literal notranslate"><span class="pre">index_label</span></code> will be placed in the second
row instead of the first. You can place it in the first row by setting the
<code class="docutils literal notranslate"><span class="pre">merge_cells</span></code> option in <code class="docutils literal notranslate"><span class="pre">to_excel()</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">merge_cells</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to write separate <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> to separate sheets in a single Excel file,
one can pass an <code class="xref py py-class docutils literal notranslate"><span class="pre">ExcelWriter</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Wringing a little more performance out of <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>
Internally, Excel stores all numeric data as floats. Because this can
produce unexpected behavior when reading in data, pandas defaults to trying
to convert integers to floats if it doesn’t lose information (<code class="docutils literal notranslate"><span class="pre">1.0</span> <span class="pre">--&gt;</span>
<span class="pre">1</span></code>).  You can pass <code class="docutils literal notranslate"><span class="pre">convert_float=False</span></code> to disable this behavior, which
may give a slight performance improvement.</p>
</div>
</div>
<div class="section" id="writing-excel-files-to-memory">
<span id="io-excel-writing-buffer"></span><h4>Writing Excel Files to Memory<a class="headerlink" href="#writing-excel-files-to-memory" title="Permalink to this headline">¶</a></h4>
<p>Pandas supports writing Excel files to buffer-like objects such as <code class="docutils literal notranslate"><span class="pre">StringIO</span></code> or
<code class="docutils literal notranslate"><span class="pre">BytesIO</span></code> using <code class="xref py py-class docutils literal notranslate"><span class="pre">ExcelWriter</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Safe import for either Python 2.x or 3.x</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cStringIO</span> <span class="kn">import</span> <span class="n">StringIO</span> <span class="k">as</span> <span class="n">BytesIO</span>

<span class="n">bio</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>

<span class="c1"># By setting the &#39;engine&#39; in the ExcelWriter constructor.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">bio</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Save the workbook</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># Seek to the beginning and read to copy the workbook to a variable in memory</span>
<span class="n">bio</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">engine</span></code> is optional but recommended.  Setting the engine determines
the version of workbook produced. Setting <code class="docutils literal notranslate"><span class="pre">engine='xlrd'</span></code> will produce an
Excel 2003-format workbook (xls).  Using either <code class="docutils literal notranslate"><span class="pre">'openpyxl'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'xlsxwriter'</span></code> will produce an Excel 2007-format workbook (xlsx). If
omitted, an Excel 2007-formatted workbook is produced.</p>
</div>
</div>
</div>
<div class="section" id="excel-writer-engines">
<span id="io-excel-writers"></span><h3>Excel writer engines<a class="headerlink" href="#excel-writer-engines" title="Permalink to this headline">¶</a></h3>
<p>Pandas chooses an Excel writer via two methods:</p>
<ol class="arabic simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">engine</span></code> keyword argument</p></li>
<li><p>the filename extension (via the default specified in config options)</p></li>
</ol>
<p>By default, pandas uses the <a class="reference external" href="https://xlsxwriter.readthedocs.io">XlsxWriter</a>  for <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>, <a class="reference external" href="https://openpyxl.readthedocs.io/">openpyxl</a>
for <code class="docutils literal notranslate"><span class="pre">.xlsm</span></code>, and <a class="reference external" href="http://www.python-excel.org">xlwt</a> for <code class="docutils literal notranslate"><span class="pre">.xls</span></code> files. If you have multiple
engines installed, you can set the default engine through <a class="reference internal" href="options.html#options"><span class="std std-ref">setting the
config options</span></a> <code class="docutils literal notranslate"><span class="pre">io.excel.xlsx.writer</span></code> and
<code class="docutils literal notranslate"><span class="pre">io.excel.xls.writer</span></code>. pandas will fall back on <a class="reference external" href="https://openpyxl.readthedocs.io/">openpyxl</a> for <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>
files if <a class="reference external" href="https://xlsxwriter.readthedocs.io">Xlsxwriter</a> is not available.</p>
<p>To specify which writer you want to use, you can pass an engine keyword
argument to <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> and to <code class="docutils literal notranslate"><span class="pre">ExcelWriter</span></code>. The built-in engines are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>: version 2.4 or higher is required</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xlsxwriter</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xlwt</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># By setting the &#39;engine&#39; in the DataFrame &#39;to_excel()&#39; methods.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># By setting the &#39;engine&#39; in the ExcelWriter constructor.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Or via pandas configuration.</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">options</span>                                     <span class="c1"># noqa: E402</span>
<span class="n">options</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">excel</span><span class="o">.</span><span class="n">xlsx</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="s1">&#39;xlsxwriter&#39;</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;path_to_file.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="style-and-formatting">
<span id="io-excel-style"></span><h3>Style and Formatting<a class="headerlink" href="#style-and-formatting" title="Permalink to this headline">¶</a></h3>
<p>The look and feel of Excel worksheets created from pandas can be modified using the following parameters on the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>’s <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> method.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">float_format</span></code> : Format string for floating point numbers (default <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">freeze_panes</span></code> : A tuple of two integers representing the bottommost row and rightmost column to freeze. Each of these parameters is one-based, so (1, 1) will freeze the first row and first column (default <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</div>
</div>
<div class="section" id="clipboard">
<span id="io-clipboard"></span><h2>Clipboard<a class="headerlink" href="#clipboard" title="Permalink to this headline">¶</a></h2>
<p>A handy way to grab data is to use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">read_clipboard()</span></code> method,
which takes the contents of the clipboard buffer and passes them to the
<code class="docutils literal notranslate"><span class="pre">read_csv</span></code> method. For instance, you can copy the following text to the
clipboard (CTRL-C on many operating systems):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">  A B C</span>
<span class="go">x 1 4 p</span>
<span class="go">y 2 5 q</span>
<span class="go">z 3 6 r</span>
</pre></div>
</div>
<p>And then import the data directly to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by calling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clipdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_clipboard</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [324]: </span><span class="n">clipdf</span>
<span class="gh">Out[324]: </span><span class="go"></span>
<span class="go">   A  B  C</span>
<span class="go">x  1  4  p</span>
<span class="go">y  2  5  q</span>
<span class="go">z  3  6  r</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">to_clipboard</span></code> method can be used to write the contents of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to
the clipboard. Following which you can paste the clipboard contents into other
applications (CTRL-V on many operating systems). Here we illustrate writing a
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> into clipboard and reading it back.</p>
<pre class="literal-block">In [325]: df = pd.DataFrame(np.random.randn(5, 3))

In [326]: df
Out[326]: 
          0         1         2
0 -0.288267 -0.084905  0.004772
1  1.382989  0.343635 -1.253994
2 -0.124925  0.212244  0.496654
3  0.525417  1.238640 -1.210543
4 -1.175743 -0.172372 -0.734129

In [327]: df.to_clipboard()
---------------------------------------------------------------------------
PyperclipException                        Traceback (most recent call last)
&lt;ipython-input-327-d9e762ebf7d3&gt; in &lt;module&gt;
----&gt; 1 df.to_clipboard()

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_clipboard(self, excel, sep, **kwargs)
   2827         from pandas.io import clipboards
   2828 
-&gt; 2829         clipboards.to_clipboard(self, excel=excel, sep=sep, **kwargs)
   2830 
   2831     def to_xarray(self):

~/miniconda/lib/python3.7/site-packages/pandas/io/clipboards.py in to_clipboard(obj, excel, sep, **kwargs)
    118             text = buf.getvalue()
    119 
--&gt; 120             clipboard_set(text)
    121             return
    122         except TypeError:

~/miniconda/lib/python3.7/site-packages/pandas/io/clipboard/clipboards.py in __call__(self, *args, **kwargs)
    122     class ClipboardUnavailable:
    123         def __call__(self, *args, **kwargs):
--&gt; 124             raise PyperclipException(EXCEPT_MSG)
    125 
    126         def __bool__(self):

PyperclipException: 
    Pyperclip could not find a copy/paste mechanism for your system.
    For more information, please visit https://pyperclip.readthedocs.org 

In [328]: pd.read_clipboard()
---------------------------------------------------------------------------
PyperclipException                        Traceback (most recent call last)
&lt;ipython-input-328-8cbad928c47b&gt; in &lt;module&gt;
----&gt; 1 pd.read_clipboard()

~/miniconda/lib/python3.7/site-packages/pandas/io/clipboards.py in read_clipboard(sep, **kwargs)
     33     from pandas.io.parsers import read_csv
     34 
---&gt; 35     text = clipboard_get()
     36 
     37     # Try to decode (if needed, as &quot;text&quot; might already be a string here).

~/miniconda/lib/python3.7/site-packages/pandas/io/clipboard/clipboards.py in __call__(self, *args, **kwargs)
    122     class ClipboardUnavailable:
    123         def __call__(self, *args, **kwargs):
--&gt; 124             raise PyperclipException(EXCEPT_MSG)
    125 
    126         def __bool__(self):

PyperclipException: 
    Pyperclip could not find a copy/paste mechanism for your system.
    For more information, please visit https://pyperclip.readthedocs.org </pre>
<p>We can see that we got the same content back, which we had earlier written to the clipboard.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>You may need to install xclip or xsel (with gtk, PyQt5, PyQt4 or qtpy) on Linux to use these methods.</p>
</div>
</div>
<div class="section" id="pickling">
<span id="io-pickle"></span><h2>Pickling<a class="headerlink" href="#pickling" title="Permalink to this headline">¶</a></h2>
<p>All pandas objects are equipped with <code class="docutils literal notranslate"><span class="pre">to_pickle</span></code> methods which use Python’s
<code class="docutils literal notranslate"><span class="pre">cPickle</span></code> module to save data structures to disk using the pickle format.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [329]: </span><span class="n">df</span>
<span class="gh">Out[329]: </span><span class="go"></span>
<span class="go">          0         1         2</span>
<span class="go">0 -0.288267 -0.084905  0.004772</span>
<span class="go">1  1.382989  0.343635 -1.253994</span>
<span class="go">2 -0.124925  0.212244  0.496654</span>
<span class="go">3  0.525417  1.238640 -1.210543</span>
<span class="go">4 -1.175743 -0.172372 -0.734129</span>

<span class="gp">In [330]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;foo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">read_pickle</span></code> function in the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> namespace can be used to load
any pickled pandas object (or any other pickled object) from file:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [331]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;foo.pkl&#39;</span><span class="p">)</span>
<span class="gh">Out[331]: </span><span class="go"></span>
<span class="go">          0         1         2</span>
<span class="go">0 -0.288267 -0.084905  0.004772</span>
<span class="go">1  1.382989  0.343635 -1.253994</span>
<span class="go">2 -0.124925  0.212244  0.496654</span>
<span class="go">3  0.525417  1.238640 -1.210543</span>
<span class="go">4 -1.175743 -0.172372 -0.734129</span>
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Loading pickled data received from untrusted sources can be unsafe.</p>
<p>See: <a class="reference external" href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a></p>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Several internal refactoring have been done while still preserving
compatibility with pickles created with older versions of pandas. However,
for such cases, pickled <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>, <code class="docutils literal notranslate"><span class="pre">Series</span></code> etc, must be read with
<code class="docutils literal notranslate"><span class="pre">pd.read_pickle</span></code>, rather than <code class="docutils literal notranslate"><span class="pre">pickle.load</span></code>.</p>
<p>See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/whatsnew.html#whatsnew-0130-refactoring">here</a>
and <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/whatsnew.html#whatsnew-0150-refactoring">here</a>
for some examples of compatibility-breaking changes. See
<a class="reference external" href="https://stackoverflow.com/questions/20444593/pandas-compiled-from-source-default-pickle-behavior-changed">this question</a>
for a detailed explanation.</p>
</div>
<div class="section" id="compressed-pickle-files">
<span id="io-pickle-compression"></span><h3>Compressed pickle files<a class="headerlink" href="#compressed-pickle-files" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p><a class="reference internal" href="../reference/api/pandas.read_pickle.html#pandas.read_pickle" title="pandas.read_pickle"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pickle()</span></code></a>, <a class="reference internal" href="../reference/api/pandas.DataFrame.to_pickle.html#pandas.DataFrame.to_pickle" title="pandas.DataFrame.to_pickle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataFrame.to_pickle()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Series.to_pickle()</span></code> can read
and write compressed pickle files. The compression types of <code class="docutils literal notranslate"><span class="pre">gzip</span></code>, <code class="docutils literal notranslate"><span class="pre">bz2</span></code>, <code class="docutils literal notranslate"><span class="pre">xz</span></code> are supported for reading and writing.
The <code class="docutils literal notranslate"><span class="pre">zip</span></code> file format only supports reading and must contain only one data file
to be read.</p>
<p>The compression type can be an explicit parameter or be inferred from the file extension.
If ‘infer’, then use <code class="docutils literal notranslate"><span class="pre">gzip</span></code>, <code class="docutils literal notranslate"><span class="pre">bz2</span></code>, <code class="docutils literal notranslate"><span class="pre">zip</span></code>, or <code class="docutils literal notranslate"><span class="pre">xz</span></code> if filename ends in <code class="docutils literal notranslate"><span class="pre">'.gz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'.bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'.zip'</span></code>, or
<code class="docutils literal notranslate"><span class="pre">'.xz'</span></code>, respectively.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [332]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">   .....: </span>    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [333]: </span><span class="n">df</span>
<span class="gh">Out[333]: </span><span class="go"></span>
<span class="go">            A    B                   C</span>
<span class="go">0    0.478412  foo 2013-01-01 00:00:00</span>
<span class="go">1   -0.783748  foo 2013-01-01 00:00:01</span>
<span class="go">2    1.403558  foo 2013-01-01 00:00:02</span>
<span class="go">3   -0.539282  foo 2013-01-01 00:00:03</span>
<span class="go">4   -1.651012  foo 2013-01-01 00:00:04</span>
<span class="go">..        ...  ...                 ...</span>
<span class="go">995 -0.632963  foo 2013-01-01 00:16:35</span>
<span class="go">996 -0.585314  foo 2013-01-01 00:16:36</span>
<span class="go">997 -0.275038  foo 2013-01-01 00:16:37</span>
<span class="go">998 -0.937512  foo 2013-01-01 00:16:38</span>
<span class="go">999  0.632369  foo 2013-01-01 00:16:39</span>

<span class="go">[1000 rows x 3 columns]</span>
</pre></div>
</div>
<p>Using an explicit compression type:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [334]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.compress&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">)</span>

<span class="gp">In [335]: </span><span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.compress&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">)</span>

<span class="gp">In [336]: </span><span class="n">rt</span>
<span class="gh">Out[336]: </span><span class="go"></span>
<span class="go">            A    B                   C</span>
<span class="go">0    0.478412  foo 2013-01-01 00:00:00</span>
<span class="go">1   -0.783748  foo 2013-01-01 00:00:01</span>
<span class="go">2    1.403558  foo 2013-01-01 00:00:02</span>
<span class="go">3   -0.539282  foo 2013-01-01 00:00:03</span>
<span class="go">4   -1.651012  foo 2013-01-01 00:00:04</span>
<span class="go">..        ...  ...                 ...</span>
<span class="go">995 -0.632963  foo 2013-01-01 00:16:35</span>
<span class="go">996 -0.585314  foo 2013-01-01 00:16:36</span>
<span class="go">997 -0.275038  foo 2013-01-01 00:16:37</span>
<span class="go">998 -0.937512  foo 2013-01-01 00:16:38</span>
<span class="go">999  0.632369  foo 2013-01-01 00:16:39</span>

<span class="go">[1000 rows x 3 columns]</span>
</pre></div>
</div>
<p>Inferring compression type from the extension:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [337]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.xz&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;infer&quot;</span><span class="p">)</span>

<span class="gp">In [338]: </span><span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.xz&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;infer&quot;</span><span class="p">)</span>

<span class="gp">In [339]: </span><span class="n">rt</span>
<span class="gh">Out[339]: </span><span class="go"></span>
<span class="go">            A    B                   C</span>
<span class="go">0    0.478412  foo 2013-01-01 00:00:00</span>
<span class="go">1   -0.783748  foo 2013-01-01 00:00:01</span>
<span class="go">2    1.403558  foo 2013-01-01 00:00:02</span>
<span class="go">3   -0.539282  foo 2013-01-01 00:00:03</span>
<span class="go">4   -1.651012  foo 2013-01-01 00:00:04</span>
<span class="go">..        ...  ...                 ...</span>
<span class="go">995 -0.632963  foo 2013-01-01 00:16:35</span>
<span class="go">996 -0.585314  foo 2013-01-01 00:16:36</span>
<span class="go">997 -0.275038  foo 2013-01-01 00:16:37</span>
<span class="go">998 -0.937512  foo 2013-01-01 00:16:38</span>
<span class="go">999  0.632369  foo 2013-01-01 00:16:39</span>

<span class="go">[1000 rows x 3 columns]</span>
</pre></div>
</div>
<p>The default is to ‘infer’:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [340]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.gz&quot;</span><span class="p">)</span>

<span class="gp">In [341]: </span><span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;data.pkl.gz&quot;</span><span class="p">)</span>

<span class="gp">In [342]: </span><span class="n">rt</span>
<span class="gh">Out[342]: </span><span class="go"></span>
<span class="go">            A    B                   C</span>
<span class="go">0    0.478412  foo 2013-01-01 00:00:00</span>
<span class="go">1   -0.783748  foo 2013-01-01 00:00:01</span>
<span class="go">2    1.403558  foo 2013-01-01 00:00:02</span>
<span class="go">3   -0.539282  foo 2013-01-01 00:00:03</span>
<span class="go">4   -1.651012  foo 2013-01-01 00:00:04</span>
<span class="go">..        ...  ...                 ...</span>
<span class="go">995 -0.632963  foo 2013-01-01 00:16:35</span>
<span class="go">996 -0.585314  foo 2013-01-01 00:16:36</span>
<span class="go">997 -0.275038  foo 2013-01-01 00:16:37</span>
<span class="go">998 -0.937512  foo 2013-01-01 00:16:38</span>
<span class="go">999  0.632369  foo 2013-01-01 00:16:39</span>

<span class="go">[1000 rows x 3 columns]</span>

<span class="gp">In [343]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;s1.pkl.bz2&quot;</span><span class="p">)</span>

<span class="gp">In [344]: </span><span class="n">rt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;s1.pkl.bz2&quot;</span><span class="p">)</span>

<span class="gp">In [345]: </span><span class="n">rt</span>
<span class="gh">Out[345]: </span><span class="go"></span>
<span class="go">0      0.478412</span>
<span class="go">1     -0.783748</span>
<span class="go">2      1.403558</span>
<span class="go">3     -0.539282</span>
<span class="go">4     -1.651012</span>
<span class="go">         ...   </span>
<span class="go">995   -0.632963</span>
<span class="go">996   -0.585314</span>
<span class="go">997   -0.275038</span>
<span class="go">998   -0.937512</span>
<span class="go">999    0.632369</span>
<span class="go">Name: A, Length: 1000, dtype: float64</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="msgpack">
<span id="io-msgpack"></span><h2>msgpack<a class="headerlink" href="#msgpack" title="Permalink to this headline">¶</a></h2>
<p>pandas supports the <code class="docutils literal notranslate"><span class="pre">msgpack</span></code> format for
object serialization. This is a lightweight portable binary format, similar
to binary JSON, that is highly space efficient, and provides good performance
both on the writing (serialization), and reading (deserialization).</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>This is a very new feature of pandas. We intend to provide certain
optimizations in the io of the <code class="docutils literal notranslate"><span class="pre">msgpack</span></code> data. Since this is marked
as an EXPERIMENTAL LIBRARY, the storage format may not be stable until a future release.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [346]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>

<span class="gp">In [347]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">)</span>

<span class="gp">In [348]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">)</span>
<span class="gh">Out[348]: </span><span class="go"></span>
<span class="go">          A         B</span>
<span class="go">0  0.170801  0.895366</span>
<span class="go">1  0.838238  0.052592</span>
<span class="go">2  0.664140  0.289750</span>
<span class="go">3  0.449593  0.872087</span>
<span class="go">4  0.983618  0.744359</span>

<span class="gp">In [349]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>You can pass a list of objects and you will receive them back on deserialization.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [350]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">s</span><span class="p">)</span>

<span class="gp">In [351]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">)</span>
<span class="gh">Out[351]: </span><span class="go"></span>
<span class="go">[          A         B</span>
<span class="go"> 0  0.170801  0.895366</span>
<span class="go"> 1  0.838238  0.052592</span>
<span class="go"> 2  0.664140  0.289750</span>
<span class="go"> 3  0.449593  0.872087</span>
<span class="go"> 4  0.983618  0.744359, &#39;foo&#39;, array([1, 2, 3]), 2013-01-01    0.548134</span>
<span class="go"> 2013-01-02    0.503447</span>
<span class="go"> 2013-01-03    0.348438</span>
<span class="go"> 2013-01-04    0.707267</span>
<span class="go"> 2013-01-05    0.261656</span>
<span class="go"> Freq: D, dtype: float64]</span>
</pre></div>
</div>
<p>You can pass <code class="docutils literal notranslate"><span class="pre">iterator=True</span></code> to iterate over the unpacked results:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [352]: </span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">,</span> <span class="n">iterator</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="go">          A         B</span>
<span class="go">0  0.170801  0.895366</span>
<span class="go">1  0.838238  0.052592</span>
<span class="go">2  0.664140  0.289750</span>
<span class="go">3  0.449593  0.872087</span>
<span class="go">4  0.983618  0.744359</span>
<span class="go">foo</span>
<span class="go">[1 2 3]</span>
<span class="go">2013-01-01    0.548134</span>
<span class="go">2013-01-02    0.503447</span>
<span class="go">2013-01-03    0.348438</span>
<span class="go">2013-01-04    0.707267</span>
<span class="go">2013-01-05    0.261656</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>You can pass <code class="docutils literal notranslate"><span class="pre">append=True</span></code> to the writer to append to an existing pack:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [353]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [354]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="s1">&#39;foo.msg&#39;</span><span class="p">)</span>
<span class="gh">Out[354]: </span><span class="go"></span>
<span class="go">[          A         B</span>
<span class="go"> 0  0.170801  0.895366</span>
<span class="go"> 1  0.838238  0.052592</span>
<span class="go"> 2  0.664140  0.289750</span>
<span class="go"> 3  0.449593  0.872087</span>
<span class="go"> 4  0.983618  0.744359, &#39;foo&#39;, array([1, 2, 3]), 2013-01-01    0.548134</span>
<span class="go"> 2013-01-02    0.503447</span>
<span class="go"> 2013-01-03    0.348438</span>
<span class="go"> 2013-01-04    0.707267</span>
<span class="go"> 2013-01-05    0.261656</span>
<span class="go"> Freq: D, dtype: float64,           A         B</span>
<span class="go"> 0  0.170801  0.895366</span>
<span class="go"> 1  0.838238  0.052592</span>
<span class="go"> 2  0.664140  0.289750</span>
<span class="go"> 3  0.449593  0.872087</span>
<span class="go"> 4  0.983618  0.744359]</span>
</pre></div>
</div>
<p>Unlike other io methods, <code class="docutils literal notranslate"><span class="pre">to_msgpack</span></code> is available on both a per-object basis,
<code class="docutils literal notranslate"><span class="pre">df.to_msgpack()</span></code> and using the top-level <code class="docutils literal notranslate"><span class="pre">pd.to_msgpack(...)</span></code> where you
can pack arbitrary collections of Python lists, dicts, scalars, while intermixing
pandas objects.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [355]: </span><span class="n">pd</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">(</span><span class="s1">&#39;foo2.msg&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dict&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;df&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
<span class="gp">   .....: </span>                                    <span class="p">{</span><span class="s1">&#39;scalar&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">s</span><span class="p">}]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [356]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="s1">&#39;foo2.msg&#39;</span><span class="p">)</span>
<span class="gh">Out[356]: </span><span class="go"></span>
<span class="go">{&#39;dict&#39;: ({&#39;df&#39;:           A         B</span>
<span class="go">   0  0.170801  0.895366</span>
<span class="go">   1  0.838238  0.052592</span>
<span class="go">   2  0.664140  0.289750</span>
<span class="go">   3  0.449593  0.872087</span>
<span class="go">   4  0.983618  0.744359},</span>
<span class="go">  {&#39;string&#39;: &#39;foo&#39;},</span>
<span class="go">  {&#39;scalar&#39;: 1.0},</span>
<span class="go">  {&#39;s&#39;: 2013-01-01    0.548134</span>
<span class="go">   2013-01-02    0.503447</span>
<span class="go">   2013-01-03    0.348438</span>
<span class="go">   2013-01-04    0.707267</span>
<span class="go">   2013-01-05    0.261656</span>
<span class="go">   Freq: D, dtype: float64})}</span>
</pre></div>
</div>
<div class="section" id="read-write-api">
<h3>Read/Write API<a class="headerlink" href="#read-write-api" title="Permalink to this headline">¶</a></h3>
<p>Msgpacks can also be read from and written to strings.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [357]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">()</span>
<span class="gh">Out[357]: </span><span class="go">b&#39;\x84\xa3typ\xadblock_manager\xa5klass\xa9DataFrame\xa4axes\x92\x86\xa3typ\xa5index\xa5klass\xa5Index\xa4name\xc0\xa5dtype\xa6object\xa4data\x92\xa1A\xa1B\xa8compress\xc0\x86\xa3typ\xabrange_index\xa5klass\xaaRangeIndex\xa4name\xc0\xa5start\x00\xa4stop\x05\xa4step\x01\xa6blocks\x91\x86\xa4locs\x86\xa3typ\xa7ndarray\xa5shape\x91\x02\xa4ndim\x01\xa5dtype\xa5int64\xa4data\xd8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\xa8compress\xc0\xa6values\xc7P\x00&lt;\xfd\xd2f\xcf\xdc\xc5?0\x15\xebN\xd9\xd2\xea?,\x9c\x16A\xa2@\xe5?\xd8/\xdd\xf4&quot;\xc6\xdc?\x11\x1e\x97\x1b\xcdy\xef?&amp;\x1e&lt;\xee\xd6\xa6\xec?p\xd3;\xb2N\xed\xaa?h\xcb\xb1\xbdB\x8b\xd2?\xaf4\x01r&quot;\xe8\xeb?)G6\xd9\xc9\xd1\xe7?\xa5shape\x92\x02\x05\xa5dtype\xa7float64\xa5klass\xaaFloatBlock\xa8compress\xc0&#39;</span>
</pre></div>
</div>
<p>Furthermore you can concatenate the strings to produce a list of the original objects.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [358]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_msgpack</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">()</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">to_msgpack</span><span class="p">())</span>
<span class="gh">Out[358]: </span><span class="go"></span>
<span class="go">[          A         B</span>
<span class="go"> 0  0.170801  0.895366</span>
<span class="go"> 1  0.838238  0.052592</span>
<span class="go"> 2  0.664140  0.289750</span>
<span class="go"> 3  0.449593  0.872087</span>
<span class="go"> 4  0.983618  0.744359, 2013-01-01    0.548134</span>
<span class="go"> 2013-01-02    0.503447</span>
<span class="go"> 2013-01-03    0.348438</span>
<span class="go"> 2013-01-04    0.707267</span>
<span class="go"> 2013-01-05    0.261656</span>
<span class="go"> Freq: D, dtype: float64]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hdf5-pytables">
<span id="io-hdf5"></span><h2>HDF5 (PyTables)<a class="headerlink" href="#hdf5-pytables" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> is a dict-like object which reads and writes pandas using
the high performance HDF5 format using the excellent <a class="reference external" href="https://www.pytables.org/">PyTables</a> library. See the <a class="reference internal" href="cookbook.html#cookbook-hdf"><span class="std std-ref">cookbook</span></a>
for some advanced strategies</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>pandas requires <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> &gt;= 3.0.0.
There is a indexing bug in <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> &lt; 3.2 which may appear when querying stores using an index.
If you see a subset of results being returned, upgrade to <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> &gt;= 3.2.
Stores created previously will need to be rewritten using the updated version.</p>
</div>
<pre class="literal-block">In [359]: store = pd.HDFStore('store.h5')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-359-54ac839dc497&gt; in &lt;module&gt;
----&gt; 1 store = pd.HDFStore('store.h5')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [360]: print(store)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-360-34a6349b9096&gt; in &lt;module&gt;
----&gt; 1 print(store)

NameError: name 'store' is not defined</pre>
<p>Objects can be written to the file just like adding key-value pairs to a
dict:</p>
<pre class="literal-block">In [361]: index = pd.date_range('1/1/2000', periods=8)

In [362]: s = pd.Series(np.random.randn(5), index=['a', 'b', 'c', 'd', 'e'])

In [363]: df = pd.DataFrame(np.random.randn(8, 3), index=index,
   .....:                   columns=['A', 'B', 'C'])
   .....: 

# store.put('s', s) is an equivalent method
In [364]: store['s'] = s
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-364-2bdbf26fda71&gt; in &lt;module&gt;
----&gt; 1 store['s'] = s

NameError: name 'store' is not defined

In [365]: store['df'] = df
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-365-02ded5cb794d&gt; in &lt;module&gt;
----&gt; 1 store['df'] = df

NameError: name 'store' is not defined

In [366]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-366-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined</pre>
<p>In a current or later Python session, you can retrieve stored objects:</p>
<pre class="literal-block"># store.get('df') is an equivalent method
In [367]: store['df']
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-367-1cc723079d4d&gt; in &lt;module&gt;
----&gt; 1 store['df']

NameError: name 'store' is not defined

# dotted (attribute) access provides get as well
In [368]: store.df
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-368-53088afd4d0c&gt; in &lt;module&gt;
----&gt; 1 store.df

NameError: name 'store' is not defined</pre>
<p>Deletion of the object specified by the key:</p>
<pre class="literal-block"># store.remove('df') is an equivalent method
In [369]: del store['df']
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-369-ebd3cc5c3ec8&gt; in &lt;module&gt;
----&gt; 1 del store['df']

NameError: name 'store' is not defined

In [370]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-370-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined</pre>
<p>Closing a Store and using a context manager:</p>
<pre class="literal-block">In [371]: store.close()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-371-7d09d9e55ce9&gt; in &lt;module&gt;
----&gt; 1 store.close()

NameError: name 'store' is not defined

In [372]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-372-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined

In [373]: store.is_open
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-373-11e2ce0fc911&gt; in &lt;module&gt;
----&gt; 1 store.is_open

NameError: name 'store' is not defined

# Working with, and automatically closing the store using a context manager
In [374]: with pd.HDFStore('store.h5') as store:
   .....:     store.keys()
   .....: 
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-374-e12c83740f64&gt; in &lt;module&gt;
----&gt; 1 with pd.HDFStore('store.h5') as store:
      2     store.keys()

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.</pre>
<div class="section" id="id3">
<h3>Read/Write API<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> supports an top-level API using  <code class="docutils literal notranslate"><span class="pre">read_hdf</span></code> for reading and <code class="docutils literal notranslate"><span class="pre">to_hdf</span></code> for writing,
similar to how <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> and <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> work.</p>
<pre class="literal-block">In [375]: df_tl = pd.DataFrame({'A': list(range(5)), 'B': list(range(5))})

In [376]: df_tl.to_hdf('store_tl.h5', 'table', append=True)
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-376-6a90542df09b&gt; in &lt;module&gt;
----&gt; 1 df_tl.to_hdf('store_tl.h5', 'table', append=True)

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_hdf(self, path_or_buf, key, **kwargs)
   2528         from pandas.io import pytables
   2529 
-&gt; 2530         pytables.to_hdf(path_or_buf, key, self, **kwargs)
   2531 
   2532     def to_msgpack(self, path_or_buf=None, encoding=&quot;utf-8&quot;, **kwargs):

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in to_hdf(path_or_buf, key, value, mode, complevel, complib, append, **kwargs)
    274     if isinstance(path_or_buf, str):
    275         with HDFStore(
--&gt; 276             path_or_buf, mode=mode, complevel=complevel, complib=complib
    277         ) as store:
    278             f(store)

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [377]: pd.read_hdf('store_tl.h5', 'table', where=['index&gt;2'])
---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
&lt;ipython-input-377-48dfc76f8b8f&gt; in &lt;module&gt;
----&gt; 1 pd.read_hdf('store_tl.h5', 'table', where=['index&gt;2'])

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in read_hdf(path_or_buf, key, mode, **kwargs)
    379         if not exists:
    380             raise FileNotFoundError(
--&gt; 381                 &quot;File {path} does not exist&quot;.format(path=path_or_buf)
    382             )
    383 

FileNotFoundError: File store_tl.h5 does not exist</pre>
<p>HDFStore will by default not drop rows that are all missing. This behavior can be changed by setting <code class="docutils literal notranslate"><span class="pre">dropna=True</span></code>.</p>
<pre class="literal-block">In [378]: df_with_missing = pd.DataFrame({'col1': [0, np.nan, 2],
   .....:                                 'col2': [1, np.nan, np.nan]})
   .....: 

In [379]: df_with_missing
Out[379]: 
   col1  col2
0   0.0   1.0
1   NaN   NaN
2   2.0   NaN

In [380]: df_with_missing.to_hdf('file.h5', 'df_with_missing',
   .....:                        format='table', mode='w')
   .....: 
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-380-d760b349c4a7&gt; in &lt;module&gt;
      1 df_with_missing.to_hdf('file.h5', 'df_with_missing',
----&gt; 2                        format='table', mode='w')

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_hdf(self, path_or_buf, key, **kwargs)
   2528         from pandas.io import pytables
   2529 
-&gt; 2530         pytables.to_hdf(path_or_buf, key, self, **kwargs)
   2531 
   2532     def to_msgpack(self, path_or_buf=None, encoding=&quot;utf-8&quot;, **kwargs):

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in to_hdf(path_or_buf, key, value, mode, complevel, complib, append, **kwargs)
    274     if isinstance(path_or_buf, str):
    275         with HDFStore(
--&gt; 276             path_or_buf, mode=mode, complevel=complevel, complib=complib
    277         ) as store:
    278             f(store)

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [381]: pd.read_hdf('file.h5', 'df_with_missing')
---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
&lt;ipython-input-381-59c725e9cc6c&gt; in &lt;module&gt;
----&gt; 1 pd.read_hdf('file.h5', 'df_with_missing')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in read_hdf(path_or_buf, key, mode, **kwargs)
    379         if not exists:
    380             raise FileNotFoundError(
--&gt; 381                 &quot;File {path} does not exist&quot;.format(path=path_or_buf)
    382             )
    383 

FileNotFoundError: File file.h5 does not exist

In [382]: df_with_missing.to_hdf('file.h5', 'df_with_missing',
   .....:                        format='table', mode='w', dropna=True)
   .....: 
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-382-263c86d5a881&gt; in &lt;module&gt;
      1 df_with_missing.to_hdf('file.h5', 'df_with_missing',
----&gt; 2                        format='table', mode='w', dropna=True)

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in to_hdf(self, path_or_buf, key, **kwargs)
   2528         from pandas.io import pytables
   2529 
-&gt; 2530         pytables.to_hdf(path_or_buf, key, self, **kwargs)
   2531 
   2532     def to_msgpack(self, path_or_buf=None, encoding=&quot;utf-8&quot;, **kwargs):

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in to_hdf(path_or_buf, key, value, mode, complevel, complib, append, **kwargs)
    274     if isinstance(path_or_buf, str):
    275         with HDFStore(
--&gt; 276             path_or_buf, mode=mode, complevel=complevel, complib=complib
    277         ) as store:
    278             f(store)

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [383]: pd.read_hdf('file.h5', 'df_with_missing')
---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
&lt;ipython-input-383-59c725e9cc6c&gt; in &lt;module&gt;
----&gt; 1 pd.read_hdf('file.h5', 'df_with_missing')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in read_hdf(path_or_buf, key, mode, **kwargs)
    379         if not exists:
    380             raise FileNotFoundError(
--&gt; 381                 &quot;File {path} does not exist&quot;.format(path=path_or_buf)
    382             )
    383 

FileNotFoundError: File file.h5 does not exist</pre>
</div>
<div class="section" id="fixed-format">
<span id="io-hdf5-fixed"></span><h3>Fixed Format<a class="headerlink" href="#fixed-format" title="Permalink to this headline">¶</a></h3>
<p>The examples above show storing using <code class="docutils literal notranslate"><span class="pre">put</span></code>, which write the HDF5 to <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> in a fixed array format, called
the <code class="docutils literal notranslate"><span class="pre">fixed</span></code> format. These types of stores are <strong>not</strong> appendable once written (though you can simply
remove them and rewrite). Nor are they <strong>queryable</strong>; they must be
retrieved in their entirety. They also do not support dataframes with non-unique column names.
The <code class="docutils literal notranslate"><span class="pre">fixed</span></code> format stores offer very fast writing and slightly faster reading than <code class="docutils literal notranslate"><span class="pre">table</span></code> stores.
This format is specified by default when using <code class="docutils literal notranslate"><span class="pre">put</span></code> or <code class="docutils literal notranslate"><span class="pre">to_hdf</span></code> or by <code class="docutils literal notranslate"><span class="pre">format='fixed'</span></code> or <code class="docutils literal notranslate"><span class="pre">format='f'</span></code>.</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>A <code class="docutils literal notranslate"><span class="pre">fixed</span></code> format will raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> if you try to retrieve using a <code class="docutils literal notranslate"><span class="pre">where</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;index&gt;5&#39;</span><span class="p">)</span>
<span class="go">TypeError: cannot pass a where specification when reading a fixed format.</span>
<span class="go">           this store must be selected in its entirety</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="table-format">
<span id="io-hdf5-table"></span><h3>Table Format<a class="headerlink" href="#table-format" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> supports another <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> format on disk, the <code class="docutils literal notranslate"><span class="pre">table</span></code>
format. Conceptually a <code class="docutils literal notranslate"><span class="pre">table</span></code> is shaped very much like a DataFrame,
with rows and columns. A <code class="docutils literal notranslate"><span class="pre">table</span></code> may be appended to in the same or
other sessions.  In addition, delete and query type operations are
supported. This format is specified by <code class="docutils literal notranslate"><span class="pre">format='table'</span></code> or <code class="docutils literal notranslate"><span class="pre">format='t'</span></code>
to <code class="docutils literal notranslate"><span class="pre">append</span></code> or <code class="docutils literal notranslate"><span class="pre">put</span></code> or <code class="docutils literal notranslate"><span class="pre">to_hdf</span></code>.</p>
<p>This format can be set as an option as well <code class="docutils literal notranslate"><span class="pre">pd.set_option('io.hdf.default_format','table')</span></code> to
enable <code class="docutils literal notranslate"><span class="pre">put/append/to_hdf</span></code> to by default store in the <code class="docutils literal notranslate"><span class="pre">table</span></code> format.</p>
<pre class="literal-block">In [384]: store = pd.HDFStore('store.h5')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-384-54ac839dc497&gt; in &lt;module&gt;
----&gt; 1 store = pd.HDFStore('store.h5')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [385]: df1 = df[0:4]

In [386]: df2 = df[4:]

# append data (creates a table automatically)
In [387]: store.append('df', df1)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-387-5d2670dce5e2&gt; in &lt;module&gt;
----&gt; 1 store.append('df', df1)

NameError: name 'store' is not defined

In [388]: store.append('df', df2)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-388-d0e0be4a91a9&gt; in &lt;module&gt;
----&gt; 1 store.append('df', df2)

NameError: name 'store' is not defined

In [389]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-389-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined

# select the entire object
In [390]: store.select('df')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-390-217756ae0052&gt; in &lt;module&gt;
----&gt; 1 store.select('df')

NameError: name 'store' is not defined

# the type of stored data
In [391]: store.root.df._v_attrs.pandas_type
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-391-ef62b5b0aab6&gt; in &lt;module&gt;
----&gt; 1 store.root.df._v_attrs.pandas_type

NameError: name 'store' is not defined</pre>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>You can also create a <code class="docutils literal notranslate"><span class="pre">table</span></code> by passing <code class="docutils literal notranslate"><span class="pre">format='table'</span></code> or <code class="docutils literal notranslate"><span class="pre">format='t'</span></code> to a <code class="docutils literal notranslate"><span class="pre">put</span></code> operation.</p>
</div>
</div>
<div class="section" id="hierarchical-keys">
<span id="io-hdf5-keys"></span><h3>Hierarchical Keys<a class="headerlink" href="#hierarchical-keys" title="Permalink to this headline">¶</a></h3>
<p>Keys to a store can be specified as a string. These can be in a
hierarchical path-name like format (e.g. <code class="docutils literal notranslate"><span class="pre">foo/bar/bah</span></code>), which will
generate a hierarchy of sub-stores (or <code class="docutils literal notranslate"><span class="pre">Groups</span></code> in PyTables
parlance). Keys can be specified with out the leading ‘/’ and are <strong>always</strong>
absolute (e.g. ‘foo’ refers to ‘/foo’). Removal operations can remove
everything in the sub-store and <strong>below</strong>, so be <em>careful</em>.</p>
<pre class="literal-block">In [392]: store.put('foo/bar/bah', df)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-392-e34dc8f9055e&gt; in &lt;module&gt;
----&gt; 1 store.put('foo/bar/bah', df)

NameError: name 'store' is not defined

In [393]: store.append('food/orange', df)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-393-dcad8aaa721a&gt; in &lt;module&gt;
----&gt; 1 store.append('food/orange', df)

NameError: name 'store' is not defined

In [394]: store.append('food/apple', df)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-394-b3de712d0d57&gt; in &lt;module&gt;
----&gt; 1 store.append('food/apple', df)

NameError: name 'store' is not defined

In [395]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-395-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined

# a list of keys are returned
In [396]: store.keys()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-396-0aa828311813&gt; in &lt;module&gt;
----&gt; 1 store.keys()

NameError: name 'store' is not defined

# remove all nodes under this level
In [397]: store.remove('food')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-397-f156e07a9855&gt; in &lt;module&gt;
----&gt; 1 store.remove('food')

NameError: name 'store' is not defined

In [398]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-398-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined</pre>
<p>You can walk through the group hierarchy using the <code class="docutils literal notranslate"><span class="pre">walk</span></code> method which
will yield a tuple for each group key along with the relative keys of its contents.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.0.</span></p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [399]: </span><span class="k">for</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">subgroups</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">)</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">walk</span><span class="p">():</span>
<span class="gp">   .....: </span>    <span class="k">for</span> <span class="n">subgroup</span> <span class="ow">in</span> <span class="n">subgroups</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;GROUP: {}/{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">subgroup</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="k">for</span> <span class="n">subkey</span> <span class="ow">in</span> <span class="n">subkeys</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path</span><span class="p">,</span> <span class="n">subkey</span><span class="p">])</span>
<span class="gp">   .....: </span>        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;KEY: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="gp">   .....: </span>        <span class="k">print</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="gp">   .....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">399</span><span class="o">-</span><span class="mi">2</span><span class="n">d918dbe0f51</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">for</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">subgroups</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">)</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">walk</span><span class="p">():</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="k">for</span> <span class="n">subgroup</span> <span class="ow">in</span> <span class="n">subgroups</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>         <span class="k">print</span><span class="p">(</span><span class="s1">&#39;GROUP: {}/{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">subgroup</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="k">for</span> <span class="n">subkey</span> <span class="ow">in</span> <span class="n">subkeys</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>         <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path</span><span class="p">,</span> <span class="n">subkey</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Hierarchical keys cannot be retrieved as dotted (attribute) access as described above for items stored under the root node.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">store</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">bah</span>
<span class="go">AttributeError: &#39;HDFStore&#39; object has no attribute &#39;foo&#39;</span>

<span class="go"># you can directly access the actual PyTables node but using the root node</span>
<span class="gp">In [9]: </span><span class="n">store</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">bah</span>
<span class="gh">Out[9]:</span>
<span class="go">/foo/bar/bah (Group) &#39;&#39;</span>
<span class="go">  children := [&#39;block0_items&#39; (Array), &#39;block0_values&#39; (Array), &#39;axis0&#39; (Array), &#39;axis1&#39; (Array)]</span>
</pre></div>
</div>
<p>Instead, use explicit string based keys:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [400]: </span><span class="n">store</span><span class="p">[</span><span class="s1">&#39;foo/bar/bah&#39;</span><span class="p">]</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">400</span><span class="o">-</span><span class="n">d4ee51f6bb0c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="p">[</span><span class="s1">&#39;foo/bar/bah&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="storing-types">
<span id="io-hdf5-types"></span><h3>Storing Types<a class="headerlink" href="#storing-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="storing-mixed-types-in-a-table">
<h4>Storing Mixed Types in a Table<a class="headerlink" href="#storing-mixed-types-in-a-table" title="Permalink to this headline">¶</a></h4>
<p>Storing mixed-dtype data is supported. Strings are stored as a
fixed-width using the maximum size of the appended column. Subsequent attempts
at appending longer strings will raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">min_itemsize={`values`:</span> <span class="pre">size}</span></code> as a parameter to append
will set a larger minimum for the string columns. Storing <code class="docutils literal notranslate"><span class="pre">floats,</span>
<span class="pre">strings,</span> <span class="pre">ints,</span> <span class="pre">bools,</span> <span class="pre">datetime64</span></code> are currently supported. For string
columns, passing <code class="docutils literal notranslate"><span class="pre">nan_rep</span> <span class="pre">=</span> <span class="pre">'nan'</span></code> to append will change the default
nan representation on disk (which converts to/from <cite>np.nan</cite>), this
defaults to <cite>nan</cite>.</p>
<pre class="literal-block">In [401]: df_mixed = pd.DataFrame({'A': np.random.randn(8),
   .....:                          'B': np.random.randn(8),
   .....:                          'C': np.array(np.random.randn(8), dtype='float32'),
   .....:                          'string': 'string',
   .....:                          'int': 1,
   .....:                          'bool': True,
   .....:                          'datetime64': pd.Timestamp('20010102')},
   .....:                         index=list(range(8)))
   .....: 

In [402]: df_mixed.loc[df_mixed.index[3:5],
   .....:              ['A', 'B', 'string', 'datetime64']] = np.nan
   .....: 

In [403]: store.append('df_mixed', df_mixed, min_itemsize={'values': 50})
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-403-84f39588825d&gt; in &lt;module&gt;
----&gt; 1 store.append('df_mixed', df_mixed, min_itemsize={'values': 50})

NameError: name 'store' is not defined

In [404]: df_mixed1 = store.select('df_mixed')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-404-8540a95eefa5&gt; in &lt;module&gt;
----&gt; 1 df_mixed1 = store.select('df_mixed')

NameError: name 'store' is not defined

In [405]: df_mixed1
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-405-7c2d528034e6&gt; in &lt;module&gt;
----&gt; 1 df_mixed1

NameError: name 'df_mixed1' is not defined

In [406]: df_mixed1.get_dtype_counts()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-406-a92e264df819&gt; in &lt;module&gt;
----&gt; 1 df_mixed1.get_dtype_counts()

NameError: name 'df_mixed1' is not defined

# we have provided a minimum string column size
In [407]: store.root.df_mixed.table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-407-eb0bb4c187f7&gt; in &lt;module&gt;
----&gt; 1 store.root.df_mixed.table

NameError: name 'store' is not defined</pre>
</div>
<div class="section" id="storing-multiindex-dataframes">
<h4>Storing MultiIndex DataFrames<a class="headerlink" href="#storing-multiindex-dataframes" title="Permalink to this headline">¶</a></h4>
<p>Storing MultiIndex <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> as tables is very similar to
storing/selecting from homogeneous index <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>.</p>
<pre class="literal-block">In [408]: index = pd.MultiIndex(levels=[['foo', 'bar', 'baz', 'qux'],
   .....:                               ['one', 'two', 'three']],
   .....:                       codes=[[0, 0, 0, 1, 1, 2, 2, 3, 3, 3],
   .....:                              [0, 1, 2, 0, 1, 1, 2, 0, 1, 2]],
   .....:                       names=['foo', 'bar'])
   .....: 

In [409]: df_mi = pd.DataFrame(np.random.randn(10, 3), index=index,
   .....:                      columns=['A', 'B', 'C'])
   .....: 

In [410]: df_mi
Out[410]: 
                  A         B         C
foo bar                                
foo one   -1.644393 -0.311536 -0.615506
    two   -0.084551 -1.318575  0.923929
    three -0.105981  0.429424 -1.034590
bar one    0.542245 -0.384429  0.170697
    two   -0.200289  1.220322 -1.001273
baz two    0.162172  0.376816 -0.161614
    three -1.636805  0.835417  0.864817
qux one    0.843452 -0.122918 -0.026122
    two   -1.507533  0.335303 -1.340566
    three -1.024989  1.125351 -0.585357

In [411]: store.append('df_mi', df_mi)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-411-3b47a988298a&gt; in &lt;module&gt;
----&gt; 1 store.append('df_mi', df_mi)

NameError: name 'store' is not defined

In [412]: store.select('df_mi')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-412-07196865d252&gt; in &lt;module&gt;
----&gt; 1 store.select('df_mi')

NameError: name 'store' is not defined

# the levels are automatically included as data columns
In [413]: store.select('df_mi', 'foo=bar')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-413-515b984b10eb&gt; in &lt;module&gt;
----&gt; 1 store.select('df_mi', 'foo=bar')

NameError: name 'store' is not defined</pre>
</div>
</div>
<div class="section" id="querying">
<span id="io-hdf5-query"></span><h3>Querying<a class="headerlink" href="#querying" title="Permalink to this headline">¶</a></h3>
<div class="section" id="querying-a-table">
<h4>Querying a Table<a class="headerlink" href="#querying-a-table" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">select</span></code> and <code class="docutils literal notranslate"><span class="pre">delete</span></code> operations have an optional criterion that can
be specified to select/delete only a subset of the data. This allows one
to have a very large on-disk table and retrieve only a portion of the
data.</p>
<p>A query is specified using the <code class="docutils literal notranslate"><span class="pre">Term</span></code> class under the hood, as a boolean expression.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> and <code class="docutils literal notranslate"><span class="pre">columns</span></code> are supported indexers of a <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code>.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">data_columns</span></code> are specified, these can be used as additional indexers.</p></li>
</ul>
<p>Valid comparison operators are:</p>
<p><code class="docutils literal notranslate"><span class="pre">=,</span> <span class="pre">==,</span> <span class="pre">!=,</span> <span class="pre">&gt;,</span> <span class="pre">&gt;=,</span> <span class="pre">&lt;,</span> <span class="pre">&lt;=</span></code></p>
<p>Valid boolean expressions are combined with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> : or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code> : and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(</span></code> and <code class="docutils literal notranslate"><span class="pre">)</span></code> : for grouping</p></li>
</ul>
<p>These rules are similar to how boolean expressions are used in pandas for indexing.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">=</span></code> will be automatically expanded to the comparison operator <code class="docutils literal notranslate"><span class="pre">==</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~</span></code> is the not operator, but can only be used in very limited
circumstances</p></li>
<li><p>If a list/tuple of expressions is passed they will be combined via <code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></li>
</ul>
</div>
<p>The following are valid expressions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'index</span> <span class="pre">&gt;=</span> <span class="pre">date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;columns</span> <span class="pre">=</span> <span class="pre">['A',</span> <span class="pre">'D']&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;columns</span> <span class="pre">in</span> <span class="pre">['A',</span> <span class="pre">'D']&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'columns</span> <span class="pre">=</span> <span class="pre">A'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'columns</span> <span class="pre">==</span> <span class="pre">A'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;~(columns</span> <span class="pre">=</span> <span class="pre">['A',</span> <span class="pre">'B'])&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'index</span> <span class="pre">&gt;</span> <span class="pre">df.index[3]</span> <span class="pre">&amp;</span> <span class="pre">string</span> <span class="pre">=</span> <span class="pre">&quot;bar&quot;'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'(index</span> <span class="pre">&gt;</span> <span class="pre">df.index[3]</span> <span class="pre">&amp;</span> <span class="pre">index</span> <span class="pre">&lt;=</span> <span class="pre">df.index[6])</span> <span class="pre">|</span> <span class="pre">string</span> <span class="pre">=</span> <span class="pre">&quot;bar&quot;'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ts</span> <span class="pre">&gt;=</span> <span class="pre">Timestamp('2012-02-01')&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;major_axis&gt;=20130101&quot;</span></code></p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">indexers</span></code> are on the left-hand side of the sub-expression:</p>
<p><code class="docutils literal notranslate"><span class="pre">columns</span></code>, <code class="docutils literal notranslate"><span class="pre">major_axis</span></code>, <code class="docutils literal notranslate"><span class="pre">ts</span></code></p>
<p>The right-hand side of the sub-expression (after a comparison operator) can be:</p>
<ul class="simple">
<li><p>functions that will be evaluated, e.g. <code class="docutils literal notranslate"><span class="pre">Timestamp('2012-02-01')</span></code></p></li>
<li><p>strings, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;bar&quot;</span></code></p></li>
<li><p>date-like, e.g. <code class="docutils literal notranslate"><span class="pre">20130101</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;20130101&quot;</span></code></p></li>
<li><p>lists, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;['A',</span> <span class="pre">'B']&quot;</span></code></p></li>
<li><p>variables that are defined in the local names space, e.g. <code class="docutils literal notranslate"><span class="pre">date</span></code></p></li>
</ul>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Passing a string to a query by interpolating it into the query
expression is not recommended. Simply assign the string of interest to a
variable and use that variable in an expression. For example, do this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;HolyMoly&#39;&quot;</span>
<span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;index == string&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>instead of this</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;HolyMoly&#39;&quot;</span>
<span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;index == </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
<p>The latter will <strong>not</strong> work and will raise a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>.Note that
there’s a single quote followed by a double quote in the <code class="docutils literal notranslate"><span class="pre">string</span></code>
variable.</p>
<p>If you <em>must</em> interpolate, use the <code class="docutils literal notranslate"><span class="pre">'%r'</span></code> format specifier</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;index == </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
<p>which will quote <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
</div>
<p>Here are some examples:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [414]: </span><span class="n">dfq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                   <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [415]: </span><span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="n">dfq</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">data_columns</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">415</span><span class="o">-</span><span class="mi">82</span><span class="n">c5e5a63f3a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="n">dfq</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">data_columns</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<p>Use boolean expressions, with in-line function evaluation.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [416]: </span><span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="s2">&quot;index&gt;pd.Timestamp(&#39;20130104&#39;) &amp; columns=[&#39;A&#39;, &#39;B&#39;]&quot;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">416</span><span class="o">-</span><span class="mi">31</span><span class="n">fefd59cc8b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="s2">&quot;index&gt;pd.Timestamp(&#39;20130104&#39;) &amp; columns=[&#39;A&#39;, &#39;B&#39;]&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<p>Use and inline column reference</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [417]: </span><span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s2">&quot;A&gt;0 or C&gt;0&quot;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">417</span><span class="o">-</span><span class="mi">9335</span><span class="n">f8ce7ae3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;dfq&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s2">&quot;A&gt;0 or C&gt;0&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">columns</span></code> keyword can be supplied to select a list of columns to be
returned, this is equivalent to passing a
<code class="docutils literal notranslate"><span class="pre">'columns=list_of_columns_to_filter'</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [418]: </span><span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s2">&quot;columns=[&#39;A&#39;, &#39;B&#39;]&quot;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">418</span><span class="o">-</span><span class="mi">8</span><span class="n">f20fee3a6a5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s2">&quot;columns=[&#39;A&#39;, &#39;B&#39;]&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code> parameters can be specified to limit the total search
space. These are in terms of the total number of rows in a table.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">select</span></code> will raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if the query expression has an unknown
variable reference. Usually this means that you are trying to select on a column
that is <strong>not</strong> a data_column.</p>
<p><code class="docutils literal notranslate"><span class="pre">select</span></code> will raise a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code> if the query expression is not valid.</p>
</div>
</div>
<div class="section" id="using-timedelta64-ns">
<span id="io-hdf5-timedelta"></span><h4>Using timedelta64[ns]<a class="headerlink" href="#using-timedelta64-ns" title="Permalink to this headline">¶</a></h4>
<p>You can store and query using the <code class="docutils literal notranslate"><span class="pre">timedelta64[ns]</span></code> type. Terms can be
specified in the format: <code class="docutils literal notranslate"><span class="pre">&lt;float&gt;(&lt;unit&gt;)</span></code>, where float may be signed (and fractional), and unit can be
<code class="docutils literal notranslate"><span class="pre">D,s,ms,us,ns</span></code> for the timedelta. Here’s an example:</p>
<pre class="literal-block">In [419]: from datetime import timedelta

In [420]: dftd = pd.DataFrame({'A': pd.Timestamp('20130101'),
   .....:                      'B': [pd.Timestamp('20130101') + timedelta(days=i,
   .....:                                                                 seconds=10)
   .....:                            for i in range(10)]})
   .....: 

In [421]: dftd['C'] = dftd['A'] - dftd['B']

In [422]: dftd
Out[422]: 
           A                   B                  C
0 2013-01-01 2013-01-01 00:00:10  -1 days +23:59:50
1 2013-01-01 2013-01-02 00:00:10  -2 days +23:59:50
2 2013-01-01 2013-01-03 00:00:10  -3 days +23:59:50
3 2013-01-01 2013-01-04 00:00:10  -4 days +23:59:50
4 2013-01-01 2013-01-05 00:00:10  -5 days +23:59:50
5 2013-01-01 2013-01-06 00:00:10  -6 days +23:59:50
6 2013-01-01 2013-01-07 00:00:10  -7 days +23:59:50
7 2013-01-01 2013-01-08 00:00:10  -8 days +23:59:50
8 2013-01-01 2013-01-09 00:00:10  -9 days +23:59:50
9 2013-01-01 2013-01-10 00:00:10 -10 days +23:59:50

In [423]: store.append('dftd', dftd, data_columns=True)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-423-2f9a092b0b0c&gt; in &lt;module&gt;
----&gt; 1 store.append('dftd', dftd, data_columns=True)

NameError: name 'store' is not defined

In [424]: store.select('dftd', &quot;C&lt;'-3.5D'&quot;)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-424-2a9409d9d4cc&gt; in &lt;module&gt;
----&gt; 1 store.select('dftd', &quot;C&lt;'-3.5D'&quot;)

NameError: name 'store' is not defined</pre>
</div>
<div class="section" id="indexing">
<h4>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h4>
<p>You can create/modify an index for a table with <code class="docutils literal notranslate"><span class="pre">create_table_index</span></code>
after data is already in the table (after and <code class="docutils literal notranslate"><span class="pre">append/put</span></code>
operation). Creating a table index is <strong>highly</strong> encouraged. This will
speed your queries a great deal when you use a <code class="docutils literal notranslate"><span class="pre">select</span></code> with the
indexed dimension as the <code class="docutils literal notranslate"><span class="pre">where</span></code>.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Indexes are automagically created on the indexables
and any data columns you specify. This behavior can be turned off by passing
<code class="docutils literal notranslate"><span class="pre">index=False</span></code> to <code class="docutils literal notranslate"><span class="pre">append</span></code>.</p>
</div>
<pre class="literal-block"># we have automagically already created an index (in the first section)
In [425]: i = store.root.df.table.cols.index.index
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-425-df460de23e31&gt; in &lt;module&gt;
----&gt; 1 i = store.root.df.table.cols.index.index

NameError: name 'store' is not defined

In [426]: i.optlevel, i.kind
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-426-18f1f93c3266&gt; in &lt;module&gt;
----&gt; 1 i.optlevel, i.kind

AttributeError: 'DatetimeIndex' object has no attribute 'optlevel'

# change an index by passing new parameters
In [427]: store.create_table_index('df', optlevel=9, kind='full')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-427-9d3aefb100d8&gt; in &lt;module&gt;
----&gt; 1 store.create_table_index('df', optlevel=9, kind='full')

NameError: name 'store' is not defined

In [428]: i = store.root.df.table.cols.index.index
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-428-df460de23e31&gt; in &lt;module&gt;
----&gt; 1 i = store.root.df.table.cols.index.index

NameError: name 'store' is not defined

In [429]: i.optlevel, i.kind
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-429-18f1f93c3266&gt; in &lt;module&gt;
----&gt; 1 i.optlevel, i.kind

AttributeError: 'DatetimeIndex' object has no attribute 'optlevel'</pre>
<p>Oftentimes when appending large amounts of data to a store, it is useful to turn off index creation for each append, then recreate at the end.</p>
<pre class="literal-block">In [430]: df_1 = pd.DataFrame(np.random.randn(10, 2), columns=list('AB'))

In [431]: df_2 = pd.DataFrame(np.random.randn(10, 2), columns=list('AB'))

In [432]: st = pd.HDFStore('appends.h5', mode='w')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-432-be0dd03dac58&gt; in &lt;module&gt;
----&gt; 1 st = pd.HDFStore('appends.h5', mode='w')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [433]: st.append('df', df_1, data_columns=['B'], index=False)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-433-57eea5b3943f&gt; in &lt;module&gt;
----&gt; 1 st.append('df', df_1, data_columns=['B'], index=False)

NameError: name 'st' is not defined

In [434]: st.append('df', df_2, data_columns=['B'], index=False)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-434-b819d1a883ed&gt; in &lt;module&gt;
----&gt; 1 st.append('df', df_2, data_columns=['B'], index=False)

NameError: name 'st' is not defined

In [435]: st.get_storer('df').table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-435-a9163e299a37&gt; in &lt;module&gt;
----&gt; 1 st.get_storer('df').table

NameError: name 'st' is not defined</pre>
<p>Then create the index when finished appending.</p>
<pre class="literal-block">In [436]: st.create_table_index('df', columns=['B'], optlevel=9, kind='full')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-436-99f7165ea423&gt; in &lt;module&gt;
----&gt; 1 st.create_table_index('df', columns=['B'], optlevel=9, kind='full')

NameError: name 'st' is not defined

In [437]: st.get_storer('df').table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-437-a9163e299a37&gt; in &lt;module&gt;
----&gt; 1 st.get_storer('df').table

NameError: name 'st' is not defined

In [438]: st.close()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-438-5daf6d1e2155&gt; in &lt;module&gt;
----&gt; 1 st.close()

NameError: name 'st' is not defined</pre>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index">here</a> for how to create a completely-sorted-index (CSI) on an existing store.</p>
</div>
<div class="section" id="query-via-data-columns">
<span id="io-hdf5-query-data-columns"></span><h4>Query via Data Columns<a class="headerlink" href="#query-via-data-columns" title="Permalink to this headline">¶</a></h4>
<p>You can designate (and index) certain columns that you want to be able
to perform queries (other than the <cite>indexable</cite> columns, which you can
always query). For instance say you want to perform this common
operation, on-disk, and return just the frame that matches this
query. You can specify <code class="docutils literal notranslate"><span class="pre">data_columns</span> <span class="pre">=</span> <span class="pre">True</span></code> to force all columns to
be <code class="docutils literal notranslate"><span class="pre">data_columns</span></code>.</p>
<pre class="literal-block">In [439]: df_dc = df.copy()

In [440]: df_dc['string'] = 'foo'

In [441]: df_dc.loc[df_dc.index[4:6], 'string'] = np.nan

In [442]: df_dc.loc[df_dc.index[7:9], 'string'] = 'bar'

In [443]: df_dc['string2'] = 'cool'

In [444]: df_dc.loc[df_dc.index[1:3], ['B', 'C']] = 1.0

In [445]: df_dc
Out[445]: 
                   A         B         C string string2
2000-01-01  0.954551  0.859671 -1.170458    foo    cool
2000-01-02 -1.211386  1.000000  1.000000    foo    cool
2000-01-03  1.064650  1.000000  1.000000    foo    cool
2000-01-04  0.254343 -0.875526 -0.980856    foo    cool
2000-01-05 -0.906920  0.988185 -1.596540    NaN    cool
2000-01-06  0.205007 -0.772889 -0.043509    NaN    cool
2000-01-07  0.768606  0.298656 -1.294022    foo    cool
2000-01-08 -0.618845  1.122438 -0.914616    bar    cool

# on-disk operations
In [446]: store.append('df_dc', df_dc, data_columns=['B', 'C', 'string', 'string2'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-446-f4f595672983&gt; in &lt;module&gt;
----&gt; 1 store.append('df_dc', df_dc, data_columns=['B', 'C', 'string', 'string2'])

NameError: name 'store' is not defined

In [447]: store.select('df_dc', where='B &gt; 0')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-447-ec03c35decfc&gt; in &lt;module&gt;
----&gt; 1 store.select('df_dc', where='B &gt; 0')

NameError: name 'store' is not defined

# getting creative
In [448]: store.select('df_dc', 'B &gt; 0 &amp; C &gt; 0 &amp; string == foo')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-448-ff1ed859b7a9&gt; in &lt;module&gt;
----&gt; 1 store.select('df_dc', 'B &gt; 0 &amp; C &gt; 0 &amp; string == foo')

NameError: name 'store' is not defined

# this is in-memory version of this type of selection
In [449]: df_dc[(df_dc.B &gt; 0) &amp; (df_dc.C &gt; 0) &amp; (df_dc.string == 'foo')]
Out[449]: 
                   A    B    C string string2
2000-01-02 -1.211386  1.0  1.0    foo    cool
2000-01-03  1.064650  1.0  1.0    foo    cool

# we have automagically created this index and the B/C/string/string2
# columns are stored separately as ``PyTables`` columns
In [450]: store.root.df_dc.table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-450-77ef75f2a289&gt; in &lt;module&gt;
----&gt; 1 store.root.df_dc.table

NameError: name 'store' is not defined</pre>
<p>There is some performance degradation by making lots of columns into
<cite>data columns</cite>, so it is up to the user to designate these. In addition,
you cannot change data columns (nor indexables) after the first
append/put operation (Of course you can simply read in the data and
create a new table!).</p>
</div>
<div class="section" id="iterator">
<h4>Iterator<a class="headerlink" href="#iterator" title="Permalink to this headline">¶</a></h4>
<p>You can pass <code class="docutils literal notranslate"><span class="pre">iterator=True</span></code> or <code class="docutils literal notranslate"><span class="pre">chunksize=number_in_a_chunk</span></code>
to <code class="docutils literal notranslate"><span class="pre">select</span></code> and <code class="docutils literal notranslate"><span class="pre">select_as_multiple</span></code> to return an iterator on the results.
The default is 50,000 rows returned in a chunk.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [451]: </span><span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">451</span><span class="o">-</span><span class="mf">4e0</span><span class="n">e7b0a8a32</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>You can also use the iterator with <code class="docutils literal notranslate"><span class="pre">read_hdf</span></code> which will open, then
automatically close the store when finished iterating.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;store.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note, that the chunksize keyword applies to the <strong>source</strong> rows. So if you
are doing a query, then the chunksize will subdivide the total rows in the table
and the query applied, returning an iterator on potentially unequal sized chunks.</p>
<p>Here is a recipe for generating a query and using it to create equal sized return
chunks.</p>
<pre class="literal-block">In [452]: dfeq = pd.DataFrame({'number': np.arange(1, 11)})

In [453]: dfeq
Out[453]: 
   number
0       1
1       2
2       3
3       4
4       5
5       6
6       7
7       8
8       9
9      10

In [454]: store.append('dfeq', dfeq, data_columns=['number'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-454-7e47358a30c7&gt; in &lt;module&gt;
----&gt; 1 store.append('dfeq', dfeq, data_columns=['number'])

NameError: name 'store' is not defined

In [455]: def chunks(l, n):
   .....:     return [l[i:i + n] for i in range(0, len(l), n)]
   .....: 

In [456]: evens = [2, 4, 6, 8, 10]

In [457]: coordinates = store.select_as_coordinates('dfeq', 'number=evens')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-457-18616f8f97fd&gt; in &lt;module&gt;
----&gt; 1 coordinates = store.select_as_coordinates('dfeq', 'number=evens')

NameError: name 'store' is not defined

In [458]: for c in chunks(coordinates, 2):
   .....:     print(store.select('dfeq', where=c))
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-458-caf9949119a3&gt; in &lt;module&gt;
----&gt; 1 for c in chunks(coordinates, 2):
      2     print(store.select('dfeq', where=c))

NameError: name 'coordinates' is not defined</pre>
</div>
<div class="section" id="advanced-queries">
<h4>Advanced Queries<a class="headerlink" href="#advanced-queries" title="Permalink to this headline">¶</a></h4>
<div class="section" id="select-a-single-column">
<h5>Select a Single Column<a class="headerlink" href="#select-a-single-column" title="Permalink to this headline">¶</a></h5>
<p>To retrieve a single indexable or data column, use the
method <code class="docutils literal notranslate"><span class="pre">select_column</span></code>. This will, for example, enable you to get the index
very quickly. These return a <code class="docutils literal notranslate"><span class="pre">Series</span></code> of the result, indexed by the row number.
These do not currently accept the <code class="docutils literal notranslate"><span class="pre">where</span></code> selector.</p>
<pre class="literal-block">In [459]: store.select_column('df_dc', 'index')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-459-471e895df9a6&gt; in &lt;module&gt;
----&gt; 1 store.select_column('df_dc', 'index')

NameError: name 'store' is not defined

In [460]: store.select_column('df_dc', 'string')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-460-bca5961a1371&gt; in &lt;module&gt;
----&gt; 1 store.select_column('df_dc', 'string')

NameError: name 'store' is not defined</pre>
</div>
<div class="section" id="selecting-coordinates">
<span id="io-hdf5-selecting-coordinates"></span><h5>Selecting coordinates<a class="headerlink" href="#selecting-coordinates" title="Permalink to this headline">¶</a></h5>
<p>Sometimes you want to get the coordinates (a.k.a the index locations) of your query. This returns an
<code class="docutils literal notranslate"><span class="pre">Int64Index</span></code> of the resulting locations. These coordinates can also be passed to subsequent
<code class="docutils literal notranslate"><span class="pre">where</span></code> operations.</p>
<pre class="literal-block">In [461]: df_coord = pd.DataFrame(np.random.randn(1000, 2),
   .....:                         index=pd.date_range('20000101', periods=1000))
   .....: 

In [462]: store.append('df_coord', df_coord)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-462-92517ada9e7b&gt; in &lt;module&gt;
----&gt; 1 store.append('df_coord', df_coord)

NameError: name 'store' is not defined

In [463]: c = store.select_as_coordinates('df_coord', 'index &gt; 20020101')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-463-5a37e7982f8c&gt; in &lt;module&gt;
----&gt; 1 c = store.select_as_coordinates('df_coord', 'index &gt; 20020101')

NameError: name 'store' is not defined

In [464]: c
Out[464]: 
[b, c, a, b]
Categories (3, object): [b, c, a]

In [465]: store.select('df_coord', where=c)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-465-12a0dfd76804&gt; in &lt;module&gt;
----&gt; 1 store.select('df_coord', where=c)

NameError: name 'store' is not defined</pre>
</div>
<div class="section" id="selecting-using-a-where-mask">
<span id="io-hdf5-where-mask"></span><h5>Selecting using a where mask<a class="headerlink" href="#selecting-using-a-where-mask" title="Permalink to this headline">¶</a></h5>
<p>Sometime your query can involve creating a list of rows to select. Usually this <code class="docutils literal notranslate"><span class="pre">mask</span></code> would
be a resulting <code class="docutils literal notranslate"><span class="pre">index</span></code> from an indexing operation. This example selects the months of
a datetimeindex which are 5.</p>
<pre class="literal-block">In [466]: df_mask = pd.DataFrame(np.random.randn(1000, 2),
   .....:                        index=pd.date_range('20000101', periods=1000))
   .....: 

In [467]: store.append('df_mask', df_mask)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-467-d845638bd163&gt; in &lt;module&gt;
----&gt; 1 store.append('df_mask', df_mask)

NameError: name 'store' is not defined

In [468]: c = store.select_column('df_mask', 'index')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-468-02fa60af8861&gt; in &lt;module&gt;
----&gt; 1 c = store.select_column('df_mask', 'index')

NameError: name 'store' is not defined

In [469]: where = c[pd.DatetimeIndex(c).month == 5].index
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
~/miniconda/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py in objects_to_datetime64ns(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object)
   1978         try:
-&gt; 1979             values, tz_parsed = conversion.datetime_to_datetime64(data)
   1980             # If tzaware, these values represent unix timestamps, so we

pandas/_libs/tslibs/conversion.pyx in pandas._libs.tslibs.conversion.datetime_to_datetime64()

TypeError: Unrecognized value type: &lt;class 'str'&gt;

During handling of the above exception, another exception occurred:

ParserError                               Traceback (most recent call last)
&lt;ipython-input-469-74cb6f2edb69&gt; in &lt;module&gt;
----&gt; 1 where = c[pd.DatetimeIndex(c).month == 5].index

~/miniconda/lib/python3.7/site-packages/pandas/core/indexes/datetimes.py in __new__(cls, data, freq, start, end, periods, tz, normalize, closed, ambiguous, dayfirst, yearfirst, dtype, copy, name, verify_integrity)
    332             yearfirst=yearfirst,
    333             ambiguous=ambiguous,
--&gt; 334             int_as_wall_time=True,
    335         )
    336 

~/miniconda/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py in _from_sequence(cls, data, dtype, copy, tz, freq, dayfirst, yearfirst, ambiguous, int_as_wall_time)
    444             yearfirst=yearfirst,
    445             ambiguous=ambiguous,
--&gt; 446             int_as_wall_time=int_as_wall_time,
    447         )
    448 

~/miniconda/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py in sequence_to_dt64ns(data, dtype, copy, tz, dayfirst, yearfirst, ambiguous, int_as_wall_time)
   1864             #  or M8[ns] to denote wall times
   1865             data, inferred_tz = objects_to_datetime64ns(
-&gt; 1866                 data, dayfirst=dayfirst, yearfirst=yearfirst
   1867             )
   1868             tz = maybe_infer_tz(tz, inferred_tz)

~/miniconda/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py in objects_to_datetime64ns(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object)
   1982             return values.view(&quot;i8&quot;), tz_parsed
   1983         except (ValueError, TypeError):
-&gt; 1984             raise e
   1985 
   1986     if tz_parsed is not None:

~/miniconda/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py in objects_to_datetime64ns(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object)
   1973             dayfirst=dayfirst,
   1974             yearfirst=yearfirst,
-&gt; 1975             require_iso8601=require_iso8601,
   1976         )
   1977     except ValueError as e:

pandas/_libs/tslib.pyx in pandas._libs.tslib.array_to_datetime()

pandas/_libs/tslib.pyx in pandas._libs.tslib.array_to_datetime()

pandas/_libs/tslib.pyx in pandas._libs.tslib.array_to_datetime_object()

pandas/_libs/tslib.pyx in pandas._libs.tslib.array_to_datetime_object()

pandas/_libs/tslibs/parsing.pyx in pandas._libs.tslibs.parsing.parse_datetime_string()

~/miniconda/lib/python3.7/site-packages/dateutil/parser/_parser.py in parse(timestr, parserinfo, **kwargs)
   1372         return parser(parserinfo).parse(timestr, **kwargs)
   1373     else:
-&gt; 1374         return DEFAULTPARSER.parse(timestr, **kwargs)
   1375 
   1376 

~/miniconda/lib/python3.7/site-packages/dateutil/parser/_parser.py in parse(self, timestr, default, ignoretz, tzinfos, **kwargs)
    647 
    648         if res is None:
--&gt; 649             raise ParserError(&quot;Unknown string format: %s&quot;, timestr)
    650 
    651         if len(res) == 0:

ParserError: Unknown string format: b

In [470]: store.select('df_mask', where=where)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-470-13e54c09efc9&gt; in &lt;module&gt;
----&gt; 1 store.select('df_mask', where=where)

NameError: name 'store' is not defined</pre>
</div>
<div class="section" id="storer-object">
<h5>Storer Object<a class="headerlink" href="#storer-object" title="Permalink to this headline">¶</a></h5>
<p>If you want to inspect the stored object, retrieve via
<code class="docutils literal notranslate"><span class="pre">get_storer</span></code>. You could use this programmatically to say get the number
of rows in an object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [471]: </span><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s1">&#39;df_dc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">471</span><span class="o">-</span><span class="n">f54320d10554</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s1">&#39;df_dc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span>

<span class="ne">NameError</span>: name &#39;store&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="multiple-table-queries">
<h4>Multiple Table Queries<a class="headerlink" href="#multiple-table-queries" title="Permalink to this headline">¶</a></h4>
<p>The methods <code class="docutils literal notranslate"><span class="pre">append_to_multiple</span></code> and
<code class="docutils literal notranslate"><span class="pre">select_as_multiple</span></code> can perform appending/selecting from
multiple tables at once. The idea is to have one table (call it the
selector table) that you index most/all of the columns, and perform your
queries. The other table(s) are data tables with an index matching the
selector table’s index. You can then perform a very fast query
on the selector table, yet get lots of data back. This method is similar to
having a very wide table, but enables more efficient queries.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">append_to_multiple</span></code> method splits a given single DataFrame
into multiple tables according to <code class="docutils literal notranslate"><span class="pre">d</span></code>, a dictionary that maps the
table names to a list of ‘columns’ you want in that table. If <cite>None</cite>
is used in place of a list, that table will have the remaining
unspecified columns of the given DataFrame. The argument <code class="docutils literal notranslate"><span class="pre">selector</span></code>
defines which table is the selector table (which you can make queries from).
The argument <code class="docutils literal notranslate"><span class="pre">dropna</span></code> will drop rows from the input <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to ensure
tables are synchronized.  This means that if a row for one of the tables
being written to is entirely <code class="docutils literal notranslate"><span class="pre">np.NaN</span></code>, that row will be dropped from all tables.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dropna</span></code> is False, <strong>THE USER IS RESPONSIBLE FOR SYNCHRONIZING THE TABLES</strong>.
Remember that entirely <code class="docutils literal notranslate"><span class="pre">np.Nan</span></code> rows are not written to the HDFStore, so if
you choose to call <code class="docutils literal notranslate"><span class="pre">dropna=False</span></code>, some tables may have more rows than others,
and therefore <code class="docutils literal notranslate"><span class="pre">select_as_multiple</span></code> may not work or it may return unexpected
results.</p>
<pre class="literal-block">In [472]: df_mt = pd.DataFrame(np.random.randn(8, 6),
   .....:                      index=pd.date_range('1/1/2000', periods=8),
   .....:                      columns=['A', 'B', 'C', 'D', 'E', 'F'])
   .....: 

In [473]: df_mt['foo'] = 'bar'

In [474]: df_mt.loc[df_mt.index[1], ('A', 'B')] = np.nan

# you can also create the tables individually
In [475]: store.append_to_multiple({'df1_mt': ['A', 'B'], 'df2_mt': None},
   .....:                          df_mt, selector='df1_mt')
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-475-0f2ea287af29&gt; in &lt;module&gt;
----&gt; 1 store.append_to_multiple({'df1_mt': ['A', 'B'], 'df2_mt': None},
      2                          df_mt, selector='df1_mt')

NameError: name 'store' is not defined

In [476]: store
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-476-1cc0c364c02d&gt; in &lt;module&gt;
----&gt; 1 store

NameError: name 'store' is not defined

# individual tables were created
In [477]: store.select('df1_mt')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-477-cd604a6b0b71&gt; in &lt;module&gt;
----&gt; 1 store.select('df1_mt')

NameError: name 'store' is not defined

In [478]: store.select('df2_mt')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-478-a3ed0f55544c&gt; in &lt;module&gt;
----&gt; 1 store.select('df2_mt')

NameError: name 'store' is not defined

# as a multiple
In [479]: store.select_as_multiple(['df1_mt', 'df2_mt'], where=['A&gt;0', 'B&gt;0'],
   .....:                          selector='df1_mt')
   .....: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-479-e97f27782b41&gt; in &lt;module&gt;
----&gt; 1 store.select_as_multiple(['df1_mt', 'df2_mt'], where=['A&gt;0', 'B&gt;0'],
      2                          selector='df1_mt')

NameError: name 'store' is not defined</pre>
</div>
</div>
<div class="section" id="delete-from-a-table">
<h3>Delete from a Table<a class="headerlink" href="#delete-from-a-table" title="Permalink to this headline">¶</a></h3>
<p>You can delete from a table selectively by specifying a <code class="docutils literal notranslate"><span class="pre">where</span></code>. In
deleting rows, it is important to understand the <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> deletes
rows by erasing the rows, then <strong>moving</strong> the following data. Thus
deleting can potentially be a very expensive operation depending on the
orientation of your data. To get optimal performance, it’s
worthwhile to have the dimension you are deleting be the first of the
<code class="docutils literal notranslate"><span class="pre">indexables</span></code>.</p>
<p>Data is ordered (on the disk) in terms of the <code class="docutils literal notranslate"><span class="pre">indexables</span></code>. Here’s a
simple use case. You store panel-type data, with dates in the
<code class="docutils literal notranslate"><span class="pre">major_axis</span></code> and ids in the <code class="docutils literal notranslate"><span class="pre">minor_axis</span></code>. The data is then
interleaved like this:</p>
<ul class="simple">
<li><dl class="simple">
<dt>date_1</dt><dd><ul>
<li><p>id_1</p></li>
<li><p>id_2</p></li>
<li><p>.</p></li>
<li><p>id_n</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>date_2</dt><dd><ul>
<li><p>id_1</p></li>
<li><p>.</p></li>
<li><p>id_n</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>It should be clear that a delete operation on the <code class="docutils literal notranslate"><span class="pre">major_axis</span></code> will be
fairly quick, as one chunk is removed, then the following data moved. On
the other hand a delete operation on the <code class="docutils literal notranslate"><span class="pre">minor_axis</span></code> will be very
expensive. In this case it would almost certainly be faster to rewrite
the table using a <code class="docutils literal notranslate"><span class="pre">where</span></code> that selects all but the missing data.</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Please note that HDF5 <strong>DOES NOT RECLAIM SPACE</strong> in the h5 files
automatically. Thus, repeatedly deleting (or removing nodes) and adding
again, <strong>WILL TEND TO INCREASE THE FILE SIZE</strong>.</p>
<p>To <em>repack and clean</em> the file, use <a class="reference internal" href="#io-hdf5-ptrepack"><span class="std std-ref">ptrepack</span></a>.</p>
</div>
</div>
<div class="section" id="notes-caveats">
<span id="io-hdf5-notes"></span><h3>Notes &amp; Caveats<a class="headerlink" href="#notes-caveats" title="Permalink to this headline">¶</a></h3>
<div class="section" id="compression">
<h4>Compression<a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">PyTables</span></code> allows the stored data to be compressed. This applies to
all kinds of stores, not just tables. Two parameters are used to
control compression: <code class="docutils literal notranslate"><span class="pre">complevel</span></code> and <code class="docutils literal notranslate"><span class="pre">complib</span></code>.</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">complevel</span></code> specifies if and how hard data is to be compressed.</dt><dd><p><code class="docutils literal notranslate"><span class="pre">complevel=0</span></code> and <code class="docutils literal notranslate"><span class="pre">complevel=None</span></code> disables
compression and <code class="docutils literal notranslate"><span class="pre">0&lt;complevel&lt;10</span></code> enables compression.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">complib</span></code> specifies which compression library to use. If nothing is</dt><dd><p>specified the default library <code class="docutils literal notranslate"><span class="pre">zlib</span></code> is used. A
compression library usually optimizes for either good
compression rates or speed and the results will depend on
the type of data. Which type of
compression to choose depends on your specific needs and
data. The list of supported compression libraries:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://zlib.net/">zlib</a>: The default compression library. A classic in terms of compression, achieves good compression rates but is somewhat slow.</p></li>
<li><p><a class="reference external" href="https://www.oberhumer.com/opensource/lzo/">lzo</a>: Fast compression and decompression.</p></li>
<li><p><a class="reference external" href="http://bzip.org/">bzip2</a>: Good compression rates.</p></li>
<li><p><a class="reference external" href="http://www.blosc.org/">blosc</a>: Fast compression and decompression.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.2: </span>Support for alternative blosc compressors:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.blosc.org/">blosc:blosclz</a> This is the
default compressor for <code class="docutils literal notranslate"><span class="pre">blosc</span></code></p></li>
<li><p><a class="reference external" href="https://fastcompression.blogspot.dk/p/lz4.html">blosc:lz4</a>:
A compact, very popular and fast compressor.</p></li>
<li><p><a class="reference external" href="https://fastcompression.blogspot.dk/p/lz4.html">blosc:lz4hc</a>:
A tweaked version of LZ4, produces better
compression ratios at the expense of speed.</p></li>
<li><p><a class="reference external" href="https://google.github.io/snappy/">blosc:snappy</a>:
A popular compressor used in many places.</p></li>
<li><p><a class="reference external" href="https://zlib.net/">blosc:zlib</a>: A classic;
somewhat slower than the previous ones, but
achieving better compression ratios.</p></li>
<li><p><a class="reference external" href="https://facebook.github.io/zstd/">blosc:zstd</a>: An
extremely well balanced codec; it provides the best
compression ratios among the others above, and at
reasonably fast speed.</p></li>
</ul>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">complib</span></code> is defined as something other than the
listed libraries a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception is issued.</p>
</div></blockquote>
</dd>
</dl>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>If the library specified with the <code class="docutils literal notranslate"><span class="pre">complib</span></code> option is missing on your platform,
compression defaults to <code class="docutils literal notranslate"><span class="pre">zlib</span></code> without further ado.</p>
</div>
<p>Enable compression for all objects within the file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store_compressed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s1">&#39;store_compressed.h5&#39;</span><span class="p">,</span> <span class="n">complevel</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                               <span class="n">complib</span><span class="o">=</span><span class="s1">&#39;blosc:blosclz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or on-the-fly compression (this only applies to tables) in stores where compression is not enabled:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">complib</span><span class="o">=</span><span class="s1">&#39;zlib&#39;</span><span class="p">,</span> <span class="n">complevel</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ptrepack">
<span id="io-hdf5-ptrepack"></span><h4>ptrepack<a class="headerlink" href="#ptrepack" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">PyTables</span></code> offers better write performance when tables are compressed after
they are written, as opposed to turning on compression at the very
beginning. You can use the supplied <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> utility
<code class="docutils literal notranslate"><span class="pre">ptrepack</span></code>. In addition, <code class="docutils literal notranslate"><span class="pre">ptrepack</span></code> can change compression levels
after the fact.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ptrepack --chunkshape=auto --propindexes --complevel=9 --complib=blosc in.h5 out.h5</span>
</pre></div>
</div>
<p>Furthermore <code class="docutils literal notranslate"><span class="pre">ptrepack</span> <span class="pre">in.h5</span> <span class="pre">out.h5</span></code> will <em>repack</em> the file to allow
you to reuse previously deleted space. Alternatively, one can simply
remove the file and write again, or use the <code class="docutils literal notranslate"><span class="pre">copy</span></code> method.</p>
</div>
<div class="section" id="caveats">
<span id="io-hdf5-caveats"></span><h4>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h4>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> is <strong>not-threadsafe for writing</strong>. The underlying
<code class="docutils literal notranslate"><span class="pre">PyTables</span></code> only supports concurrent reads (via threading or
processes). If you need reading and writing <em>at the same time</em>, you
need to serialize these operations in a single thread in a single
process. You will corrupt your data otherwise. See the (<a class="reference external" href="https://github.com/pandas-dev/pandas/issues/2397">GH2397</a>) for more information.</p>
</div>
<ul class="simple">
<li><p>If you use locks to manage write access between multiple processes, you
may want to use <a class="reference external" href="https://docs.python.org/3/library/os.html#os.fsync" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">fsync()</span></code></a> before releasing write locks. For
convenience you can use <code class="docutils literal notranslate"><span class="pre">store.flush(fsync=True)</span></code> to do this for you.</p></li>
<li><p>Once a <code class="docutils literal notranslate"><span class="pre">table</span></code> is created columns (DataFrame)
are fixed; only exactly the same columns can be appended</p></li>
<li><p>Be aware that timezones (e.g., <code class="docutils literal notranslate"><span class="pre">pytz.timezone('US/Eastern')</span></code>)
are not necessarily equal across timezone versions.  So if data is
localized to a specific timezone in the HDFStore using one version
of a timezone library and that data is updated with another version, the data
will be converted to UTC since these timezones are not considered
equal.  Either use the same version of timezone library or use <code class="docutils literal notranslate"><span class="pre">tz_convert</span></code> with
the updated timezone definition.</p></li>
</ul>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">PyTables</span></code> will show a <code class="docutils literal notranslate"><span class="pre">NaturalNameWarning</span></code> if a column name
cannot be used as an attribute selector.
<em>Natural</em> identifiers contain only letters, numbers, and underscores,
and may not begin with a number.
Other identifiers cannot be used in a <code class="docutils literal notranslate"><span class="pre">where</span></code> clause
and are generally a bad idea.</p>
</div>
</div>
</div>
<div class="section" id="datatypes">
<span id="io-hdf5-data-types"></span><h3>DataTypes<a class="headerlink" href="#datatypes" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> will map an object dtype to the <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> underlying
dtype. This means the following types are known to work:</p>
<table class="table">
<colgroup>
<col style="width: 68%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Represents missing values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>floating : <code class="docutils literal notranslate"><span class="pre">float64,</span> <span class="pre">float32,</span> <span class="pre">float16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>integer : <code class="docutils literal notranslate"><span class="pre">int64,</span> <span class="pre">int32,</span> <span class="pre">int8,</span> <span class="pre">uint64,uint32,</span> <span class="pre">uint8</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>boolean</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">datetime64[ns]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NaT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">timedelta64[ns]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NaT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>categorical : see the section below</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>object : <code class="docutils literal notranslate"><span class="pre">strings</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">unicode</span></code> columns are not supported, and <strong>WILL FAIL</strong>.</p>
<div class="section" id="categorical-data">
<span id="io-hdf5-categorical"></span><h4>Categorical Data<a class="headerlink" href="#categorical-data" title="Permalink to this headline">¶</a></h4>
<p>You can write data that contains <code class="docutils literal notranslate"><span class="pre">category</span></code> dtypes to a <code class="docutils literal notranslate"><span class="pre">HDFStore</span></code>.
Queries work the same as if it was an object array. However, the <code class="docutils literal notranslate"><span class="pre">category</span></code> dtyped data is
stored in a more efficient manner.</p>
<pre class="literal-block">In [480]: dfcat = pd.DataFrame({'A': pd.Series(list('aabbcdba')).astype('category'),
   .....:                       'B': np.random.randn(8)})
   .....: 

In [481]: dfcat
Out[481]: 
   A         B
0  a  0.577961
1  a -0.200132
2  b -2.117306
3  b -0.061709
4  c -1.309888
5  d  0.253324
6  b  1.686667
7  a -1.818496

In [482]: dfcat.dtypes
Out[482]: 
A    category
B     float64
dtype: object

In [483]: cstore = pd.HDFStore('cats.h5', mode='w')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-483-f0dcb969ab57&gt; in &lt;module&gt;
----&gt; 1 cstore = pd.HDFStore('cats.h5', mode='w')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [484]: cstore.append('dfcat', dfcat, format='table', data_columns=['A'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-484-1811d2336854&gt; in &lt;module&gt;
----&gt; 1 cstore.append('dfcat', dfcat, format='table', data_columns=['A'])

NameError: name 'cstore' is not defined

In [485]: result = cstore.select('dfcat', where=&quot;A in ['b', 'c']&quot;)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-485-efe8bd5bc969&gt; in &lt;module&gt;
----&gt; 1 result = cstore.select('dfcat', where=&quot;A in ['b', 'c']&quot;)

NameError: name 'cstore' is not defined

In [486]: result
Out[486]: 
metrics  b_sum  c_mean
a                     
0          2.0     0.5
1          2.0     0.5
2          2.0     0.5

In [487]: result.dtypes
Out[487]: 
metrics
b_sum     float64
c_mean    float64
dtype: object</pre>
</div>
<div class="section" id="string-columns">
<h4>String Columns<a class="headerlink" href="#string-columns" title="Permalink to this headline">¶</a></h4>
<p><strong>min_itemsize</strong></p>
<p>The underlying implementation of <code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> uses a fixed column width (itemsize) for string columns.
A string column itemsize is calculated as the maximum of the
length of data (for that column) that is passed to the <code class="docutils literal notranslate"><span class="pre">HDFStore</span></code>, <strong>in the first append</strong>. Subsequent appends,
may introduce a string for a column <strong>larger</strong> than the column can hold, an Exception will be raised (otherwise you
could have a silent truncation of these columns, leading to loss of information). In the future we may relax this and
allow a user-specified truncation to occur.</p>
<p>Pass <code class="docutils literal notranslate"><span class="pre">min_itemsize</span></code> on the first table creation to a-priori specify the minimum length of a particular string column.
<code class="docutils literal notranslate"><span class="pre">min_itemsize</span></code> can be an integer, or a dict mapping a column name to an integer. You can pass <code class="docutils literal notranslate"><span class="pre">values</span></code> as a key to
allow all <em>indexables</em> or <em>data_columns</em> to have this min_itemsize.</p>
<p>Passing a <code class="docutils literal notranslate"><span class="pre">min_itemsize</span></code> dict will cause all passed columns to be created as <em>data_columns</em> automatically.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>If you are not passing any <code class="docutils literal notranslate"><span class="pre">data_columns</span></code>, then the <code class="docutils literal notranslate"><span class="pre">min_itemsize</span></code> will be the maximum of the length of any string passed</p>
</div>
<pre class="literal-block">In [488]: dfs = pd.DataFrame({'A': 'foo', 'B': 'bar'}, index=list(range(5)))

In [489]: dfs
Out[489]: 
     A    B
0  foo  bar
1  foo  bar
2  foo  bar
3  foo  bar
4  foo  bar

# A and B have a size of 30
In [490]: store.append('dfs', dfs, min_itemsize=30)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-490-52a3ef06393c&gt; in &lt;module&gt;
----&gt; 1 store.append('dfs', dfs, min_itemsize=30)

NameError: name 'store' is not defined

In [491]: store.get_storer('dfs').table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-491-934029d84104&gt; in &lt;module&gt;
----&gt; 1 store.get_storer('dfs').table

NameError: name 'store' is not defined

# A is created as a data_column with a size of 30
# B is size is calculated
In [492]: store.append('dfs2', dfs, min_itemsize={'A': 30})
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-492-c510144990e0&gt; in &lt;module&gt;
----&gt; 1 store.append('dfs2', dfs, min_itemsize={'A': 30})

NameError: name 'store' is not defined

In [493]: store.get_storer('dfs2').table
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-493-301bf7828112&gt; in &lt;module&gt;
----&gt; 1 store.get_storer('dfs2').table

NameError: name 'store' is not defined</pre>
<p><strong>nan_rep</strong></p>
<p>String columns will serialize a <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> (a missing value) with the <code class="docutils literal notranslate"><span class="pre">nan_rep</span></code> string representation. This defaults to the string value <code class="docutils literal notranslate"><span class="pre">nan</span></code>.
You could inadvertently turn an actual <code class="docutils literal notranslate"><span class="pre">nan</span></code> value into a missing value.</p>
<pre class="literal-block">In [494]: dfss = pd.DataFrame({'A': ['foo', 'bar', 'nan']})

In [495]: dfss
Out[495]: 
     A
0  foo
1  bar
2  nan

In [496]: store.append('dfss', dfss)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-496-7dd606fe45ee&gt; in &lt;module&gt;
----&gt; 1 store.append('dfss', dfss)

NameError: name 'store' is not defined

In [497]: store.select('dfss')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-497-1dce3f313c79&gt; in &lt;module&gt;
----&gt; 1 store.select('dfss')

NameError: name 'store' is not defined

# here you need to specify a different nan rep
In [498]: store.append('dfss2', dfss, nan_rep='_nan_')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-498-87550d41b8ff&gt; in &lt;module&gt;
----&gt; 1 store.append('dfss2', dfss, nan_rep='_nan_')

NameError: name 'store' is not defined

In [499]: store.select('dfss2')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-499-2ccfb6815466&gt; in &lt;module&gt;
----&gt; 1 store.select('dfss2')

NameError: name 'store' is not defined</pre>
</div>
</div>
<div class="section" id="external-compatibility">
<span id="io-external-compatibility"></span><h3>External Compatibility<a class="headerlink" href="#external-compatibility" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> writes <code class="docutils literal notranslate"><span class="pre">table</span></code> format objects in specific formats suitable for
producing loss-less round trips to pandas objects. For external
compatibility, <code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> can read native <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> format
tables.</p>
<p>It is possible to write an <code class="docutils literal notranslate"><span class="pre">HDFStore</span></code> object that can easily be imported into <code class="docutils literal notranslate"><span class="pre">R</span></code> using the
<code class="docutils literal notranslate"><span class="pre">rhdf5</span></code> library (<a class="reference external" href="https://www.bioconductor.org/packages/release/bioc/html/rhdf5.html">Package website</a>). Create a table format store like this:</p>
<pre class="literal-block">In [500]: df_for_r = pd.DataFrame({&quot;first&quot;: np.random.rand(100),
   .....:                          &quot;second&quot;: np.random.rand(100),
   .....:                          &quot;class&quot;: np.random.randint(0, 2, (100, ))},
   .....:                         index=range(100))
   .....: 

In [501]: df_for_r.head()
Out[501]: 
      first    second  class
0  0.814222  0.239828      0
1  0.464452  0.602237      1
2  0.757487  0.306825      1
3  0.728331  0.502096      0
4  0.849117  0.063483      1

In [502]: store_export = pd.HDFStore('export.h5')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-502-d8f1d2b3a753&gt; in &lt;module&gt;
----&gt; 1 store_export = pd.HDFStore('export.h5')

~/miniconda/lib/python3.7/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
    482             raise ValueError(&quot;format is not a defined argument for HDFStore&quot;)
    483 
--&gt; 484         tables = import_optional_dependency(&quot;tables&quot;)
    485 
    486         if complib is not None and complib not in tables.filters.all_complibs:

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.

In [503]: store_export.append('df_for_r', df_for_r, data_columns=df_dc.columns)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-503-d2f250518f37&gt; in &lt;module&gt;
----&gt; 1 store_export.append('df_for_r', df_for_r, data_columns=df_dc.columns)

NameError: name 'store_export' is not defined

In [504]: store_export
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-504-9a52a1914703&gt; in &lt;module&gt;
----&gt; 1 store_export

NameError: name 'store_export' is not defined</pre>
<p>In R this file can be read into a <code class="docutils literal notranslate"><span class="pre">data.frame</span></code> object using the <code class="docutils literal notranslate"><span class="pre">rhdf5</span></code>
library. The following example function reads the corresponding column names
and data values from the values and assembles them into a <code class="docutils literal notranslate"><span class="pre">data.frame</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load values and column names for all datasets from corresponding nodes and</span>
<span class="c1"># insert them into one data.frame object.</span>

<span class="nf">library</span><span class="p">(</span><span class="n">rhdf5</span><span class="p">)</span>

<span class="n">loadhdf5data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">h5File</span><span class="p">)</span> <span class="p">{</span>

<span class="n">listing</span> <span class="o">&lt;-</span> <span class="nf">h5ls</span><span class="p">(</span><span class="n">h5File</span><span class="p">)</span>
<span class="c1"># Find all data nodes, values are stored in *_values and corresponding column</span>
<span class="c1"># titles in *_items</span>
<span class="n">data_nodes</span> <span class="o">&lt;-</span> <span class="nf">grep</span><span class="p">(</span><span class="s">&quot;_values&quot;</span><span class="p">,</span> <span class="n">listing</span><span class="o">$</span><span class="n">name</span><span class="p">)</span>
<span class="n">name_nodes</span> <span class="o">&lt;-</span> <span class="nf">grep</span><span class="p">(</span><span class="s">&quot;_items&quot;</span><span class="p">,</span> <span class="n">listing</span><span class="o">$</span><span class="n">name</span><span class="p">)</span>
<span class="n">data_paths</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="n">listing</span><span class="o">$</span><span class="n">group[data_nodes]</span><span class="p">,</span> <span class="n">listing</span><span class="o">$</span><span class="n">name[data_nodes]</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
<span class="n">name_paths</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="n">listing</span><span class="o">$</span><span class="n">group[name_nodes]</span><span class="p">,</span> <span class="n">listing</span><span class="o">$</span><span class="n">name[name_nodes]</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">idx</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="n">data_paths</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1"># NOTE: matrices returned by h5read have to be transposed to obtain</span>
  <span class="c1"># required Fortran order!</span>
  <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="nf">h5read</span><span class="p">(</span><span class="n">h5File</span><span class="p">,</span> <span class="n">data_paths[idx]</span><span class="p">)))</span>
  <span class="n">names</span> <span class="o">&lt;-</span> <span class="nf">t</span><span class="p">(</span><span class="nf">h5read</span><span class="p">(</span><span class="n">h5File</span><span class="p">,</span> <span class="n">name_paths[idx]</span><span class="p">))</span>
  <span class="n">entry</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="nf">colnames</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">names</span>
  <span class="n">columns</span> <span class="o">&lt;-</span> <span class="nf">append</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

<span class="nf">return</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you can import the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> into R:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="nf">loadhdf5data</span><span class="p">(</span><span class="s">&quot;transfer.hdf5&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
         <span class="n">first</span>    <span class="n">second</span> <span class="n">class</span>
<span class="m">1</span> <span class="m">0.4170220047</span> <span class="m">0.3266449</span>     <span class="m">0</span>
<span class="m">2</span> <span class="m">0.7203244934</span> <span class="m">0.5270581</span>     <span class="m">0</span>
<span class="m">3</span> <span class="m">0.0001143748</span> <span class="m">0.8859421</span>     <span class="m">1</span>
<span class="m">4</span> <span class="m">0.3023325726</span> <span class="m">0.3572698</span>     <span class="m">1</span>
<span class="m">5</span> <span class="m">0.1467558908</span> <span class="m">0.9085352</span>     <span class="m">1</span>
<span class="m">6</span> <span class="m">0.0923385948</span> <span class="m">0.6233601</span>     <span class="m">1</span>
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The R function lists the entire HDF5 file’s contents and assembles the
<code class="docutils literal notranslate"><span class="pre">data.frame</span></code> object from all matching nodes, so use this only as a
starting point if you have stored multiple <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects to a
single HDF5 file.</p>
</div>
</div>
<div class="section" id="performance">
<h3>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tables</span></code> format come with a writing performance penalty as compared to
<code class="docutils literal notranslate"><span class="pre">fixed</span></code> stores. The benefit is the ability to append/delete and
query (potentially very large amounts of data).  Write times are
generally longer as compared with regular stores. Query times can
be quite fast, especially on an indexed axis.</p></li>
<li><p>You can pass <code class="docutils literal notranslate"><span class="pre">chunksize=&lt;int&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">append</span></code>, specifying the
write chunksize (default is 50000). This will significantly lower
your memory usage on writing.</p></li>
<li><p>You can pass <code class="docutils literal notranslate"><span class="pre">expectedrows=&lt;int&gt;</span></code> to the first <code class="docutils literal notranslate"><span class="pre">append</span></code>,
to set the TOTAL number of expected rows that <code class="docutils literal notranslate"><span class="pre">PyTables</span></code> will
expected. This will optimize read/write performance.</p></li>
<li><p>Duplicate rows can be written to tables, but are filtered out in
selection (with the last items being selected; thus a table is
unique on major, minor pairs)</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">PerformanceWarning</span></code> will be raised if you are attempting to
store types that will be pickled by PyTables (rather than stored as
endemic types). See
<a class="reference external" href="https://stackoverflow.com/questions/14355151/how-to-make-pandas-hdfstore-put-operation-faster/14370190#14370190">Here</a>
for more information and some solutions.</p></li>
</ul>
</div>
</div>
<div class="section" id="feather">
<span id="io-feather"></span><h2>Feather<a class="headerlink" href="#feather" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>Feather provides binary columnar serialization for data frames. It is designed to make reading and writing data
frames efficient, and to make sharing data across data analysis languages easy.</p>
<p>Feather is designed to faithfully serialize and de-serialize DataFrames, supporting all of the pandas
dtypes, including extension dtypes such as categorical and datetime with tz.</p>
<p>Several caveats.</p>
<ul class="simple">
<li><p>This is a newer library, and the format, though stable, is not guaranteed to be backward compatible
to the earlier versions.</p></li>
<li><p>The format will NOT write an <code class="docutils literal notranslate"><span class="pre">Index</span></code>, or <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> for the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and will raise an error if a non-default one is provided. You
can <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> to store the index or <code class="docutils literal notranslate"><span class="pre">.reset_index(drop=True)</span></code> to
ignore it.</p></li>
<li><p>Duplicate column names and non-string columns names are not supported</p></li>
<li><p>Non supported types include <code class="docutils literal notranslate"><span class="pre">Period</span></code> and actual Python object types. These will raise a helpful error message
on an attempt at serialization.</p></li>
</ul>
<p>See the <a class="reference external" href="https://github.com/wesm/feather">Full Documentation</a>.</p>
<pre class="literal-block">In [505]: df = pd.DataFrame({'a': list('abc'),
   .....:                    'b': list(range(1, 4)),
   .....:                    'c': np.arange(3, 6).astype('u1'),
   .....:                    'd': np.arange(4.0, 7.0, dtype='float64'),
   .....:                    'e': [True, False, True],
   .....:                    'f': pd.Categorical(list('abc')),
   .....:                    'g': pd.date_range('20130101', periods=3),
   .....:                    'h': pd.date_range('20130101', periods=3, tz='US/Eastern'),
   .....:                    'i': pd.date_range('20130101', periods=3, freq='ns')})
   .....: 

In [506]: df
Out[506]: 
   a  b  c  ...          g                         h                             i
0  a  1  3  ... 2013-01-01 2013-01-01 00:00:00-05:00 2013-01-01 00:00:00.000000000
1  b  2  4  ... 2013-01-02 2013-01-02 00:00:00-05:00 2013-01-01 00:00:00.000000001
2  c  3  5  ... 2013-01-03 2013-01-03 00:00:00-05:00 2013-01-01 00:00:00.000000002

[3 rows x 9 columns]

In [507]: df.dtypes
Out[507]: 
a                        object
b                         int64
c                         uint8
d                       float64
e                          bool
f                      category
g                datetime64[ns]
h    datetime64[ns, US/Eastern]
i                datetime64[ns]
dtype: object</pre>
<p>Write to a feather file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [508]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s1">&#39;example.feather&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">508</span><span class="o">-</span><span class="n">b832ec9cf6be</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s1">&#39;example.feather&#39;</span><span class="p">)</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ni">to_feather</span><span class="nt">(self, fname)</span>
<span class="g g-Whitespace">   </span><span class="mi">2150</span>         <span class="kn">from</span> <span class="nn">pandas.io.feather_format</span> <span class="kn">import</span> <span class="n">to_feather</span>
<span class="g g-Whitespace">   </span><span class="mi">2151</span> 
<span class="ne">-&gt; </span><span class="mi">2152</span>         <span class="n">to_feather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2153</span> 
<span class="g g-Whitespace">   </span><span class="mi">2154</span>     <span class="k">def</span> <span class="nf">to_parquet</span><span class="p">(</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/feather_format.py</span> in <span class="ni">to_feather</span><span class="nt">(df, path)</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> 
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">23</span><span class="s2">     import_optional_dependency(&quot;pyarrow&quot;)</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span><span class="s2">     from pyarrow import feather</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span><span class="s2"> </span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, raise_on_missing, on_version)</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span><span class="s2">     except ImportError:</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span><span class="s2">         if raise_on_missing:</span>
<span class="ne">---&gt; </span><span class="mi">93</span><span class="s2">             raise ImportError(message.format(name=name, extra=extra)) from None</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span><span class="s2">         else:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span><span class="s2">             return None</span>

<span class="ne">ImportError</span>: Missing optional dependency &#39;pyarrow&#39;.  Use pip or conda to install pyarrow.
</pre></div>
</div>
<p>Read from a feather file.</p>
<pre class="literal-block">In [509]: result = pd.read_feather('example.feather')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-509-9efa72931ac9&gt; in &lt;module&gt;
----&gt; 1 result = pd.read_feather('example.feather')

~/miniconda/lib/python3.7/site-packages/pandas/util/_decorators.py in wrapper(*args, **kwargs)
    206                 else:
    207                     kwargs[new_arg_name] = new_arg_value
--&gt; 208             return func(*args, **kwargs)
    209 
    210         return wrapper

~/miniconda/lib/python3.7/site-packages/pandas/io/feather_format.py in read_feather(path, columns, use_threads)
    106     type of object stored in file
    107     &quot;&quot;&quot;
--&gt; 108     pyarrow = import_optional_dependency(&quot;pyarrow&quot;)
    109     from pyarrow import feather
    110 

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'pyarrow'.  Use pip or conda to install pyarrow.

In [510]: result
Out[510]: 
metrics  b_sum  c_mean
a                     
0          2.0     0.5
1          2.0     0.5
2          2.0     0.5

# we preserve dtypes
In [511]: result.dtypes
Out[511]: 
metrics
b_sum     float64
c_mean    float64
dtype: object</pre>
</div>
<div class="section" id="parquet">
<span id="io-parquet"></span><h2>Parquet<a class="headerlink" href="#parquet" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.0.</span></p>
</div>
<p><a class="reference external" href="https://parquet.apache.org/">Apache Parquet</a> provides a partitioned binary columnar serialization for data frames. It is designed to
make reading and writing data frames efficient, and to make sharing data across data analysis
languages easy. Parquet can use a variety of compression techniques to shrink the file size as much as possible
while still maintaining good read performance.</p>
<p>Parquet is designed to faithfully serialize and de-serialize <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> s, supporting all of the pandas
dtypes, including extension dtypes such as datetime with tz.</p>
<p>Several caveats.</p>
<ul class="simple">
<li><p>Duplicate column names and non-string columns names are not supported.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> engine always writes the index to the output, but <code class="docutils literal notranslate"><span class="pre">fastparquet</span></code> only writes non-default
indexes. This extra column can cause problems for non-Pandas consumers that are not expecting it. You can
force including or omitting indexes with the <code class="docutils literal notranslate"><span class="pre">index</span></code> argument, regardless of the underlying engine.</p></li>
<li><p>Index level names, if specified, must be strings.</p></li>
<li><p>Categorical dtypes can be serialized to parquet, but will de-serialize as <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype.</p></li>
<li><p>Non supported types include <code class="docutils literal notranslate"><span class="pre">Period</span></code> and actual Python object types. These will raise a helpful error message
on an attempt at serialization.</p></li>
</ul>
<p>You can specify an <code class="docutils literal notranslate"><span class="pre">engine</span></code> to direct the serialization. This can be one of <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code>, or <code class="docutils literal notranslate"><span class="pre">fastparquet</span></code>, or <code class="docutils literal notranslate"><span class="pre">auto</span></code>.
If the engine is NOT specified, then the <code class="docutils literal notranslate"><span class="pre">pd.options.io.parquet.engine</span></code> option is checked; if this is also <code class="docutils literal notranslate"><span class="pre">auto</span></code>,
then <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> is tried, and falling back to <code class="docutils literal notranslate"><span class="pre">fastparquet</span></code>.</p>
<p>See the documentation for <a class="reference external" href="https://arrow.apache.org/docs/python/">pyarrow</a> and <a class="reference external" href="https://fastparquet.readthedocs.io/en/latest/">fastparquet</a>.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>These engines are very similar and should read/write nearly identical parquet format files.
Currently <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> does not support timedelta data, <code class="docutils literal notranslate"><span class="pre">fastparquet&gt;=0.1.4</span></code> supports timezone aware datetimes.
These libraries differ by having different underlying dependencies (<code class="docutils literal notranslate"><span class="pre">fastparquet</span></code> by using <code class="docutils literal notranslate"><span class="pre">numba</span></code>, while <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> uses a c-library).</p>
</div>
<pre class="literal-block">In [512]: df = pd.DataFrame({'a': list('abc'),
   .....:                    'b': list(range(1, 4)),
   .....:                    'c': np.arange(3, 6).astype('u1'),
   .....:                    'd': np.arange(4.0, 7.0, dtype='float64'),
   .....:                    'e': [True, False, True],
   .....:                    'f': pd.date_range('20130101', periods=3),
   .....:                    'g': pd.date_range('20130101', periods=3, tz='US/Eastern')})
   .....: 

In [513]: df
Out[513]: 
   a  b  c    d      e          f                         g
0  a  1  3  4.0   True 2013-01-01 2013-01-01 00:00:00-05:00
1  b  2  4  5.0  False 2013-01-02 2013-01-02 00:00:00-05:00
2  c  3  5  6.0   True 2013-01-03 2013-01-03 00:00:00-05:00

In [514]: df.dtypes
Out[514]: 
a                        object
b                         int64
c                         uint8
d                       float64
e                          bool
f                datetime64[ns]
g    datetime64[ns, US/Eastern]
dtype: object</pre>
<p>Write to a parquet file.</p>
<pre class="literal-block">In [515]: df.to_parquet('example_pa.parquet', engine='pyarrow')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-515-96e1a42ae5ed&gt; in &lt;module&gt;
----&gt; 1 df.to_parquet('example_pa.parquet', engine='pyarrow')

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in to_parquet(self, fname, engine, compression, index, partition_cols, **kwargs)
   2235             index=index,
   2236             partition_cols=partition_cols,
-&gt; 2237             **kwargs
   2238         )
   2239 

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in to_parquet(df, path, engine, compression, index, partition_cols, **kwargs)
    245         Additional keyword arguments passed to the engine
    246     &quot;&quot;&quot;
--&gt; 247     impl = get_engine(engine)
    248     return impl.write(
    249         df,

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in get_engine(engine)
     40 
     41     if engine == &quot;pyarrow&quot;:
---&gt; 42         return PyArrowImpl()
     43     elif engine == &quot;fastparquet&quot;:
     44         return FastParquetImpl()

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in __init__(self)
     76     def __init__(self):
     77         pyarrow = import_optional_dependency(
---&gt; 78             &quot;pyarrow&quot;, extra=&quot;pyarrow is required for parquet support.&quot;
     79         )
     80         import pyarrow.parquet

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.

In [516]: df.to_parquet('example_fp.parquet', engine='fastparquet')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-516-8ba55b61d48c&gt; in &lt;module&gt;
----&gt; 1 df.to_parquet('example_fp.parquet', engine='fastparquet')

~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py in to_parquet(self, fname, engine, compression, index, partition_cols, **kwargs)
   2235             index=index,
   2236             partition_cols=partition_cols,
-&gt; 2237             **kwargs
   2238         )
   2239 

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in to_parquet(df, path, engine, compression, index, partition_cols, **kwargs)
    245         Additional keyword arguments passed to the engine
    246     &quot;&quot;&quot;
--&gt; 247     impl = get_engine(engine)
    248     return impl.write(
    249         df,

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in get_engine(engine)
     42         return PyArrowImpl()
     43     elif engine == &quot;fastparquet&quot;:
---&gt; 44         return FastParquetImpl()
     45 
     46 

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in __init__(self)
    139         # we need to import on first use
    140         fastparquet = import_optional_dependency(
--&gt; 141             &quot;fastparquet&quot;, extra=&quot;fastparquet is required for parquet support.&quot;
    142         )
    143         self.api = fastparquet

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.</pre>
<p>Read from a parquet file.</p>
<pre class="literal-block">In [517]: result = pd.read_parquet('example_fp.parquet', engine='fastparquet')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-517-d4bce7d5df53&gt; in &lt;module&gt;
----&gt; 1 result = pd.read_parquet('example_fp.parquet', engine='fastparquet')

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in read_parquet(path, engine, columns, **kwargs)
    293     &quot;&quot;&quot;
    294 
--&gt; 295     impl = get_engine(engine)
    296     return impl.read(path, columns=columns, **kwargs)

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in get_engine(engine)
     42         return PyArrowImpl()
     43     elif engine == &quot;fastparquet&quot;:
---&gt; 44         return FastParquetImpl()
     45 
     46 

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in __init__(self)
    139         # we need to import on first use
    140         fastparquet = import_optional_dependency(
--&gt; 141             &quot;fastparquet&quot;, extra=&quot;fastparquet is required for parquet support.&quot;
    142         )
    143         self.api = fastparquet

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.

In [518]: result = pd.read_parquet('example_pa.parquet', engine='pyarrow')
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-518-f9990387c867&gt; in &lt;module&gt;
----&gt; 1 result = pd.read_parquet('example_pa.parquet', engine='pyarrow')

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in read_parquet(path, engine, columns, **kwargs)
    293     &quot;&quot;&quot;
    294 
--&gt; 295     impl = get_engine(engine)
    296     return impl.read(path, columns=columns, **kwargs)

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in get_engine(engine)
     40 
     41     if engine == &quot;pyarrow&quot;:
---&gt; 42         return PyArrowImpl()
     43     elif engine == &quot;fastparquet&quot;:
     44         return FastParquetImpl()

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in __init__(self)
     76     def __init__(self):
     77         pyarrow = import_optional_dependency(
---&gt; 78             &quot;pyarrow&quot;, extra=&quot;pyarrow is required for parquet support.&quot;
     79         )
     80         import pyarrow.parquet

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.

In [519]: result.dtypes
Out[519]: 
metrics
b_sum     float64
c_mean    float64
dtype: object</pre>
<p>Read only certain columns of a parquet file.</p>
<pre class="literal-block">In [520]: result = pd.read_parquet('example_fp.parquet',
   .....:                          engine='fastparquet', columns=['a', 'b'])
   .....: 
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
&lt;ipython-input-520-e4f7add80b89&gt; in &lt;module&gt;
      1 result = pd.read_parquet('example_fp.parquet',
----&gt; 2                          engine='fastparquet', columns=['a', 'b'])

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in read_parquet(path, engine, columns, **kwargs)
    293     &quot;&quot;&quot;
    294 
--&gt; 295     impl = get_engine(engine)
    296     return impl.read(path, columns=columns, **kwargs)

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in get_engine(engine)
     42         return PyArrowImpl()
     43     elif engine == &quot;fastparquet&quot;:
---&gt; 44         return FastParquetImpl()
     45 
     46 

~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py in __init__(self)
    139         # we need to import on first use
    140         fastparquet = import_optional_dependency(
--&gt; 141             &quot;fastparquet&quot;, extra=&quot;fastparquet is required for parquet support.&quot;
    142         )
    143         self.api = fastparquet

~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py in import_optional_dependency(name, extra, raise_on_missing, on_version)
     91     except ImportError:
     92         if raise_on_missing:
---&gt; 93             raise ImportError(message.format(name=name, extra=extra)) from None
     94         else:
     95             return None

ImportError: Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.

In [521]: result.dtypes
Out[521]: 
metrics
b_sum     float64
c_mean    float64
dtype: object</pre>
<div class="section" id="handling-indexes">
<h3>Handling Indexes<a class="headerlink" href="#handling-indexes" title="Permalink to this headline">¶</a></h3>
<p>Serializing a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to parquet may include the implicit index as one or
more columns in the output file. Thus, this code:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [522]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="gp">In [523]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">523</span><span class="o">-</span><span class="n">bebaa85a69fa</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">)</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ni">to_parquet</span><span class="nt">(self, fname, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2235</span>             <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2236</span>             <span class="n">partition_cols</span><span class="o">=</span><span class="n">partition_cols</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">2237</span>             <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">   </span><span class="mi">2238</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2239</span> 

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">to_parquet</span><span class="nt">(df, path, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>         <span class="n">Additional</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">engine</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">247</span><span class="s2">     impl = get_engine(engine)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span><span class="s2">     return impl.write(</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span><span class="s2">         df,</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">get_engine</span><span class="nt">(engine)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span><span class="s2"> </span>
<span class="g g-Whitespace">     </span><span class="mi">41</span><span class="s2">     if engine == &quot;pyarrow&quot;:</span>
<span class="ne">---&gt; </span><span class="mi">42</span><span class="s2">         return PyArrowImpl()</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span><span class="s2">     elif engine == &quot;fastparquet&quot;:</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span><span class="s2">         return FastParquetImpl()</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">__init__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span><span class="s2">     def __init__(self):</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span><span class="s2">         pyarrow = import_optional_dependency(</span>
<span class="ne">---&gt; </span><span class="mi">78</span><span class="s2">             &quot;pyarrow&quot;, extra=&quot;pyarrow is required for parquet support.&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span><span class="s2">         )</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span><span class="s2">         import pyarrow.parquet</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, raise_on_missing, on_version)</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span><span class="s2">     except ImportError:</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span><span class="s2">         if raise_on_missing:</span>
<span class="ne">---&gt; </span><span class="mi">93</span><span class="s2">             raise ImportError(message.format(name=name, extra=extra)) from None</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span><span class="s2">         else:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span><span class="s2">             return None</span>

<span class="ne">ImportError</span>: Missing optional dependency &#39;pyarrow&#39;. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
</pre></div>
</div>
<p>creates a parquet file with <em>three</em> columns if you use <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> for serialization:
<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">__index_level_0__</span></code>. If you’re using <code class="docutils literal notranslate"><span class="pre">fastparquet</span></code>, the
index <a class="reference external" href="https://fastparquet.readthedocs.io/en/latest/api.html#fastparquet.write">may or may not</a>
be written to the file.</p>
<p>This unexpected extra column causes some databases like Amazon Redshift to reject
the file, because that column doesn’t exist in the target table.</p>
<p>If you want to omit a dataframe’s indexes when writing, pass <code class="docutils literal notranslate"><span class="pre">index=False</span></code> to
<a class="reference internal" href="../reference/api/pandas.DataFrame.to_parquet.html#pandas.DataFrame.to_parquet" title="pandas.DataFrame.to_parquet"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_parquet()</span></code></a>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [524]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">524</span><span class="o">-</span><span class="mf">92139e5</span><span class="n">cd2c3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ni">to_parquet</span><span class="nt">(self, fname, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2235</span>             <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2236</span>             <span class="n">partition_cols</span><span class="o">=</span><span class="n">partition_cols</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">2237</span>             <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">   </span><span class="mi">2238</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2239</span> 

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">to_parquet</span><span class="nt">(df, path, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>         <span class="n">Additional</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">engine</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">247</span><span class="s2">     impl = get_engine(engine)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span><span class="s2">     return impl.write(</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span><span class="s2">         df,</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">get_engine</span><span class="nt">(engine)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span><span class="s2"> </span>
<span class="g g-Whitespace">     </span><span class="mi">31</span><span class="s2">         raise ImportError(</span>
<span class="ne">---&gt; </span><span class="mi">32</span><span class="s2">             &quot;Unable to find a usable engine; &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span><span class="s2">             &quot;tried using: &#39;pyarrow&#39;, &#39;fastparquet&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span><span class="s2">             &quot;pyarrow or fastparquet is required for parquet &quot;</span>

<span class="ne">ImportError</span>: Unable to find a usable engine; tried using: &#39;pyarrow&#39;, &#39;fastparquet&#39;.
<span class="s2">pyarrow or fastparquet is required for parquet support</span>
</pre></div>
</div>
<p>This creates a parquet file with just the two expected columns, <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.
If your <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has a custom index, you won’t get it back when you load
this file into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">index=True</span></code> will <em>always</em> write the index, even if that’s not the
underlying engine’s default behavior.</p>
</div>
<div class="section" id="partitioning-parquet-files">
<h3>Partitioning Parquet files<a class="headerlink" href="#partitioning-parquet-files" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.0.</span></p>
</div>
<p>Parquet supports partitioning of data based on the values of one or more columns.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [525]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="gp">In [526]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>              <span class="n">partition_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">compression</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">526</span><span class="o">-</span><span class="n">a65c39059f84</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">,</span>
<span class="ne">----&gt; </span><span class="mi">2</span>               <span class="n">partition_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">compression</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ni">to_parquet</span><span class="nt">(self, fname, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2235</span>             <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2236</span>             <span class="n">partition_cols</span><span class="o">=</span><span class="n">partition_cols</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">2237</span>             <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">   </span><span class="mi">2238</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2239</span> 

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">to_parquet</span><span class="nt">(df, path, engine, compression, index, partition_cols, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>         <span class="n">Additional</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">engine</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">247</span><span class="s2">     impl = get_engine(engine)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span><span class="s2">     return impl.write(</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span><span class="s2">         df,</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">get_engine</span><span class="nt">(engine)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span><span class="s2"> </span>
<span class="g g-Whitespace">     </span><span class="mi">41</span><span class="s2">     if engine == &quot;pyarrow&quot;:</span>
<span class="ne">---&gt; </span><span class="mi">42</span><span class="s2">         return PyArrowImpl()</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span><span class="s2">     elif engine == &quot;fastparquet&quot;:</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span><span class="s2">         return FastParquetImpl()</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/io/parquet.py</span> in <span class="ni">__init__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span><span class="s2">     def __init__(self):</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span><span class="s2">         pyarrow = import_optional_dependency(</span>
<span class="ne">---&gt; </span><span class="mi">78</span><span class="s2">             &quot;pyarrow&quot;, extra=&quot;pyarrow is required for parquet support.&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span><span class="s2">         )</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span><span class="s2">         import pyarrow.parquet</span>

<span class="nn">~/miniconda/lib/python3.7/site-packages/pandas/compat/_optional.py</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, raise_on_missing, on_version)</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span><span class="s2">     except ImportError:</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span><span class="s2">         if raise_on_missing:</span>
<span class="ne">---&gt; </span><span class="mi">93</span><span class="s2">             raise ImportError(message.format(name=name, extra=extra)) from None</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span><span class="s2">         else:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span><span class="s2">             return None</span>

<span class="ne">ImportError</span>: Missing optional dependency &#39;pyarrow&#39;. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
</pre></div>
</div>
<p>The <cite>fname</cite> specifies the parent directory to which data will be saved.
The <cite>partition_cols</cite> are the column names by which the dataset will be partitioned.
Columns are partitioned in the order they are given. The partition splits are
determined by the unique values in the partition columns.
The above example creates a partitioned dataset that may look like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>test
├── a=0
│   ├── 0bac803e32dc42ae83fddfd029cbdebc.parquet
│   └──  ...
└── a=1
    ├── e6ab24a4f45147b49b54a662f0c412a3.parquet
    └── ...
</pre></div>
</div>
</div>
</div>
<div class="section" id="sql-queries">
<span id="io-sql"></span><h2>SQL Queries<a class="headerlink" href="#sql-queries" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">pandas.io.sql</span></code> module provides a collection of query wrappers to both
facilitate data retrieval and to reduce dependency on DB-specific API. Database abstraction
is provided by SQLAlchemy if installed. In addition you will need a driver library for
your database. Examples of such drivers are <a class="reference external" href="http://initd.org/psycopg/">psycopg2</a>
for PostgreSQL or <a class="reference external" href="https://github.com/PyMySQL/PyMySQL">pymysql</a> for MySQL.
For <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html">SQLite</a> this is
included in Python’s standard library by default.
You can find an overview of supported drivers for each SQL dialect in the
<a class="reference external" href="https://docs.sqlalchemy.org/en/latest/dialects/index.html">SQLAlchemy docs</a>.</p>
<p>If SQLAlchemy is not installed, a fallback is only provided for sqlite (and
for mysql for backwards compatibility, but this is deprecated and will be
removed in a future version).
This mode requires a Python database adapter which respect the <a class="reference external" href="https://www.python.org/dev/peps/pep-0249/">Python
DB-API</a>.</p>
<p>See also some <a class="reference internal" href="cookbook.html#cookbook-sql"><span class="std std-ref">cookbook examples</span></a> for some advanced strategies.</p>
<p>The key functions are:</p>
<table class="longtable table">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql_table</span></code></a>(table_name, con[, schema, …])</p></td>
<td><p>Read SQL database table into a DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../reference/api/pandas.read_sql_query.html#pandas.read_sql_query" title="pandas.read_sql_query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql_query</span></code></a>(sql, con[, index_col, …])</p></td>
<td><p>Read SQL query into a DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../reference/api/pandas.read_sql.html#pandas.read_sql" title="pandas.read_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_sql</span></code></a>(sql, con[, index_col, …])</p></td>
<td><p>Read SQL query or database table into a DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="pandas.DataFrame.to_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataFrame.to_sql</span></code></a>(self, name, con[, schema, …])</p></td>
<td><p>Write records stored in a DataFrame to a SQL database.</p></td>
</tr>
</tbody>
</table>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The function <a class="reference internal" href="../reference/api/pandas.read_sql.html#pandas.read_sql" title="pandas.read_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql()</span></code></a> is a convenience wrapper around
<a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_table()</span></code></a> and <a class="reference internal" href="../reference/api/pandas.read_sql_query.html#pandas.read_sql_query" title="pandas.read_sql_query"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_query()</span></code></a> (and for
backward compatibility) and will delegate to specific function depending on
the provided input (database table name or sql query).
Table names do not need to be quoted if they have special characters.</p>
</div>
<p>In the following example, we use the <a class="reference external" href="https://www.sqlite.org/">SQlite</a> SQL database
engine. You can use a temporary SQLite database where data are stored in
“memory”.</p>
<p>To connect with SQLAlchemy you use the <code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code> function to create an engine
object from database URI. You only need to create the engine once per database you are
connecting to.
For more information on <code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code> and the URI formatting, see the examples
below and the SQLAlchemy <a class="reference external" href="https://docs.sqlalchemy.org/en/latest/core/engines.html">documentation</a></p>
<pre class="literal-block">In [527]: from sqlalchemy import create_engine
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-527-172ae2805bcd&gt; in &lt;module&gt;
----&gt; 1 from sqlalchemy import create_engine

ModuleNotFoundError: No module named 'sqlalchemy'

# Create your engine.
In [528]: engine = create_engine('sqlite:///:memory:')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-528-b507e441a3a6&gt; in &lt;module&gt;
----&gt; 1 engine = create_engine('sqlite:///:memory:')

NameError: name 'create_engine' is not defined</pre>
<p>If you want to manage your own connections you can pass one of those instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">begin</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="writing-dataframes">
<h3>Writing DataFrames<a class="headerlink" href="#writing-dataframes" title="Permalink to this headline">¶</a></h3>
<p>Assuming the following data is in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <code class="docutils literal notranslate"><span class="pre">data</span></code>, we can insert it into
the database using <a class="reference internal" href="../reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="pandas.DataFrame.to_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_sql()</span></code></a>.</p>
<table class="table">
<colgroup>
<col style="width: 13%" />
<col style="width: 32%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Col_1</p></th>
<th class="head"><p>Col_2</p></th>
<th class="head"><p>Col_3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>26</p></td>
<td><p>2012-10-18</p></td>
<td><p>X</p></td>
<td><p>25.7</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>42</p></td>
<td><p>2012-10-19</p></td>
<td><p>Y</p></td>
<td><p>-12.4</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p>63</p></td>
<td><p>2012-10-20</p></td>
<td><p>Z</p></td>
<td><p>5.73</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<pre class="literal-block">In [529]: data
Out[529]: 
   id       Date Col_1  Col_2  Col_3
0  26 2010-10-18     X  27.50   True
1  42 2010-10-19     Y -12.50  False
2  63 2010-10-20     Z   5.73   True

In [530]: data.to_sql('data', engine)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-530-f5cd9ab3b7dc&gt; in &lt;module&gt;
----&gt; 1 data.to_sql('data', engine)

NameError: name 'engine' is not defined</pre>
<p>With some databases, writing large DataFrames can result in errors due to
packet size limitations being exceeded. This can be avoided by setting the
<code class="docutils literal notranslate"><span class="pre">chunksize</span></code> parameter when calling <code class="docutils literal notranslate"><span class="pre">to_sql</span></code>.  For example, the following
writes <code class="docutils literal notranslate"><span class="pre">data</span></code> to the database in batches of 1000 rows at a time:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [531]: </span><span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;data_chunked&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">531</span><span class="o">-</span><span class="mi">4</span><span class="n">aa1ee94beb2</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;data_chunked&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<div class="section" id="sql-data-types">
<h4>SQL data types<a class="headerlink" href="#sql-data-types" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="../reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="pandas.DataFrame.to_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_sql()</span></code></a> will try to map your data to an appropriate
SQL data type based on the dtype of the data. When you have columns of dtype
<code class="docutils literal notranslate"><span class="pre">object</span></code>, pandas will try to infer the data type.</p>
<p>You can always override the default type by specifying the desired SQL type of
any of the columns by using the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> argument. This argument needs a
dictionary mapping column names to SQLAlchemy types (or strings for the sqlite3
fallback mode).
For example, specifying to use the sqlalchemy <code class="docutils literal notranslate"><span class="pre">String</span></code> type instead of the
default <code class="docutils literal notranslate"><span class="pre">Text</span></code> type for string columns:</p>
<pre class="literal-block">In [532]: from sqlalchemy.types import String
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-532-df98ab998107&gt; in &lt;module&gt;
----&gt; 1 from sqlalchemy.types import String

ModuleNotFoundError: No module named 'sqlalchemy'

In [533]: data.to_sql('data_dtype', engine, dtype={'Col_1': String})
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-533-5b0f75b1bc50&gt; in &lt;module&gt;
----&gt; 1 data.to_sql('data_dtype', engine, dtype={'Col_1': String})

NameError: name 'engine' is not defined</pre>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Due to the limited support for timedelta’s in the different database
flavors, columns with type <code class="docutils literal notranslate"><span class="pre">timedelta64</span></code> will be written as integer
values as nanoseconds to the database and a warning will be raised.</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Columns of <code class="docutils literal notranslate"><span class="pre">category</span></code> dtype will be converted to the dense representation
as you would get with <code class="docutils literal notranslate"><span class="pre">np.asarray(categorical)</span></code> (e.g. for string categories
this gives an array of strings).
Because of this, reading the database table back in does <strong>not</strong> generate
a categorical.</p>
</div>
</div>
</div>
<div class="section" id="datetime-data-types">
<span id="io-sql-datetime-data"></span><h3>Datetime data types<a class="headerlink" href="#datetime-data-types" title="Permalink to this headline">¶</a></h3>
<p>Using SQLAlchemy, <a class="reference internal" href="../reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="pandas.DataFrame.to_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_sql()</span></code></a> is capable of writing
datetime data that is timezone naive or timezone aware. However, the resulting
data stored in the database ultimately depends on the supported data type
for datetime data of the database system being used.</p>
<p>The following table lists supported data types for datetime data for some
common databases. Other database dialects may have different data types for
datetime data.</p>
<table class="table">
<colgroup>
<col style="width: 15%" />
<col style="width: 60%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Database</p></th>
<th class="head"><p>SQL Datetime Types</p></th>
<th class="head"><p>Timezone Support</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SQLite</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>MySQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code> or <code class="docutils literal notranslate"><span class="pre">DATETIME</span></code></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>PostgreSQL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code> or <code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>When writing timezone aware data to databases that do not support timezones,
the data will be written as timezone naive timestamps that are in local time
with respect to the timezone.</p>
<p><a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_table()</span></code></a> is also capable of reading datetime data that is
timezone aware or naive. When reading <code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code> types, pandas
will convert the data to UTC.</p>
<div class="section" id="insertion-method">
<span id="io-sql-method"></span><h4>Insertion Method<a class="headerlink" href="#insertion-method" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.0.</span></p>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">method</span></code> controls the SQL insertion clause used.
Possible values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: Uses standard SQL <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> clause (one per row).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'multi'</span></code>: Pass multiple values in a single <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> clause.
It uses a <em>special</em> SQL syntax not supported by all backends.
This usually provides better performance for analytic databases
like <em>Presto</em> and <em>Redshift</em>, but has worse performance for
traditional SQL backend if the table contains many columns.
For more information check the SQLAlchemy <a class="reference external" href="http://docs.sqlalchemy.org/en/latest/core/dml.html#sqlalchemy.sql.expression.Insert.values.params.*args">documention</a>.</p></li>
<li><p>callable with signature <code class="docutils literal notranslate"><span class="pre">(pd_table,</span> <span class="pre">conn,</span> <span class="pre">keys,</span> <span class="pre">data_iter)</span></code>:
This can be used to implement a more performant insertion method based on
specific backend dialect features.</p></li>
</ul>
<p>Example of a callable using PostgreSQL <a class="reference external" href="https://www.postgresql.org/docs/current/static/sql-copy.html">COPY clause</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Alternative to_sql() *method* for DBs that support COPY FROM</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>

<span class="k">def</span> <span class="nf">psql_insert_copy</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">data_iter</span><span class="p">):</span>
    <span class="c1"># gets a DBAPI connection that can provide a cursor</span>
    <span class="n">dbapi_conn</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">connection</span>
    <span class="k">with</span> <span class="n">dbapi_conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">s_buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">s_buf</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">data_iter</span><span class="p">)</span>
        <span class="n">s_buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="p">:</span>
            <span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_name</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="s1">&#39;COPY </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">) FROM STDIN WITH CSV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">copy_expert</span><span class="p">(</span><span class="n">sql</span><span class="o">=</span><span class="n">sql</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">s_buf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-tables">
<h3>Reading Tables<a class="headerlink" href="#reading-tables" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_table()</span></code></a> will read a database table given the
table name and optionally a subset of columns to read.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>In order to use <a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_table()</span></code></a>, you <strong>must</strong> have the
SQLAlchemy optional dependency installed.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [534]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">534</span><span class="o">-</span><span class="mi">5</span><span class="n">d7b378a0e2a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<p>You can also specify the name of the column as the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> index,
and specify a subset of columns to be read.</p>
<pre class="literal-block">In [535]: pd.read_sql_table('data', engine, index_col='id')
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-535-5ce6d94466f1&gt; in &lt;module&gt;
----&gt; 1 pd.read_sql_table('data', engine, index_col='id')

NameError: name 'engine' is not defined

In [536]: pd.read_sql_table('data', engine, columns=['Col_1', 'Col_2'])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-536-390a3360f767&gt; in &lt;module&gt;
----&gt; 1 pd.read_sql_table('data', engine, columns=['Col_1', 'Col_2'])

NameError: name 'engine' is not defined</pre>
<p>And you can explicitly force columns to be parsed as dates:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [537]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">537</span><span class="o">-</span><span class="n">c8d1ce2459c5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<p>If needed you can explicitly specify a format string, or a dict of arguments
to pass to <a class="reference internal" href="../reference/api/pandas.to_datetime.html#pandas.to_datetime" title="pandas.to_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.to_datetime()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span>
                  <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<p>You can check if a table exists using <code class="xref py py-func docutils literal notranslate"><span class="pre">has_table()</span></code></p>
</div>
<div class="section" id="schema-support">
<h3>Schema support<a class="headerlink" href="#schema-support" title="Permalink to this headline">¶</a></h3>
<p>Reading from and writing to different schema’s is supported through the <code class="docutils literal notranslate"><span class="pre">schema</span></code>
keyword in the <a class="reference internal" href="../reference/api/pandas.read_sql_table.html#pandas.read_sql_table" title="pandas.read_sql_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_table()</span></code></a> and <a class="reference internal" href="../reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="pandas.DataFrame.to_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_sql()</span></code></a>
functions. Note however that this depends on the database flavor (sqlite does not
have schema’s). For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;other_schema&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="s1">&#39;other_schema&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>Querying<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>You can query using raw SQL in the <a class="reference internal" href="../reference/api/pandas.read_sql_query.html#pandas.read_sql_query" title="pandas.read_sql_query"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_query()</span></code></a> function.
In this case you must use the SQL variant appropriate for your database.
When using SQLAlchemy, you can also pass SQLAlchemy Expression language constructs,
which are database-agnostic.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [538]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">538</span><span class="o">-</span><span class="n">e4e9aacb096d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM data&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<p>Of course, you can specify a more “complex” query.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [539]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT id, Col_1, Col_2 FROM data WHERE id = 42;&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">539</span><span class="o">-</span><span class="mi">4</span><span class="n">d9921b5c402</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT id, Col_1, Col_2 FROM data WHERE id = 42;&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<p>The <a class="reference internal" href="../reference/api/pandas.read_sql_query.html#pandas.read_sql_query" title="pandas.read_sql_query"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql_query()</span></code></a> function supports a <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> argument.
Specifying this will return an iterator through chunks of the query result:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [540]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>

<span class="gp">In [541]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;data_chunks&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">541</span><span class="o">-</span><span class="n">c1a842c1a9cc</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;data_chunks&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [542]: </span><span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM data_chunks&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>                               <span class="n">engine</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">542</span><span class="o">-</span><span class="mi">2</span><span class="n">dee3444bb39</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM data_chunks&quot;</span><span class="p">,</span>
<span class="ne">----&gt; </span><span class="mi">2</span>                                <span class="n">engine</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="k">print</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;engine&#39; is not defined
</pre></div>
</div>
<p>You can also run a plain query without creating a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with
<code class="xref py py-func docutils literal notranslate"><span class="pre">execute()</span></code>. This is useful for queries that don’t return values,
such as INSERT. This is functionally equivalent to calling <code class="docutils literal notranslate"><span class="pre">execute</span></code> on the
SQLAlchemy engine or db connection object. Again, you must use the SQL syntax
variant appropriate for your database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.io</span> <span class="kn">import</span> <span class="n">sql</span>
<span class="n">sql</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM table_name&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">sql</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;INSERT INTO table_name VALUES(?, ?, ?)&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span> <span class="bp">True</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="section" id="engine-connection-examples">
<h3>Engine connection examples<a class="headerlink" href="#engine-connection-examples" title="Permalink to this headline">¶</a></h3>
<p>To connect with SQLAlchemy you use the <code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code> function to create an engine
object from database URI. You only need to create the engine once per database you are
connecting to.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql://scott:tiger@localhost:5432/mydatabase&#39;</span><span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;mysql+mysqldb://scott:tiger@localhost/foo&#39;</span><span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;oracle://scott:tiger@127.0.0.1:1521/sidname&#39;</span><span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;mssql+pyodbc://mydsn&#39;</span><span class="p">)</span>

<span class="c1"># sqlite://&lt;nohostname&gt;/&lt;path&gt;</span>
<span class="c1"># where &lt;path&gt; is relative:</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///foo.db&#39;</span><span class="p">)</span>

<span class="c1"># or absolute, starting with a slash:</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:////absolute/path/to/foo.db&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information see the examples the SQLAlchemy <a class="reference external" href="https://docs.sqlalchemy.org/en/latest/core/engines.html">documentation</a></p>
</div>
<div class="section" id="advanced-sqlalchemy-queries">
<h3>Advanced SQLAlchemy queries<a class="headerlink" href="#advanced-sqlalchemy-queries" title="Permalink to this headline">¶</a></h3>
<p>You can use SQLAlchemy constructs to describe your query.</p>
<p>Use <code class="xref py py-func docutils literal notranslate"><span class="pre">sqlalchemy.text()</span></code> to specify query parameters in a backend-neutral way</p>
<pre class="literal-block">In [543]: import sqlalchemy as sa
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
&lt;ipython-input-543-014e07789c18&gt; in &lt;module&gt;
----&gt; 1 import sqlalchemy as sa

ModuleNotFoundError: No module named 'sqlalchemy'

In [544]: pd.read_sql(sa.text('SELECT * FROM data where Col_1=:col1'),
   .....:             engine, params={'col1': 'X'})
   .....: 
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-544-9ac795479a2a&gt; in &lt;module&gt;
----&gt; 1 pd.read_sql(sa.text('SELECT * FROM data where Col_1=:col1'),
      2             engine, params={'col1': 'X'})

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
   5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
   5178                 return self[name]
-&gt; 5179             return object.__getattribute__(self, name)
   5180 
   5181     def __setattr__(self, name, value):

AttributeError: 'Series' object has no attribute 'text'</pre>
<p>If you have an SQLAlchemy description of your database you can express where conditions using SQLAlchemy expressions</p>
<pre class="literal-block">In [545]: metadata = sa.MetaData()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-545-4f1045301553&gt; in &lt;module&gt;
----&gt; 1 metadata = sa.MetaData()

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
   5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
   5178                 return self[name]
-&gt; 5179             return object.__getattribute__(self, name)
   5180 
   5181     def __setattr__(self, name, value):

AttributeError: 'Series' object has no attribute 'MetaData'

In [546]: data_table = sa.Table('data', metadata,
   .....:                       sa.Column('index', sa.Integer),
   .....:                       sa.Column('Date', sa.DateTime),
   .....:                       sa.Column('Col_1', sa.String),
   .....:                       sa.Column('Col_2', sa.Float),
   .....:                       sa.Column('Col_3', sa.Boolean),
   .....:                       )
   .....: 
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-546-ff63ad105bfc&gt; in &lt;module&gt;
----&gt; 1 data_table = sa.Table('data', metadata,
      2                       sa.Column('index', sa.Integer),
      3                       sa.Column('Date', sa.DateTime),
      4                       sa.Column('Col_1', sa.String),
      5                       sa.Column('Col_2', sa.Float),

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
   5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
   5178                 return self[name]
-&gt; 5179             return object.__getattribute__(self, name)
   5180 
   5181     def __setattr__(self, name, value):

AttributeError: 'Series' object has no attribute 'Table'

In [547]: pd.read_sql(sa.select([data_table]).where(data_table.c.Col_3 is True), engine)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-547-19a3f87b04e3&gt; in &lt;module&gt;
----&gt; 1 pd.read_sql(sa.select([data_table]).where(data_table.c.Col_3 is True), engine)

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
   5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
   5178                 return self[name]
-&gt; 5179             return object.__getattribute__(self, name)
   5180 
   5181     def __setattr__(self, name, value):

AttributeError: 'Series' object has no attribute 'select'</pre>
<p>You can combine SQLAlchemy expressions with parameters passed to <a class="reference internal" href="../reference/api/pandas.read_sql.html#pandas.read_sql" title="pandas.read_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sql()</span></code></a> using <code class="xref py py-func docutils literal notranslate"><span class="pre">sqlalchemy.bindparam()</span></code></p>
<pre class="literal-block">In [548]: import datetime as dt

In [549]: expr = sa.select([data_table]).where(data_table.c.Date &gt; sa.bindparam('date'))
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-549-f8eaa7637fd8&gt; in &lt;module&gt;
----&gt; 1 expr = sa.select([data_table]).where(data_table.c.Date &gt; sa.bindparam('date'))

~/miniconda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
   5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
   5178                 return self[name]
-&gt; 5179             return object.__getattribute__(self, name)
   5180 
   5181     def __setattr__(self, name, value):

AttributeError: 'Series' object has no attribute 'select'

In [550]: pd.read_sql(expr, engine, params={'date': dt.datetime(2010, 10, 18)})
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-550-c6c4def788a1&gt; in &lt;module&gt;
----&gt; 1 pd.read_sql(expr, engine, params={'date': dt.datetime(2010, 10, 18)})

NameError: name 'engine' is not defined</pre>
</div>
<div class="section" id="sqlite-fallback">
<h3>Sqlite fallback<a class="headerlink" href="#sqlite-fallback" title="Permalink to this headline">¶</a></h3>
<p>The use of sqlite is supported without using SQLAlchemy.
This mode requires a Python database adapter which respect the <a class="reference external" href="https://www.python.org/dev/peps/pep-0249/">Python
DB-API</a>.</p>
<p>You can create connections like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;:memory:&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>And then issue the following queries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">con</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM data&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="google-bigquery">
<span id="io-bigquery"></span><h2>Google BigQuery<a class="headerlink" href="#google-bigquery" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Starting in 0.20.0, pandas has split off Google BigQuery support into the
separate package <code class="docutils literal notranslate"><span class="pre">pandas-gbq</span></code>. You can <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas-gbq</span></code> to get it.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas-gbq</span></code> package provides functionality to read/write from Google BigQuery.</p>
<p>pandas integrates with this external package. if <code class="docutils literal notranslate"><span class="pre">pandas-gbq</span></code> is installed, you can
use the pandas methods <code class="docutils literal notranslate"><span class="pre">pd.read_gbq</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame.to_gbq</span></code>, which will call the
respective functions from <code class="docutils literal notranslate"><span class="pre">pandas-gbq</span></code>.</p>
<p>Full documentation can be found <a class="reference external" href="https://pandas-gbq.readthedocs.io/">here</a>.</p>
</div>
<div class="section" id="stata-format">
<span id="io-stata"></span><h2>Stata Format<a class="headerlink" href="#stata-format" title="Permalink to this headline">¶</a></h2>
<div class="section" id="writing-to-stata-format">
<span id="io-stata-writer"></span><h3>Writing to Stata format<a class="headerlink" href="#writing-to-stata-format" title="Permalink to this headline">¶</a></h3>
<p>The method <code class="xref py py-func docutils literal notranslate"><span class="pre">to_stata()</span></code> will write a DataFrame
into a .dta file. The format version of this file is always 115 (Stata 12).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [551]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>

<span class="gp">In [552]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_stata</span><span class="p">(</span><span class="s1">&#39;stata.dta&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Stata</em> data files have limited data type support; only strings with
244 or fewer characters, <code class="docutils literal notranslate"><span class="pre">int8</span></code>, <code class="docutils literal notranslate"><span class="pre">int16</span></code>, <code class="docutils literal notranslate"><span class="pre">int32</span></code>, <code class="docutils literal notranslate"><span class="pre">float32</span></code>
and <code class="docutils literal notranslate"><span class="pre">float64</span></code> can be stored in <code class="docutils literal notranslate"><span class="pre">.dta</span></code> files.  Additionally,
<em>Stata</em> reserves certain values to represent missing data. Exporting a
non-missing value that is outside of the permitted range in Stata for
a particular data type will retype the variable to the next larger
size.  For example, <code class="docutils literal notranslate"><span class="pre">int8</span></code> values are restricted to lie between -127
and 100 in Stata, and so variables with values above 100 will trigger
a conversion to <code class="docutils literal notranslate"><span class="pre">int16</span></code>. <code class="docutils literal notranslate"><span class="pre">nan</span></code> values in floating points data
types are stored as the basic missing data type (<code class="docutils literal notranslate"><span class="pre">.</span></code> in <em>Stata</em>).</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>It is not possible to export missing data values for integer data types.</p>
</div>
<p>The <em>Stata</em> writer gracefully handles other data types including <code class="docutils literal notranslate"><span class="pre">int64</span></code>,
<code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">uint8</span></code>, <code class="docutils literal notranslate"><span class="pre">uint16</span></code>, <code class="docutils literal notranslate"><span class="pre">uint32</span></code> by casting to
the smallest supported type that can represent the data.  For example, data
with a type of <code class="docutils literal notranslate"><span class="pre">uint8</span></code> will be cast to <code class="docutils literal notranslate"><span class="pre">int8</span></code> if all values are less than
100 (the upper bound for non-missing <code class="docutils literal notranslate"><span class="pre">int8</span></code> data in <em>Stata</em>), or, if values are
outside of this range, the variable is cast to <code class="docutils literal notranslate"><span class="pre">int16</span></code>.</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p>Conversion from <code class="docutils literal notranslate"><span class="pre">int64</span></code> to <code class="docutils literal notranslate"><span class="pre">float64</span></code> may result in a loss of precision
if <code class="docutils literal notranslate"><span class="pre">int64</span></code> values are larger than 2**53.</p>
</div>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">StataWriter</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">to_stata()</span></code> only support fixed width
strings containing up to 244 characters, a limitation imposed by the version
115 dta file format. Attempting to write <em>Stata</em> dta files with strings
longer than 244 characters raises a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
</div>
</div>
<div class="section" id="reading-from-stata-format">
<span id="io-stata-reader"></span><h3>Reading from Stata format<a class="headerlink" href="#reading-from-stata-format" title="Permalink to this headline">¶</a></h3>
<p>The top-level function <code class="docutils literal notranslate"><span class="pre">read_stata</span></code> will read a dta file and return
either a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or a <code class="xref py py-class docutils literal notranslate"><span class="pre">StataReader</span></code> that can
be used to read the file incrementally.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [553]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;stata.dta&#39;</span><span class="p">)</span>
<span class="gh">Out[553]: </span><span class="go"></span>
<span class="go">   index         A         B</span>
<span class="go">0      0  0.133171 -1.274374</span>
<span class="go">1      1  2.518925 -0.517547</span>
<span class="go">2      2 -0.360773  0.877961</span>
<span class="go">3      3 -1.881598 -0.699067</span>
<span class="go">4      4 -1.566913  0.824581</span>
<span class="go">5      5 -0.674292 -1.136157</span>
<span class="go">6      6  0.897844  1.430243</span>
<span class="go">7      7  0.356573  0.425873</span>
<span class="go">8      8 -0.183641 -0.264369</span>
<span class="go">9      9 -1.136008  1.249329</span>
</pre></div>
</div>
<p>Specifying a <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> yields a
<code class="xref py py-class docutils literal notranslate"><span class="pre">StataReader</span></code> instance that can be used to
read <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> lines from the file at a time.  The <code class="docutils literal notranslate"><span class="pre">StataReader</span></code>
object can be used as an iterator.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [554]: </span><span class="n">reader</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;stata.dta&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="gp">In [555]: </span><span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
<span class="gp">   .....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="go">(3, 3)</span>
<span class="go">(3, 3)</span>
<span class="go">(3, 3)</span>
<span class="go">(1, 3)</span>
</pre></div>
</div>
<p>For more fine-grained control, use <code class="docutils literal notranslate"><span class="pre">iterator=True</span></code> and specify
<code class="docutils literal notranslate"><span class="pre">chunksize</span></code> with each call to
<code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [556]: </span><span class="n">reader</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;stata.dta&#39;</span><span class="p">,</span> <span class="n">iterator</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [557]: </span><span class="n">chunk1</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [558]: </span><span class="n">chunk2</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Currently the <code class="docutils literal notranslate"><span class="pre">index</span></code> is retrieved as a column.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">convert_categoricals</span></code> indicates whether value labels should be
read and used to create a <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> variable from them. Value labels can
also be retrieved by the function <code class="docutils literal notranslate"><span class="pre">value_labels</span></code>, which requires <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code>
to be called before use.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">convert_missing</span></code> indicates whether missing value
representations in Stata should be preserved.  If <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default),
missing values are represented as <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, missing values are
represented using <code class="docutils literal notranslate"><span class="pre">StataMissingValue</span></code> objects, and columns containing missing
values will have <code class="docutils literal notranslate"><span class="pre">object</span></code> data type.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../reference/api/pandas.read_stata.html#pandas.read_stata" title="pandas.read_stata"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_stata()</span></code></a> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">StataReader</span></code> support .dta formats 113-115
(Stata 10-12), 117 (Stata 13), and 118 (Stata 14).</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">preserve_dtypes=False</span></code> will upcast to the standard pandas data types:
<code class="docutils literal notranslate"><span class="pre">int64</span></code> for all integer types and <code class="docutils literal notranslate"><span class="pre">float64</span></code> for floating point data.  By default,
the Stata data types are preserved when importing.</p>
</div>
<div class="section" id="io-stata-categorical">
<span id="id5"></span><h4>Categorical Data<a class="headerlink" href="#io-stata-categorical" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Categorical</span></code> data can be exported to <em>Stata</em> data files as value labeled data.
The exported data consists of the underlying category codes as integer data values
and the categories as value labels.  <em>Stata</em> does not have an explicit equivalent
to a <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> and information about <em>whether</em> the variable is ordered
is lost when exporting.</p>
<div class="alert alert-warning">
<p class="admonition-title">Warning</p>
<p><em>Stata</em> only supports string value labels, and so <code class="docutils literal notranslate"><span class="pre">str</span></code> is called on the
categories when exporting data.  Exporting <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> variables with
non-string categories produces a warning, and can result a loss of
information if the <code class="docutils literal notranslate"><span class="pre">str</span></code> representations of the categories are not unique.</p>
</div>
<p>Labeled data can similarly be imported from <em>Stata</em> data files as <code class="docutils literal notranslate"><span class="pre">Categorical</span></code>
variables using the keyword argument <code class="docutils literal notranslate"><span class="pre">convert_categoricals</span></code> (<code class="docutils literal notranslate"><span class="pre">True</span></code> by default).
The keyword argument <code class="docutils literal notranslate"><span class="pre">order_categoricals</span></code> (<code class="docutils literal notranslate"><span class="pre">True</span></code> by default) determines
whether imported <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> variables are ordered.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>When importing categorical data, the values of the variables in the <em>Stata</em>
data file are not preserved since <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> variables always
use integer data types between <code class="docutils literal notranslate"><span class="pre">-1</span></code> and <code class="docutils literal notranslate"><span class="pre">n-1</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number
of categories. If the original values in the <em>Stata</em> data file are required,
these can be imported by setting <code class="docutils literal notranslate"><span class="pre">convert_categoricals=False</span></code>, which will
import original data (but not the variable labels). The original values can
be matched to the imported categorical data since there is a simple mapping
between the original <em>Stata</em> data values and the category codes of imported
Categorical variables: missing values are assigned code <code class="docutils literal notranslate"><span class="pre">-1</span></code>, and the
smallest original value is assigned <code class="docutils literal notranslate"><span class="pre">0</span></code>, the second smallest is assigned
<code class="docutils literal notranslate"><span class="pre">1</span></code> and so on until the largest original value is assigned the code <code class="docutils literal notranslate"><span class="pre">n-1</span></code>.</p>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p><em>Stata</em> supports partially labeled series. These series have value labels for
some but not all data values. Importing a partially labeled series will produce
a <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> with string categories for the values that are labeled and
numeric categories for values with no label.</p>
</div>
</div>
</div>
</div>
<div class="section" id="sas-formats">
<span id="io-sas-reader"></span><span id="io-sas"></span><h2>SAS Formats<a class="headerlink" href="#sas-formats" title="Permalink to this headline">¶</a></h2>
<p>The top-level function <a class="reference internal" href="../reference/api/pandas.read_sas.html#pandas.read_sas" title="pandas.read_sas"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_sas()</span></code></a> can read (but not write) SAS
<cite>xport</cite> (.XPT) and (since <em>v0.18.0</em>) <cite>SAS7BDAT</cite> (.sas7bdat) format files.</p>
<p>SAS files only contain two value types: ASCII text and floating point
values (usually 8 bytes but sometimes truncated).  For xport files,
there is no automatic type conversion to integers, dates, or
categoricals.  For SAS7BDAT files, the format codes may allow date
variables to be automatically converted to dates.  By default the
whole file is read and returned as a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>Specify a <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> or use <code class="docutils literal notranslate"><span class="pre">iterator=True</span></code> to obtain reader
objects (<code class="docutils literal notranslate"><span class="pre">XportReader</span></code> or <code class="docutils literal notranslate"><span class="pre">SAS7BDATReader</span></code>) for incrementally
reading the file.  The reader objects also have attributes that
contain additional information about the file and its variables.</p>
<p>Read a SAS7BDAT file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="s1">&#39;sas_data.sas7bdat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Obtain an iterator and read an XPORT file 100,000 lines at a time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">rdr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="s1">&#39;sas_xport.xpt&#39;</span><span class="p">,</span> <span class="n">chunk</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">rdr</span><span class="p">:</span>
    <span class="n">do_something</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://support.sas.com/techsup/technote/ts140.pdf">specification</a> for the xport file format is available from the SAS
web site.</p>
<p>No official documentation is available for the SAS7BDAT format.</p>
</div>
<div class="section" id="other-file-formats">
<span id="io-other"></span><h2>Other file formats<a class="headerlink" href="#other-file-formats" title="Permalink to this headline">¶</a></h2>
<p>pandas itself only supports IO with a limited set of file formats that map
cleanly to its tabular data model. For reading and writing other file formats
into and from pandas, we recommend these packages from the broader community.</p>
<div class="section" id="netcdf">
<h3>netCDF<a class="headerlink" href="#netcdf" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://xarray.pydata.org/">xarray</a> provides data structures inspired by the pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> for working
with multi-dimensional datasets, with a focus on the netCDF file format and
easy conversion to and from pandas.</p>
</div>
</div>
<div class="section" id="performance-considerations">
<span id="io-perf"></span><h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permalink to this headline">¶</a></h2>
<p>This is an informal comparison of various IO methods, using pandas
0.20.3. Timings are machine dependent and small differences should be
ignored.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">sz</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="gp">In [2]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">sz</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sz</span><span class="p">})</span>

<span class="gp">In [3]: </span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">RangeIndex: 1000000 entries, 0 to 999999</span>
<span class="go">Data columns (total 2 columns):</span>
<span class="go">A    1000000 non-null float64</span>
<span class="go">B    1000000 non-null int64</span>
<span class="go">dtypes: float64(1), int64(1)</span>
<span class="go">memory usage: 15.3 MB</span>
</pre></div>
</div>
<p>Given the next test set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>

<span class="n">sz</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">randn</span><span class="p">(</span><span class="n">sz</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sz</span><span class="p">})</span>


<span class="k">def</span> <span class="nf">test_sql_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;test.sql&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;test.sql&#39;</span><span class="p">)</span>
    <span class="n">sql_db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;test.sql&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_table&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">sql_db</span><span class="p">)</span>
    <span class="n">sql_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_sql_read</span><span class="p">():</span>
    <span class="n">sql_db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;test.sql&#39;</span><span class="p">)</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;select * from test_table&quot;</span><span class="p">,</span> <span class="n">sql_db</span><span class="p">)</span>
    <span class="n">sql_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_hdf_fixed_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_fixed_read</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_fixed_write_compress</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed_compress.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">complib</span><span class="o">=</span><span class="s1">&#39;blosc&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_fixed_read_compress</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;test_fixed_compress.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_table_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;test_table.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_table_read</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;test_table.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_table_write_compress</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s1">&#39;test_table_compress.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
              <span class="n">complib</span><span class="o">=</span><span class="s1">&#39;blosc&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_hdf_table_read_compress</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;test_table_compress.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_csv_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_csv_read</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_feather_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s1">&#39;test.feather&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_feather_read</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s1">&#39;test.feather&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_pickle_write</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;test.pkl&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_pickle_read</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;test.pkl&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_pickle_write_compress</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;test.pkl.compress&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_pickle_read_compress</span><span class="p">():</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;test.pkl.compress&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When writing, the top-three functions in terms of speed are are
<code class="docutils literal notranslate"><span class="pre">test_pickle_write</span></code>, <code class="docutils literal notranslate"><span class="pre">test_feather_write</span></code> and <code class="docutils literal notranslate"><span class="pre">test_hdf_fixed_write_compress</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="o">%</span><span class="k">timeit</span> test_sql_write(df)
<span class="go">2.37 s ± 36.6 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [15]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_fixed_write(df)
<span class="go">194 ms ± 65.9 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [26]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_fixed_write_compress(df)
<span class="go">119 ms ± 2.15 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [16]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_table_write(df)
<span class="go">623 ms ± 125 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [27]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_table_write_compress(df)
<span class="go">563 ms ± 23.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [17]: </span><span class="o">%</span><span class="k">timeit</span> test_csv_write(df)
<span class="go">3.13 s ± 49.9 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [30]: </span><span class="o">%</span><span class="k">timeit</span> test_feather_write(df)
<span class="go">103 ms ± 5.88 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [31]: </span><span class="o">%</span><span class="k">timeit</span> test_pickle_write(df)
<span class="go">109 ms ± 3.72 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [32]: </span><span class="o">%</span><span class="k">timeit</span> test_pickle_write_compress(df)
<span class="go">3.33 s ± 55.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
</pre></div>
</div>
<p>When reading, the top three are <code class="docutils literal notranslate"><span class="pre">test_feather_read</span></code>, <code class="docutils literal notranslate"><span class="pre">test_pickle_read</span></code> and
<code class="docutils literal notranslate"><span class="pre">test_hdf_fixed_read</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="o">%</span><span class="k">timeit</span> test_sql_read()
<span class="go">1.35 s ± 14.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [19]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_fixed_read()
<span class="go">14.3 ms ± 438 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>

<span class="gp">In [28]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_fixed_read_compress()
<span class="go">23.5 ms ± 672 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [20]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_table_read()
<span class="go">35.4 ms ± 314 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [29]: </span><span class="o">%</span><span class="k">timeit</span> test_hdf_table_read_compress()
<span class="go">42.6 ms ± 2.1 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="gp">In [22]: </span><span class="o">%</span><span class="k">timeit</span> test_csv_read()
<span class="go">516 ms ± 27.1 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="gp">In [33]: </span><span class="o">%</span><span class="k">timeit</span> test_feather_read()
<span class="go">4.06 ms ± 115 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>

<span class="gp">In [34]: </span><span class="o">%</span><span class="k">timeit</span> test_pickle_read()
<span class="go">6.5 ms ± 172 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>

<span class="gp">In [35]: </span><span class="o">%</span><span class="k">timeit</span> test_pickle_read_compress()
<span class="go">588 ms ± 3.57 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
</pre></div>
</div>
<p>Space on disk (in bytes)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>34816000 Aug 21 18:00 test.sql
24009240 Aug 21 18:00 test_fixed.hdf
 7919610 Aug 21 18:00 test_fixed_compress.hdf
24458892 Aug 21 18:00 test_table.hdf
 8657116 Aug 21 18:00 test_table_compress.hdf
28520770 Aug 21 18:00 test.csv
16000248 Aug 21 18:00 test.feather
16000848 Aug 21 18:00 test.pkl
 7554108 Aug 21 18:00 test.pkl.compress
</pre></div>
</div>
</div>
</div>


              </div>
          </main>

      </div>
    </div><script>
    // TOC sidebar - add "active" class to parent list
    // 
    // Bootstrap's scrollspy adds the active class to the <a> link,
    // but for the automatic collapsing we need this on the parent list item.
    // 
    // The event is triggered on "window" (and not the nav item as documented),
    // see https://github.com/twbs/bootstrap/issues/20086
    $(window).on("activate.bs.scrollspy", function(){
    var navLinks = document.querySelectorAll('#bd-toc-nav a');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.remove('active');
    }
    var navLinks = document.querySelectorAll('#bd-toc-nav a.active');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.add('active');
    }
    });
</script>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2014, the pandas development team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>